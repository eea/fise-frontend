{"ast":null,"code":"import _extends from \"/home/tooler/code/work/forests-frontend/node_modules/@babel/runtime/helpers/esm/extends.js\";\nimport _objectWithoutProperties from \"/home/tooler/code/work/forests-frontend/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";\nvar _excluded = [\"href\", \"item\", \"openLinkInNewTab\", \"download\", \"children\", \"className\", \"title\"];\nvar _jsxFileName = \"/home/tooler/code/work/forests-frontend/node_modules/@plone/volto/src/components/manage/UniversalLink/UniversalLink.jsx\",\n  _this = this,\n  _s = $RefreshSig$();\nvar __jsx = React.createElement;\n/*\n * UniversalLink\n * @module components/UniversalLink\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from 'react-router-dom';\nimport { useSelector } from 'react-redux';\nimport { flattenToAppURL, isInternalURL, URLUtils } from '@plone/volto/helpers/Url/Url';\nimport { matchPath } from 'react-router';\nimport config from '@plone/volto/registry';\nvar UniversalLink = function UniversalLink(_ref) {\n  _s();\n  var _find, _config$settings$exte;\n  var href = _ref.href,\n    _ref$item = _ref.item,\n    item = _ref$item === void 0 ? null : _ref$item,\n    openLinkInNewTab = _ref.openLinkInNewTab,\n    _ref$download = _ref.download,\n    download = _ref$download === void 0 ? false : _ref$download,\n    children = _ref.children,\n    _ref$className = _ref.className,\n    className = _ref$className === void 0 ? null : _ref$className,\n    _ref$title = _ref.title,\n    title = _ref$title === void 0 ? null : _ref$title,\n    props = _objectWithoutProperties(_ref, _excluded);\n  var token = useSelector(function (state) {\n    var _state$userSession;\n    return (_state$userSession = state.userSession) === null || _state$userSession === void 0 ? void 0 : _state$userSession.token;\n  });\n  var url = href;\n  if (!href && item) {\n    if (!item['@id']) {\n      // eslint-disable-next-line no-console\n      console.error('Invalid item passed to UniversalLink', item, props, children);\n      url = '#';\n    } else {\n      //case: generic item\n      url = flattenToAppURL(item['@id']);\n\n      //case: item like a Link\n      var remoteUrl = item.remoteUrl || item.getRemoteUrl;\n      if (!token && remoteUrl) {\n        url = remoteUrl;\n      }\n\n      //case: item of type 'File'\n      if (!token && config.settings.downloadableObjects.includes(item['@type'])) {\n        url = \"\".concat(url, \"/@@download/file\");\n      }\n      if (!token && config.settings.viewableInBrowserObjects.includes(item['@type'])) {\n        url = \"\".concat(url, \"/@@display-file/file\");\n      }\n    }\n  }\n  var isBlacklisted = ((_find = ((_config$settings$exte = config.settings.externalRoutes) !== null && _config$settings$exte !== void 0 ? _config$settings$exte : []).find(function (route) {\n    return matchPath(flattenToAppURL(url), route.match);\n  })) === null || _find === void 0 ? void 0 : _find.length) > 0;\n  var isExternal = !isInternalURL(url) || isBlacklisted;\n  var isDownload = !isExternal && url.includes('@@download') || download;\n  var isDisplayFile = !isExternal && url.includes('@@display-file') || false;\n  var checkedURL = URLUtils.checkAndNormalizeUrl(url);\n  url = checkedURL.url;\n  var tag = __jsx(Link, _extends({\n    to: flattenToAppURL(url),\n    target: (openLinkInNewTab !== null && openLinkInNewTab !== void 0 ? openLinkInNewTab : false) ? '_blank' : null,\n    title: title,\n    className: className\n  }, props, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 5\n    }\n  }), children);\n  if (isExternal) {\n    tag = __jsx(\"a\", _extends({\n      href: url,\n      title: title,\n      target: !checkedURL.isMail && !checkedURL.isTelephone && !(openLinkInNewTab === false) ? '_blank' : null,\n      rel: \"noopener noreferrer\",\n      className: className\n    }, props, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 7\n      }\n    }), children);\n  } else if (isDownload) {\n    tag = __jsx(\"a\", _extends({\n      href: flattenToAppURL(url),\n      download: true,\n      title: title,\n      className: className\n    }, props, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 7\n      }\n    }), children);\n  } else if (isDisplayFile) {\n    tag = __jsx(\"a\", _extends({\n      href: flattenToAppURL(url),\n      title: title,\n      target: \"_blank\",\n      rel: \"noopener noreferrer\",\n      className: className\n    }, props, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 7\n      }\n    }), children);\n  }\n  return tag;\n};\n_s(UniversalLink, \"bD5+gKbiITcJRDYAIJK4ZSEgato=\", false, function () {\n  return [useSelector];\n});\n_c = UniversalLink;\nUniversalLink.propTypes = {\n  href: PropTypes.string,\n  openLinkInNewTab: PropTypes.bool,\n  download: PropTypes.bool,\n  className: PropTypes.string,\n  title: PropTypes.string,\n  item: PropTypes.shape({\n    '@id': PropTypes.string.isRequired,\n    remoteUrl: PropTypes.string //of plone @type 'Link'\n  }),\n\n  children: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.node), PropTypes.node])\n};\nexport default UniversalLink;\nvar _c;\n$RefreshReg$(_c, \"UniversalLink\");","map":{"version":3,"names":["React","PropTypes","Link","useSelector","flattenToAppURL","isInternalURL","URLUtils","matchPath","config","UniversalLink","href","item","openLinkInNewTab","download","children","className","title","props","token","state","userSession","url","console","error","remoteUrl","getRemoteUrl","settings","downloadableObjects","includes","viewableInBrowserObjects","isBlacklisted","externalRoutes","find","route","match","length","isExternal","isDownload","isDisplayFile","checkedURL","checkAndNormalizeUrl","tag","isMail","isTelephone","propTypes","string","bool","shape","isRequired","oneOfType","arrayOf","node"],"sources":["/home/tooler/code/work/forests-frontend/node_modules/@plone/volto/src/components/manage/UniversalLink/UniversalLink.jsx"],"sourcesContent":["/*\n * UniversalLink\n * @module components/UniversalLink\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from 'react-router-dom';\nimport { useSelector } from 'react-redux';\nimport {\n  flattenToAppURL,\n  isInternalURL,\n  URLUtils,\n} from '@plone/volto/helpers/Url/Url';\nimport { matchPath } from 'react-router';\n\nimport config from '@plone/volto/registry';\n\nconst UniversalLink = ({\n  href,\n  item = null,\n  openLinkInNewTab,\n  download = false,\n  children,\n  className = null,\n  title = null,\n  ...props\n}) => {\n  const token = useSelector((state) => state.userSession?.token);\n\n  let url = href;\n  if (!href && item) {\n    if (!item['@id']) {\n      // eslint-disable-next-line no-console\n      console.error(\n        'Invalid item passed to UniversalLink',\n        item,\n        props,\n        children,\n      );\n      url = '#';\n    } else {\n      //case: generic item\n      url = flattenToAppURL(item['@id']);\n\n      //case: item like a Link\n      let remoteUrl = item.remoteUrl || item.getRemoteUrl;\n      if (!token && remoteUrl) {\n        url = remoteUrl;\n      }\n\n      //case: item of type 'File'\n      if (\n        !token &&\n        config.settings.downloadableObjects.includes(item['@type'])\n      ) {\n        url = `${url}/@@download/file`;\n      }\n\n      if (\n        !token &&\n        config.settings.viewableInBrowserObjects.includes(item['@type'])\n      ) {\n        url = `${url}/@@display-file/file`;\n      }\n    }\n  }\n\n  const isBlacklisted =\n    (config.settings.externalRoutes ?? []).find((route) =>\n      matchPath(flattenToAppURL(url), route.match),\n    )?.length > 0;\n  const isExternal = !isInternalURL(url) || isBlacklisted;\n  const isDownload = (!isExternal && url.includes('@@download')) || download;\n  const isDisplayFile =\n    (!isExternal && url.includes('@@display-file')) || false;\n\n  const checkedURL = URLUtils.checkAndNormalizeUrl(url);\n\n  url = checkedURL.url;\n\n  let tag = (\n    <Link\n      to={flattenToAppURL(url)}\n      target={openLinkInNewTab ?? false ? '_blank' : null}\n      title={title}\n      className={className}\n      {...props}\n    >\n      {children}\n    </Link>\n  );\n\n  if (isExternal) {\n    tag = (\n      <a\n        href={url}\n        title={title}\n        target={\n          !checkedURL.isMail &&\n          !checkedURL.isTelephone &&\n          !(openLinkInNewTab === false)\n            ? '_blank'\n            : null\n        }\n        rel=\"noopener noreferrer\"\n        className={className}\n        {...props}\n      >\n        {children}\n      </a>\n    );\n  } else if (isDownload) {\n    tag = (\n      <a\n        href={flattenToAppURL(url)}\n        download\n        title={title}\n        className={className}\n        {...props}\n      >\n        {children}\n      </a>\n    );\n  } else if (isDisplayFile) {\n    tag = (\n      <a\n        href={flattenToAppURL(url)}\n        title={title}\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n        className={className}\n        {...props}\n      >\n        {children}\n      </a>\n    );\n  }\n  return tag;\n};\n\nUniversalLink.propTypes = {\n  href: PropTypes.string,\n  openLinkInNewTab: PropTypes.bool,\n  download: PropTypes.bool,\n  className: PropTypes.string,\n  title: PropTypes.string,\n  item: PropTypes.shape({\n    '@id': PropTypes.string.isRequired,\n    remoteUrl: PropTypes.string, //of plone @type 'Link'\n  }),\n  children: PropTypes.oneOfType([\n    PropTypes.arrayOf(PropTypes.node),\n    PropTypes.node,\n  ]),\n};\n\nexport default UniversalLink;\n"],"mappings":"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"},"metadata":{"react-intl":{"messages":[]}},"sourceType":"module","externalDependencies":[]}