{"ast":null,"code":"import _without from \"lodash/without\";\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n/**\n * Data Providers reducer\n * @module reducers/data_providers\n */\n\nimport { GET_VISUALIZATION, REMOVE_VISUALIZATION } from '../constants';\nconst initialState = {\n  data: {},\n  error: null,\n  loaded: false,\n  loading: false,\n  pendingVisualizations: {},\n  failedVisualizations: {},\n  requested: []\n};\nexport default function data_providers(state = initialState, action = {}) {\n  const use_live_data = action.use_live_data;\n  const path = action.path ? action.path.replace(`/@${use_live_data ? 'visualization-layout' : 'visualization'}`, '') : undefined;\n  const pendingVisualizations = _objectSpread({}, state.pendingVisualizations);\n  const failedVisualizations = _objectSpread({}, state.failedVisualizations);\n  switch (action.type) {\n    case `${GET_VISUALIZATION}_PENDING`:\n      pendingVisualizations[path] = true;\n      delete failedVisualizations[path];\n      return _objectSpread(_objectSpread({}, state), {}, {\n        error: null,\n        loaded: false,\n        loading: true,\n        requested: [..._without(state.requested, path), path],\n        pendingVisualizations,\n        failedVisualizations\n      });\n    case `${GET_VISUALIZATION}_SUCCESS`:\n      delete pendingVisualizations[path];\n      return _objectSpread(_objectSpread({}, state), {}, {\n        error: null,\n        data: _objectSpread(_objectSpread({}, state.data), {}, {\n          [path]: action.result.visualization\n        }),\n        loaded: true,\n        loading: false,\n        requested: [..._without(state.requested, path)],\n        pendingVisualizations,\n        failedVisualizations\n      });\n    case `${GET_VISUALIZATION}_FAIL`:\n      delete pendingVisualizations[path];\n      failedVisualizations[path] = true;\n      return _objectSpread(_objectSpread({}, state), {}, {\n        error: action.error,\n        data: _objectSpread({}, state.data),\n        loaded: false,\n        loading: false,\n        // TODO: retry get?\n        requested: [..._without(state.requested, path)],\n        pendingVisualizations,\n        failedVisualizations\n      });\n    case REMOVE_VISUALIZATION:\n      const newData = _objectSpread({}, state.data);\n      delete newData[path];\n      return _objectSpread(_objectSpread({}, state), {}, {\n        data: _objectSpread({}, newData)\n      });\n    default:\n      return state;\n  }\n}","map":{"version":3,"names":["GET_VISUALIZATION","REMOVE_VISUALIZATION","initialState","data","error","loaded","loading","pendingVisualizations","failedVisualizations","requested","data_providers","state","action","use_live_data","path","replace","undefined","type","result","visualization","newData"],"sources":["/home/tooler/code/work/forests-frontend/node_modules/@eeacms/volto-plotlycharts/src/reducers/data_visualizations.js"],"sourcesContent":["/**\n * Data Providers reducer\n * @module reducers/data_providers\n */\n\nimport { GET_VISUALIZATION, REMOVE_VISUALIZATION } from '../constants';\nimport { without } from 'lodash';\n\nconst initialState = {\n  data: {},\n  error: null,\n  loaded: false,\n  loading: false,\n  pendingVisualizations: {},\n  failedVisualizations: {},\n  requested: [],\n};\n\nexport default function data_providers(state = initialState, action = {}) {\n  const use_live_data = action.use_live_data;\n  const path = action.path\n    ? action.path.replace(\n        `/@${use_live_data ? 'visualization-layout' : 'visualization'}`,\n        '',\n      )\n    : undefined;\n  const pendingVisualizations = { ...state.pendingVisualizations };\n  const failedVisualizations = { ...state.failedVisualizations };\n\n  switch (action.type) {\n    case `${GET_VISUALIZATION}_PENDING`:\n      pendingVisualizations[path] = true;\n      delete failedVisualizations[path];\n\n      return {\n        ...state,\n        error: null,\n        loaded: false,\n        loading: true,\n        requested: [...without(state.requested, path), path],\n        pendingVisualizations,\n        failedVisualizations,\n      };\n\n    case `${GET_VISUALIZATION}_SUCCESS`:\n      delete pendingVisualizations[path];\n      return {\n        ...state,\n        error: null,\n        data: {\n          ...state.data,\n          [path]: action.result.visualization,\n        },\n        loaded: true,\n        loading: false,\n        requested: [...without(state.requested, path)],\n        pendingVisualizations,\n        failedVisualizations,\n      };\n\n    case `${GET_VISUALIZATION}_FAIL`:\n      delete pendingVisualizations[path];\n      failedVisualizations[path] = true;\n\n      return {\n        ...state,\n        error: action.error,\n        data: { ...state.data },\n        loaded: false,\n        loading: false,\n        // TODO: retry get?\n        requested: [...without(state.requested, path)],\n        pendingVisualizations,\n        failedVisualizations,\n      };\n\n    case REMOVE_VISUALIZATION:\n      const newData = { ...state.data };\n      delete newData[path];\n\n      return {\n        ...state,\n        data: { ...newData },\n      };\n\n    default:\n      return state;\n  }\n}\n"],"mappings":";;;;AAAA;AACA;AACA;AACA;;AAEA,SAASA,iBAAiB,EAAEC,oBAAoB,QAAQ,cAAc;AAGtE,MAAMC,YAAY,GAAG;EACnBC,IAAI,EAAE,CAAC,CAAC;EACRC,KAAK,EAAE,IAAI;EACXC,MAAM,EAAE,KAAK;EACbC,OAAO,EAAE,KAAK;EACdC,qBAAqB,EAAE,CAAC,CAAC;EACzBC,oBAAoB,EAAE,CAAC,CAAC;EACxBC,SAAS,EAAE;AACb,CAAC;AAED,eAAe,SAASC,cAAc,CAACC,KAAK,GAAGT,YAAY,EAAEU,MAAM,GAAG,CAAC,CAAC,EAAE;EACxE,MAAMC,aAAa,GAAGD,MAAM,CAACC,aAAa;EAC1C,MAAMC,IAAI,GAAGF,MAAM,CAACE,IAAI,GACpBF,MAAM,CAACE,IAAI,CAACC,OAAO,CAChB,KAAIF,aAAa,GAAG,sBAAsB,GAAG,eAAgB,EAAC,EAC/D,EAAE,CACH,GACDG,SAAS;EACb,MAAMT,qBAAqB,qBAAQI,KAAK,CAACJ,qBAAqB,CAAE;EAChE,MAAMC,oBAAoB,qBAAQG,KAAK,CAACH,oBAAoB,CAAE;EAE9D,QAAQI,MAAM,CAACK,IAAI;IACjB,KAAM,GAAEjB,iBAAkB,UAAS;MACjCO,qBAAqB,CAACO,IAAI,CAAC,GAAG,IAAI;MAClC,OAAON,oBAAoB,CAACM,IAAI,CAAC;MAEjC,uCACKH,KAAK;QACRP,KAAK,EAAE,IAAI;QACXC,MAAM,EAAE,KAAK;QACbC,OAAO,EAAE,IAAI;QACbG,SAAS,EAAE,CAAC,GAAG,SAAQE,KAAK,CAACF,SAAS,EAAEK,IAAI,CAAC,EAAEA,IAAI,CAAC;QACpDP,qBAAqB;QACrBC;MAAoB;IAGxB,KAAM,GAAER,iBAAkB,UAAS;MACjC,OAAOO,qBAAqB,CAACO,IAAI,CAAC;MAClC,uCACKH,KAAK;QACRP,KAAK,EAAE,IAAI;QACXD,IAAI,kCACCQ,KAAK,CAACR,IAAI;UACb,CAACW,IAAI,GAAGF,MAAM,CAACM,MAAM,CAACC;QAAa,EACpC;QACDd,MAAM,EAAE,IAAI;QACZC,OAAO,EAAE,KAAK;QACdG,SAAS,EAAE,CAAC,GAAG,SAAQE,KAAK,CAACF,SAAS,EAAEK,IAAI,CAAC,CAAC;QAC9CP,qBAAqB;QACrBC;MAAoB;IAGxB,KAAM,GAAER,iBAAkB,OAAM;MAC9B,OAAOO,qBAAqB,CAACO,IAAI,CAAC;MAClCN,oBAAoB,CAACM,IAAI,CAAC,GAAG,IAAI;MAEjC,uCACKH,KAAK;QACRP,KAAK,EAAEQ,MAAM,CAACR,KAAK;QACnBD,IAAI,oBAAOQ,KAAK,CAACR,IAAI,CAAE;QACvBE,MAAM,EAAE,KAAK;QACbC,OAAO,EAAE,KAAK;QACd;QACAG,SAAS,EAAE,CAAC,GAAG,SAAQE,KAAK,CAACF,SAAS,EAAEK,IAAI,CAAC,CAAC;QAC9CP,qBAAqB;QACrBC;MAAoB;IAGxB,KAAKP,oBAAoB;MACvB,MAAMmB,OAAO,qBAAQT,KAAK,CAACR,IAAI,CAAE;MACjC,OAAOiB,OAAO,CAACN,IAAI,CAAC;MAEpB,uCACKH,KAAK;QACRR,IAAI,oBAAOiB,OAAO;MAAE;IAGxB;MACE,OAAOT,KAAK;EAAC;AAEnB"},"metadata":{"react-intl":{"messages":[]}},"sourceType":"module","externalDependencies":[]}