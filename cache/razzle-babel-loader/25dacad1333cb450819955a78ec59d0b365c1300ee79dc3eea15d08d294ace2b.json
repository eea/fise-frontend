{"ast":null,"code":"import _extends from \"/home/tooler/code/work/forests-frontend/node_modules/@babel/runtime/helpers/esm/extends.js\";\nimport _slicedToArray from \"/home/tooler/code/work/forests-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _objectSpread from \"/home/tooler/code/work/forests-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _defineProperty from \"/home/tooler/code/work/forests-frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport _toConsumableArray from \"/home/tooler/code/work/forests-frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _isFunction from \"lodash/isFunction\";\nimport _isEqual from \"lodash/isEqual\";\nvar _jsxFileName = \"/home/tooler/code/work/forests-frontend/node_modules/@plone/volto/src/components/manage/Blocks/Search/SearchBlockView.jsx\",\n  _this = this,\n  _s = $RefreshSig$();\nvar __jsx = React.createElement;\nimport React from 'react';\nimport ListingBody from '@plone/volto/components/manage/Blocks/Listing/ListingBody';\nimport { withBlockExtensions } from '@plone/volto/helpers';\nimport config from '@plone/volto/registry';\nimport { withSearch, withQueryString } from './hocs';\nimport { compose } from 'redux';\nimport { useSelector } from 'react-redux';\nvar getListingBodyVariation = function getListingBodyVariation(data) {\n  var variations = config.blocks.blocksConfig.listing.variations;\n  var variation = data.listingBodyTemplate ? variations.find(function (_ref) {\n    var id = _ref.id;\n    return id === data.listingBodyTemplate;\n  }) : variations.find(function (_ref2) {\n    var isDefault = _ref2.isDefault;\n    return isDefault;\n  });\n  if (!variation) variation = variations[0];\n  return variation;\n};\nvar isfunc = function isfunc(obj) {\n  return _isFunction(obj) || typeof obj === 'function';\n};\nvar _filtered = function _filtered(obj) {\n  return Object.assign.apply(Object, [{}].concat(_toConsumableArray(Object.keys(obj).map(function (k) {\n    var reject = k !== 'properties' && !isfunc(obj[k]);\n    return reject ? _defineProperty({}, k, obj[k]) : {};\n  }))));\n};\nvar blockPropsAreChanged = function blockPropsAreChanged(prevProps, nextProps) {\n  var prev = _filtered(prevProps);\n  var next = _filtered(nextProps);\n  return _isEqual(prev, next);\n};\nvar applyDefaults = function applyDefaults(data, root) {\n  var _data$query;\n  var defaultQuery = [{\n    i: 'path',\n    o: 'plone.app.querystring.operation.string.absolutePath',\n    v: root || '/'\n  }];\n  return _objectSpread(_objectSpread({}, data), {}, {\n    sort_on: (data === null || data === void 0 ? void 0 : data.sort_on) || 'effective',\n    sort_order: (data === null || data === void 0 ? void 0 : data.sort_order) || 'descending',\n    query: data !== null && data !== void 0 && (_data$query = data.query) !== null && _data$query !== void 0 && _data$query.length ? data.query : defaultQuery\n  });\n};\nvar SearchBlockView = function SearchBlockView(props) {\n  _s();\n  var data = props.data,\n    searchData = props.searchData,\n    _props$mode = props.mode,\n    mode = _props$mode === void 0 ? 'view' : _props$mode,\n    variation = props.variation;\n  var Layout = variation.view;\n  var _React$useState = React.useState(getListingBodyVariation(data).id),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    selectedView = _React$useState2[0],\n    setSelectedView = _React$useState2[1];\n  var root = useSelector(function (state) {\n    return state.breadcrumbs.root;\n  });\n  var listingBodyData = applyDefaults(searchData, root);\n  var variations = config.blocks.blocksConfig.listing.variations;\n  var listingBodyVariation = variations.find(function (_ref4) {\n    var id = _ref4.id;\n    return id === selectedView;\n  });\n  return __jsx(\"div\", {\n    className: \"block search\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 5\n    }\n  }, __jsx(Layout, _extends({}, props, {\n    isEditMode: mode === 'edit',\n    selectedView: selectedView,\n    setSelectedView: setSelectedView,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 7\n    }\n  }), __jsx(ListingBody, {\n    variation: _objectSpread(_objectSpread({}, data), listingBodyVariation),\n    data: listingBodyData,\n    path: props.path,\n    isEditMode: mode === 'edit',\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 9\n    }\n  })));\n};\n_s(SearchBlockView, \"a3duH22ac0GGjwzb2eke1O1LVaM=\", false, function () {\n  return [useSelector];\n});\n_c = SearchBlockView;\nexport var SearchBlockViewComponent = compose(withBlockExtensions, function (Component) {\n  return /*#__PURE__*/React.memo(Component, blockPropsAreChanged);\n})(SearchBlockView);\nexport default compose(withQueryString, withSearch())(SearchBlockViewComponent);\nvar _c;\n$RefreshReg$(_c, \"SearchBlockView\");","map":{"version":3,"names":["React","ListingBody","withBlockExtensions","config","withSearch","withQueryString","compose","useSelector","getListingBodyVariation","data","variations","blocks","blocksConfig","listing","variation","listingBodyTemplate","find","id","isDefault","isfunc","obj","_filtered","Object","assign","keys","map","k","reject","blockPropsAreChanged","prevProps","nextProps","prev","next","applyDefaults","root","defaultQuery","i","o","v","sort_on","sort_order","query","length","SearchBlockView","props","searchData","mode","Layout","view","useState","selectedView","setSelectedView","state","breadcrumbs","listingBodyData","listingBodyVariation","path","SearchBlockViewComponent","Component","memo"],"sources":["/home/tooler/code/work/forests-frontend/node_modules/@plone/volto/src/components/manage/Blocks/Search/SearchBlockView.jsx"],"sourcesContent":["import React from 'react';\n\nimport ListingBody from '@plone/volto/components/manage/Blocks/Listing/ListingBody';\nimport { withBlockExtensions } from '@plone/volto/helpers';\n\nimport config from '@plone/volto/registry';\n\nimport { withSearch, withQueryString } from './hocs';\nimport { compose } from 'redux';\nimport { useSelector } from 'react-redux';\nimport { isEqual, isFunction } from 'lodash';\n\nconst getListingBodyVariation = (data) => {\n  const { variations } = config.blocks.blocksConfig.listing;\n\n  let variation = data.listingBodyTemplate\n    ? variations.find(({ id }) => id === data.listingBodyTemplate)\n    : variations.find(({ isDefault }) => isDefault);\n\n  if (!variation) variation = variations[0];\n\n  return variation;\n};\n\nconst isfunc = (obj) => isFunction(obj) || typeof obj === 'function';\n\nconst _filtered = (obj) =>\n  Object.assign(\n    {},\n    ...Object.keys(obj).map((k) => {\n      const reject = k !== 'properties' && !isfunc(obj[k]);\n      return reject ? { [k]: obj[k] } : {};\n    }),\n  );\n\nconst blockPropsAreChanged = (prevProps, nextProps) => {\n  const prev = _filtered(prevProps);\n  const next = _filtered(nextProps);\n\n  return isEqual(prev, next);\n};\n\nconst applyDefaults = (data, root) => {\n  const defaultQuery = [\n    {\n      i: 'path',\n      o: 'plone.app.querystring.operation.string.absolutePath',\n      v: root || '/',\n    },\n  ];\n  return {\n    ...data,\n    sort_on: data?.sort_on || 'effective',\n    sort_order: data?.sort_order || 'descending',\n    query: data?.query?.length ? data.query : defaultQuery,\n  };\n};\n\nconst SearchBlockView = (props) => {\n  const { data, searchData, mode = 'view', variation } = props;\n\n  const Layout = variation.view;\n\n  const [selectedView, setSelectedView] = React.useState(\n    getListingBodyVariation(data).id,\n  );\n  const root = useSelector((state) => state.breadcrumbs.root);\n  const listingBodyData = applyDefaults(searchData, root);\n\n  const { variations } = config.blocks.blocksConfig.listing;\n  const listingBodyVariation = variations.find(({ id }) => id === selectedView);\n\n  return (\n    <div className=\"block search\">\n      <Layout\n        {...props}\n        isEditMode={mode === 'edit'}\n        selectedView={selectedView}\n        setSelectedView={setSelectedView}\n      >\n        <ListingBody\n          variation={{ ...data, ...listingBodyVariation }}\n          data={listingBodyData}\n          path={props.path}\n          isEditMode={mode === 'edit'}\n        />\n      </Layout>\n    </div>\n  );\n};\n\nexport const SearchBlockViewComponent = compose(\n  withBlockExtensions,\n  (Component) => React.memo(Component, blockPropsAreChanged),\n)(SearchBlockView);\n\nexport default compose(withQueryString, withSearch())(SearchBlockViewComponent);\n"],"mappings":"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"},"metadata":{"react-intl":{"messages":[]}},"sourceType":"module","externalDependencies":[]}