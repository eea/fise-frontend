{"ast":null,"code":"const doiRegex = '(10[.][0-9]{4,}(?:[.][0-9]+)*/(?:(?![%\"#? ])\\\\S)+)';\nconst doi = opts => {\n  opts = opts || {};\n  return opts.exact ? new RegExp('(?:^' + doiRegex + '$)') : new RegExp('(?:' + doiRegex + ')', 'g');\n};\nexport const findDOI = newStr => {\n  if (!newStr) {\n    return;\n  }\n  const words = newStr.split(' ');\n  const results = [];\n  words.forEach(word => {\n    const match = doi().exec(word);\n    if (match) {\n      results.push(match[0]);\n    }\n  });\n  return results;\n};\nexport const formatCitation = selectedItem => {\n  var _data$creators$, _data$creators$2, _data$creators$3, _data$creators$4, _data$creators$5, _data$creators$6, _data$creators$7, _data$creators$8;\n  const {\n    data\n  } = selectedItem;\n  const result = [];\n  const name = data.creators ? data !== null && data !== void 0 && data.creators[0] ? data !== null && data !== void 0 && data.creators[0].name ? `${(_data$creators$ = data.creators[0]) === null || _data$creators$ === void 0 ? void 0 : _data$creators$.name}` : (_data$creators$2 = data.creators[0]) !== null && _data$creators$2 !== void 0 && _data$creators$2.lastName && (_data$creators$3 = data.creators[0]) !== null && _data$creators$3 !== void 0 && _data$creators$3.firstName ? `${(_data$creators$4 = data.creators[0]) === null || _data$creators$4 === void 0 ? void 0 : _data$creators$4.lastName}, ${(_data$creators$5 = data.creators[0]) === null || _data$creators$5 === void 0 ? void 0 : _data$creators$5.firstName}` : (_data$creators$6 = data.creators[0]) !== null && _data$creators$6 !== void 0 && _data$creators$6.lastName ? `${(_data$creators$7 = data.creators[0]) === null || _data$creators$7 === void 0 ? void 0 : _data$creators$7.lastName}` : `${(_data$creators$8 = data.creators[0]) === null || _data$creators$8 === void 0 ? void 0 : _data$creators$8.firstName}` : null : null;\n  const date = data.date ? ` ${data.date}` : null;\n  const title = data.title ? ` ${data.title.slice(0, 40)}` : data.nameOfAct ? ` ${data.nameOfAct}` : data.name ? ` ${data.name}` : null;\n  const publicationTitle = data.publicationTitle ? ` ${data.publicationTitle}` : null;\n  const place = data.place ? ` ${data.place}` : null;\n  if (name) result.push(name);\n  if (date) result.push(date);\n  if (title) result.push(title);\n  if (publicationTitle) result.push(publicationTitle);\n  if (place) result.push(place);\n  return result.join(', ');\n};\nconst openAireUrlBase = `https://api.openaire.eu/search`;\nexport const makeOpenAireUrlObj = filterList => {\n  const openAireUrl = {\n    publications: `${openAireUrlBase}/publications`,\n    rsd: `${openAireUrlBase}/datasets`\n  };\n  return filterList.reduce((accumulator, currentValue) => {\n    return [...accumulator, openAireUrl[currentValue]];\n  }, []);\n};\nexport const formatOpenAire = (item, label, parentCollection) => {\n  var _entry$publisher;\n  const entry = item.metadata['oaf:entity']['oaf:result'];\n  const result = {\n    data: {},\n    icon: 'openaire',\n    label,\n    isOpenAire: true,\n    citationTitle: ''\n  };\n  const hasDoi = entry.pid ? Array.isArray(entry.pid) ? entry.pid.find(key => key['@classid'] === 'doi') : entry.pid ? entry.pid['@classid'] === 'doi' ? entry.pid : null : null : null;\n  result.data = {\n    title: entry.title ? entry.title[0] ? entry.title[0]['$'] : entry.title['$'] : '',\n    itemType: 'journalArticle',\n    DOI: hasDoi ? hasDoi['$'] : null,\n    creators: Array.isArray(entry.creator) ? entry.creator.map(creator => {\n      return {\n        creatorType: 'author',\n        lastName: creator['@surname'] || creator.$,\n        firstName: creator['@name'] || ''\n      };\n    }) : entry.creator ? [{\n      creatorType: 'author',\n      lastName: entry.creator['@surname'] || entry.creator.$,\n      firstName: entry.creator['@name'] || ''\n    }] : [],\n    url: entry.url,\n    publicationTitle: (_entry$publisher = entry.publisher) === null || _entry$publisher === void 0 ? void 0 : _entry$publisher.$,\n    date: entry.dateofacceptance && entry.dateofacceptance.$ ? new Date(entry.dateofacceptance.$).getUTCFullYear() : null,\n    collections: [parentCollection],\n    relations: {}\n  };\n  result.citationTitle = formatCitation(result);\n  return result;\n};","map":{"version":3,"names":["doiRegex","doi","opts","exact","RegExp","findDOI","newStr","words","split","results","forEach","word","match","exec","push","formatCitation","selectedItem","data","result","name","creators","lastName","firstName","date","title","slice","nameOfAct","publicationTitle","place","join","openAireUrlBase","makeOpenAireUrlObj","filterList","openAireUrl","publications","rsd","reduce","accumulator","currentValue","formatOpenAire","item","label","parentCollection","entry","metadata","icon","isOpenAire","citationTitle","hasDoi","pid","Array","isArray","find","key","itemType","DOI","creator","map","creatorType","$","url","publisher","dateofacceptance","Date","getUTCFullYear","collections","relations"],"sources":["/home/tooler/code/work/forests-frontend/node_modules/@eeacms/volto-slate-zotero/src/plugins/zotero/editor/utils.js"],"sourcesContent":["const doiRegex = '(10[.][0-9]{4,}(?:[.][0-9]+)*/(?:(?![%\"#? ])\\\\S)+)';\nconst doi = (opts) => {\n  opts = opts || {};\n  return opts.exact\n    ? new RegExp('(?:^' + doiRegex + '$)')\n    : new RegExp('(?:' + doiRegex + ')', 'g');\n};\nexport const findDOI = (newStr) => {\n  if (!newStr) {\n    return;\n  }\n\n  const words = newStr.split(' ');\n  const results = [];\n  words.forEach((word) => {\n    const match = doi().exec(word);\n\n    if (match) {\n      results.push(match[0]);\n    }\n  });\n\n  return results;\n};\n\nexport const formatCitation = (selectedItem) => {\n  const { data } = selectedItem;\n  const result = [];\n  const name = data.creators\n    ? data?.creators[0]\n      ? data?.creators[0].name\n        ? `${data.creators[0]?.name}`\n        : data.creators[0]?.lastName && data.creators[0]?.firstName\n        ? `${data.creators[0]?.lastName}, ${data.creators[0]?.firstName}`\n        : data.creators[0]?.lastName\n        ? `${data.creators[0]?.lastName}`\n        : `${data.creators[0]?.firstName}`\n      : null\n    : null;\n  const date = data.date ? ` ${data.date}` : null;\n  const title = data.title\n    ? ` ${data.title.slice(0, 40)}`\n    : data.nameOfAct\n    ? ` ${data.nameOfAct}`\n    : data.name\n    ? ` ${data.name}`\n    : null;\n  const publicationTitle = data.publicationTitle\n    ? ` ${data.publicationTitle}`\n    : null;\n  const place = data.place ? ` ${data.place}` : null;\n  if (name) result.push(name);\n  if (date) result.push(date);\n  if (title) result.push(title);\n  if (publicationTitle) result.push(publicationTitle);\n  if (place) result.push(place);\n\n  return result.join(', ');\n};\n\nconst openAireUrlBase = `https://api.openaire.eu/search`;\nexport const makeOpenAireUrlObj = (filterList) => {\n  const openAireUrl = {\n    publications: `${openAireUrlBase}/publications`,\n    rsd: `${openAireUrlBase}/datasets`,\n  };\n\n  return filterList.reduce((accumulator, currentValue) => {\n    return [...accumulator, openAireUrl[currentValue]];\n  }, []);\n};\n\nexport const formatOpenAire = (item, label, parentCollection) => {\n  const entry = item.metadata['oaf:entity']['oaf:result'];\n  const result = {\n    data: {},\n    icon: 'openaire',\n    label,\n    isOpenAire: true,\n    citationTitle: '',\n  };\n\n  const hasDoi = entry.pid\n    ? Array.isArray(entry.pid)\n      ? entry.pid.find((key) => key['@classid'] === 'doi')\n      : entry.pid\n      ? entry.pid['@classid'] === 'doi'\n        ? entry.pid\n        : null\n      : null\n    : null;\n\n  result.data = {\n    title: entry.title\n      ? entry.title[0]\n        ? entry.title[0]['$']\n        : entry.title['$']\n      : '',\n    itemType: 'journalArticle',\n    DOI: hasDoi ? hasDoi['$'] : null,\n    creators: Array.isArray(entry.creator)\n      ? entry.creator.map((creator) => {\n          return {\n            creatorType: 'author',\n            lastName: creator['@surname'] || creator.$,\n            firstName: creator['@name'] || '',\n          };\n        })\n      : entry.creator\n      ? [\n          {\n            creatorType: 'author',\n            lastName: entry.creator['@surname'] || entry.creator.$,\n            firstName: entry.creator['@name'] || '',\n          },\n        ]\n      : [],\n    url: entry.url,\n    publicationTitle: entry.publisher?.$,\n    date:\n      entry.dateofacceptance && entry.dateofacceptance.$\n        ? new Date(entry.dateofacceptance.$).getUTCFullYear()\n        : null,\n    collections: [parentCollection],\n    relations: {},\n  };\n  result.citationTitle = formatCitation(result);\n\n  return result;\n};\n"],"mappings":"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"},"metadata":{"react-intl":{"messages":[]}},"sourceType":"module","externalDependencies":[]}