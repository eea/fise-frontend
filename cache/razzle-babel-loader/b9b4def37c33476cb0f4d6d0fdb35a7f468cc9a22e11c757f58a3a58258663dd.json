{"ast":null,"code":"var _jsxFileName = \"/home/tooler/code/work/forests-frontend/src/develop/volto-slate-footnote/src/Blocks/Footnote/FootnotesBlockView.jsx\",\n  _this = this,\n  _s = $RefreshSig$();\nvar __jsx = React.createElement;\nimport React, { useEffect, useState } from 'react';\nimport { openAccordionIfContainsFootnoteReference, getAllBlocksAndSlateFields, makeFootnoteListOfUniqueItems, makeFootnote } from '@eeacms/volto-slate-footnote/editor/utils';\nimport './less/public.less';\nvar alphabet = 'abcdefghijklmnopqrstuvwxyz';\n\n/**\n * @summary The React component that displays the list of footnotes inserted\n * before in the current page.\n * Will show an indice for the footnote/citation but also numbers to indicate each\n * text that has same reference\n * @param {Object} props Contains the properties `data` and `properties` as\n * received from the Volto form.\n */\nvar FootnotesBlockView = function FootnotesBlockView(props) {\n  _s();\n  var data = props.data,\n    properties = props.properties;\n  var title = data.title,\n    global = data.global,\n    _data$placeholder = data.placeholder,\n    placeholder = _data$placeholder === void 0 ? 'Footnotes' : _data$placeholder;\n  var _useState = useState(null),\n    notesObj = _useState[0],\n    setNodesObjs = _useState[1];\n  var metadata = props.metadata ? props.metadata : properties;\n  useEffect(function () {\n    if (properties) {\n      var globalMetadata = global ? metadata : properties;\n      var blocks = getAllBlocksAndSlateFields(globalMetadata);\n      var notesObjResult = makeFootnoteListOfUniqueItems(blocks);\n      setNodesObjs(notesObjResult);\n    }\n  }, [properties]); // eslint-disable-line\n\n  return __jsx(\"div\", {\n    className: \"footnotes-listing-block\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 37,\n      columnNumber: 5\n    }\n  }, __jsx(\"h3\", {\n    title: placeholder,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 38,\n      columnNumber: 7\n    }\n  }, title), notesObj && __jsx(\"ol\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 40,\n      columnNumber: 9\n    }\n  }, Object.keys(notesObj).map(function (noteId) {\n    var note = notesObj[noteId];\n    var uid = note.uid,\n      footnote = note.footnote,\n      zoteroId = note.zoteroId,\n      parentUid = note.parentUid;\n    var refs = note.refs;\n    var refsList = refs ? Object.keys(refs) : null;\n    return __jsx(\"li\", {\n      key: \"footnote-\".concat(zoteroId || uid),\n      id: \"footnote-\".concat(zoteroId || uid),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 15\n      }\n    }, __jsx(\"div\", {\n      dangerouslySetInnerHTML: {\n        __html: makeFootnote(footnote)\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 52,\n        columnNumber: 17\n      }\n    }), refsList ? __jsx(React.Fragment, null, __jsx(\"sup\", {\n      id: \"cite_ref-\".concat(refsList[0]),\n      key: \"indice-\".concat(refsList[0]),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 21\n      }\n    }, __jsx(\"a\", {\n      href: \"#ref-\".concat(parentUid || uid),\n      \"aria-label\": \"Back to content\",\n      onClick: function onClick() {\n        return openAccordionIfContainsFootnoteReference(\"#ref-\".concat(parentUid || uid));\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 23\n      }\n    }, alphabet[0]), ' '), refsList.slice(1).map(function (ref, index) {\n      return __jsx(\"sup\", {\n        id: \"cite_ref-\".concat(ref),\n        key: \"indice-\".concat(ref),\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 23\n        }\n      }, __jsx(\"a\", {\n        href: \"#ref-\".concat(ref),\n        \"aria-label\": \"Back to content\",\n        onClick: function onClick() {\n          return openAccordionIfContainsFootnoteReference(\"#ref-\".concat(ref));\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 25\n        }\n      }, alphabet[index + 1]), ' ');\n    })) : __jsx(\"sup\", {\n      id: \"cite_ref-\".concat(uid),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 19\n      }\n    }, __jsx(\"a\", {\n      href: \"#ref-\".concat(parentUid || uid),\n      \"aria-label\": \"Back to content\",\n      onClick: function onClick() {\n        return openAccordionIfContainsFootnoteReference(\"#ref-\".concat(parentUid || uid));\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 21\n      }\n    }, \"\\u21B5\"), ' '));\n  })));\n};\n_s(FootnotesBlockView, \"KgnALp0V2aRsjrkUcpTydvITKHc=\");\n_c = FootnotesBlockView;\nexport default FootnotesBlockView;\nvar _c;\n$RefreshReg$(_c, \"FootnotesBlockView\");","map":{"version":3,"names":["React","useEffect","useState","openAccordionIfContainsFootnoteReference","getAllBlocksAndSlateFields","makeFootnoteListOfUniqueItems","makeFootnote","alphabet","FootnotesBlockView","props","data","properties","title","global","placeholder","notesObj","setNodesObjs","metadata","globalMetadata","blocks","notesObjResult","Object","keys","map","noteId","note","uid","footnote","zoteroId","parentUid","refs","refsList","__html","slice","ref","index"],"sources":["/home/tooler/code/work/forests-frontend/src/develop/volto-slate-footnote/src/Blocks/Footnote/FootnotesBlockView.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport {\n  openAccordionIfContainsFootnoteReference,\n  getAllBlocksAndSlateFields,\n  makeFootnoteListOfUniqueItems,\n  makeFootnote,\n} from '@eeacms/volto-slate-footnote/editor/utils';\nimport './less/public.less';\n\nconst alphabet = 'abcdefghijklmnopqrstuvwxyz';\n\n/**\n * @summary The React component that displays the list of footnotes inserted\n * before in the current page.\n * Will show an indice for the footnote/citation but also numbers to indicate each\n * text that has same reference\n * @param {Object} props Contains the properties `data` and `properties` as\n * received from the Volto form.\n */\nconst FootnotesBlockView = (props) => {\n  const { data, properties } = props;\n  const { title, global, placeholder = 'Footnotes' } = data;\n  const [notesObj, setNodesObjs] = useState(null);\n  const metadata = props.metadata ? props.metadata : properties;\n\n  useEffect(() => {\n    if (properties) {\n      const globalMetadata = global ? metadata : properties;\n      const blocks = getAllBlocksAndSlateFields(globalMetadata);\n      const notesObjResult = makeFootnoteListOfUniqueItems(blocks);\n\n      setNodesObjs(notesObjResult);\n    }\n  }, [properties]); // eslint-disable-line\n\n  return (\n    <div className=\"footnotes-listing-block\">\n      <h3 title={placeholder}>{title}</h3>\n      {notesObj && (\n        <ol>\n          {Object.keys(notesObj).map((noteId) => {\n            const note = notesObj[noteId];\n            const { uid, footnote, zoteroId, parentUid } = note;\n            const { refs } = note;\n            const refsList = refs ? Object.keys(refs) : null;\n\n            return (\n              <li\n                key={`footnote-${zoteroId || uid}`}\n                id={`footnote-${zoteroId || uid}`}\n              >\n                <div\n                  dangerouslySetInnerHTML={{\n                    __html: makeFootnote(footnote),\n                  }}\n                />\n                {refsList ? (\n                  <>\n                    {/** some footnotes are never parent so we need the parent to reference */}\n                    {/** in this case the first from refs has reference to the parent*/}\n                    <sup\n                      id={`cite_ref-${refsList[0]}`}\n                      key={`indice-${refsList[0]}`}\n                    >\n                      <a\n                        href={`#ref-${parentUid || uid}`}\n                        aria-label=\"Back to content\"\n                        onClick={() =>\n                          openAccordionIfContainsFootnoteReference(\n                            `#ref-${parentUid || uid}`,\n                          )\n                        }\n                      >\n                        {alphabet[0]}\n                      </a>{' '}\n                    </sup>\n                    {/** following refs will have the uid of the one that references it*/}\n                    {refsList.slice(1).map((ref, index) => (\n                      <sup id={`cite_ref-${ref}`} key={`indice-${ref}`}>\n                        <a\n                          href={`#ref-${ref}`}\n                          aria-label=\"Back to content\"\n                          onClick={() =>\n                            openAccordionIfContainsFootnoteReference(\n                              `#ref-${ref}`,\n                            )\n                          }\n                        >\n                          {alphabet[index + 1]}\n                        </a>{' '}\n                      </sup>\n                    ))}\n                  </>\n                ) : (\n                  <sup id={`cite_ref-${uid}`}>\n                    {/** some footnotes are never parent so we need the parent to reference */}\n                    <a\n                      href={`#ref-${parentUid || uid}`}\n                      aria-label=\"Back to content\"\n                      onClick={() =>\n                        openAccordionIfContainsFootnoteReference(\n                          `#ref-${parentUid || uid}`,\n                        )\n                      }\n                    >\n                      ↵\n                    </a>{' '}\n                  </sup>\n                )}\n              </li>\n            );\n          })}\n        </ol>\n      )}\n    </div>\n  );\n};\n\nexport default FootnotesBlockView;\n"],"mappings":"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"},"metadata":{"react-intl":{"messages":[]}},"sourceType":"module","externalDependencies":[]}