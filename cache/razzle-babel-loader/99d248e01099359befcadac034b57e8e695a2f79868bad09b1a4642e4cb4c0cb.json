{"ast":null,"code":"const _excluded = [\"href\", \"item\", \"openLinkInNewTab\", \"download\", \"children\", \"className\", \"title\"];\nvar _jsxFileName = \"/home/tooler/code/work/forests-frontend/node_modules/@plone/volto/src/components/manage/UniversalLink/UniversalLink.jsx\";\nvar __jsx = React.createElement;\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n/*\n * UniversalLink\n * @module components/UniversalLink\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from 'react-router-dom';\nimport { useSelector } from 'react-redux';\nimport { flattenToAppURL, isInternalURL, URLUtils } from '@plone/volto/helpers/Url/Url';\nimport { matchPath } from 'react-router';\nimport config from '@plone/volto/registry';\nconst UniversalLink = _ref => {\n  var _find, _config$settings$exte;\n  let {\n      href,\n      item = null,\n      openLinkInNewTab,\n      download = false,\n      children,\n      className = null,\n      title = null\n    } = _ref,\n    props = _objectWithoutProperties(_ref, _excluded);\n  const token = useSelector(state => {\n    var _state$userSession;\n    return (_state$userSession = state.userSession) === null || _state$userSession === void 0 ? void 0 : _state$userSession.token;\n  });\n  let url = href;\n  if (!href && item) {\n    if (!item['@id']) {\n      // eslint-disable-next-line no-console\n      console.error('Invalid item passed to UniversalLink', item, props, children);\n      url = '#';\n    } else {\n      //case: generic item\n      url = flattenToAppURL(item['@id']);\n\n      //case: item like a Link\n      let remoteUrl = item.remoteUrl || item.getRemoteUrl;\n      if (!token && remoteUrl) {\n        url = remoteUrl;\n      }\n\n      //case: item of type 'File'\n      if (!token && config.settings.downloadableObjects.includes(item['@type'])) {\n        url = `${url}/@@download/file`;\n      }\n      if (!token && config.settings.viewableInBrowserObjects.includes(item['@type'])) {\n        url = `${url}/@@display-file/file`;\n      }\n    }\n  }\n  const isBlacklisted = ((_find = ((_config$settings$exte = config.settings.externalRoutes) !== null && _config$settings$exte !== void 0 ? _config$settings$exte : []).find(route => matchPath(flattenToAppURL(url), route.match))) === null || _find === void 0 ? void 0 : _find.length) > 0;\n  const isExternal = !isInternalURL(url) || isBlacklisted;\n  const isDownload = !isExternal && url.includes('@@download') || download;\n  const isDisplayFile = !isExternal && url.includes('@@display-file') || false;\n  const checkedURL = URLUtils.checkAndNormalizeUrl(url);\n  url = checkedURL.url;\n  let tag = __jsx(Link, _extends({\n    to: flattenToAppURL(url),\n    target: (openLinkInNewTab !== null && openLinkInNewTab !== void 0 ? openLinkInNewTab : false) ? '_blank' : null,\n    title: title,\n    className: className\n  }, props, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 5\n    }\n  }), children);\n  if (isExternal) {\n    tag = __jsx(\"a\", _extends({\n      href: url,\n      title: title,\n      target: !checkedURL.isMail && !checkedURL.isTelephone && !(openLinkInNewTab === false) ? '_blank' : null,\n      rel: \"noopener noreferrer\",\n      className: className\n    }, props, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 7\n      }\n    }), children);\n  } else if (isDownload) {\n    tag = __jsx(\"a\", _extends({\n      href: flattenToAppURL(url),\n      download: true,\n      title: title,\n      className: className\n    }, props, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 7\n      }\n    }), children);\n  } else if (isDisplayFile) {\n    tag = __jsx(\"a\", _extends({\n      href: flattenToAppURL(url),\n      title: title,\n      target: \"_blank\",\n      rel: \"noopener noreferrer\",\n      className: className\n    }, props, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 7\n      }\n    }), children);\n  }\n  return tag;\n};\nUniversalLink.propTypes = {\n  href: PropTypes.string,\n  openLinkInNewTab: PropTypes.bool,\n  download: PropTypes.bool,\n  className: PropTypes.string,\n  title: PropTypes.string,\n  item: PropTypes.shape({\n    '@id': PropTypes.string.isRequired,\n    remoteUrl: PropTypes.string //of plone @type 'Link'\n  }),\n\n  children: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.node), PropTypes.node])\n};\nexport default UniversalLink;","map":{"version":3,"names":["React","PropTypes","Link","useSelector","flattenToAppURL","isInternalURL","URLUtils","matchPath","config","UniversalLink","href","item","openLinkInNewTab","download","children","className","title","props","token","state","userSession","url","console","error","remoteUrl","getRemoteUrl","settings","downloadableObjects","includes","viewableInBrowserObjects","isBlacklisted","externalRoutes","find","route","match","length","isExternal","isDownload","isDisplayFile","checkedURL","checkAndNormalizeUrl","tag","isMail","isTelephone","propTypes","string","bool","shape","isRequired","oneOfType","arrayOf","node"],"sources":["/home/tooler/code/work/forests-frontend/node_modules/@plone/volto/src/components/manage/UniversalLink/UniversalLink.jsx"],"sourcesContent":["/*\n * UniversalLink\n * @module components/UniversalLink\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from 'react-router-dom';\nimport { useSelector } from 'react-redux';\nimport {\n  flattenToAppURL,\n  isInternalURL,\n  URLUtils,\n} from '@plone/volto/helpers/Url/Url';\nimport { matchPath } from 'react-router';\n\nimport config from '@plone/volto/registry';\n\nconst UniversalLink = ({\n  href,\n  item = null,\n  openLinkInNewTab,\n  download = false,\n  children,\n  className = null,\n  title = null,\n  ...props\n}) => {\n  const token = useSelector((state) => state.userSession?.token);\n\n  let url = href;\n  if (!href && item) {\n    if (!item['@id']) {\n      // eslint-disable-next-line no-console\n      console.error(\n        'Invalid item passed to UniversalLink',\n        item,\n        props,\n        children,\n      );\n      url = '#';\n    } else {\n      //case: generic item\n      url = flattenToAppURL(item['@id']);\n\n      //case: item like a Link\n      let remoteUrl = item.remoteUrl || item.getRemoteUrl;\n      if (!token && remoteUrl) {\n        url = remoteUrl;\n      }\n\n      //case: item of type 'File'\n      if (\n        !token &&\n        config.settings.downloadableObjects.includes(item['@type'])\n      ) {\n        url = `${url}/@@download/file`;\n      }\n\n      if (\n        !token &&\n        config.settings.viewableInBrowserObjects.includes(item['@type'])\n      ) {\n        url = `${url}/@@display-file/file`;\n      }\n    }\n  }\n\n  const isBlacklisted =\n    (config.settings.externalRoutes ?? []).find((route) =>\n      matchPath(flattenToAppURL(url), route.match),\n    )?.length > 0;\n  const isExternal = !isInternalURL(url) || isBlacklisted;\n  const isDownload = (!isExternal && url.includes('@@download')) || download;\n  const isDisplayFile =\n    (!isExternal && url.includes('@@display-file')) || false;\n\n  const checkedURL = URLUtils.checkAndNormalizeUrl(url);\n\n  url = checkedURL.url;\n\n  let tag = (\n    <Link\n      to={flattenToAppURL(url)}\n      target={openLinkInNewTab ?? false ? '_blank' : null}\n      title={title}\n      className={className}\n      {...props}\n    >\n      {children}\n    </Link>\n  );\n\n  if (isExternal) {\n    tag = (\n      <a\n        href={url}\n        title={title}\n        target={\n          !checkedURL.isMail &&\n          !checkedURL.isTelephone &&\n          !(openLinkInNewTab === false)\n            ? '_blank'\n            : null\n        }\n        rel=\"noopener noreferrer\"\n        className={className}\n        {...props}\n      >\n        {children}\n      </a>\n    );\n  } else if (isDownload) {\n    tag = (\n      <a\n        href={flattenToAppURL(url)}\n        download\n        title={title}\n        className={className}\n        {...props}\n      >\n        {children}\n      </a>\n    );\n  } else if (isDisplayFile) {\n    tag = (\n      <a\n        href={flattenToAppURL(url)}\n        title={title}\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n        className={className}\n        {...props}\n      >\n        {children}\n      </a>\n    );\n  }\n  return tag;\n};\n\nUniversalLink.propTypes = {\n  href: PropTypes.string,\n  openLinkInNewTab: PropTypes.bool,\n  download: PropTypes.bool,\n  className: PropTypes.string,\n  title: PropTypes.string,\n  item: PropTypes.shape({\n    '@id': PropTypes.string.isRequired,\n    remoteUrl: PropTypes.string, //of plone @type 'Link'\n  }),\n  children: PropTypes.oneOfType([\n    PropTypes.arrayOf(PropTypes.node),\n    PropTypes.node,\n  ]),\n};\n\nexport default UniversalLink;\n"],"mappings":"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"},"metadata":{"react-intl":{"messages":[]}},"sourceType":"module","externalDependencies":[]}