{"ast":null,"code":"var _jsxFileName = \"/home/tooler/code/work/forests-frontend/src/develop/volto-datablocks/src/Utils/FormattedValue.jsx\",\n  _this2 = this,\n  _s = $RefreshSig$();\nvar __jsx = React.createElement;\nimport React, { useRef } from 'react';\nimport loadable from '@loadable/component';\nimport cx from 'classnames';\nimport sanitizeHtml from 'sanitize-html';\nimport CountUp from 'react-countup';\nimport { useOnScreen } from '../helpers';\nvar D3 = loadable.lib({\n  resolved: {},\n  chunkName: function chunkName() {\n    return \"d3\";\n  },\n  isReady: function isReady(props) {\n    var key = this.resolve(props);\n    if (this.resolved[key] !== true) {\n      return false;\n    }\n    if (typeof __webpack_modules__ !== 'undefined') {\n      return !!__webpack_modules__[key];\n    }\n    return false;\n  },\n  importAsync: function importAsync() {\n    return import( /* webpackChunkName: \"d3\" */'d3');\n  },\n  requireAsync: function requireAsync(props) {\n    var _this = this;\n    var key = this.resolve(props);\n    this.resolved[key] = false;\n    return this.importAsync(props).then(function (resolved) {\n      _this.resolved[key] = true;\n      return resolved;\n    });\n  },\n  requireSync: function requireSync(props) {\n    var id = this.resolve(props);\n    if (typeof __webpack_require__ !== 'undefined') {\n      return __webpack_require__(id);\n    }\n    return eval('module.require')(id);\n  },\n  resolve: function resolve() {\n    if (require.resolveWeak) {\n      return require.resolveWeak(\"d3\");\n    }\n    return eval('require.resolve')(\"d3\");\n  }\n});\n_c = D3;\nvar AnimatedCounter = function AnimatedCounter(_ref) {\n  _s();\n  var originalValue = _ref.originalValue;\n  var ref = useRef();\n  var _useOnScreen = useOnScreen(ref),\n    entryCount = _useOnScreen.entryCount,\n    isIntersecting = _useOnScreen.isIntersecting;\n  return __jsx(\"span\", {\n    ref: ref,\n    __self: _this2,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 16,\n      columnNumber: 5\n    }\n  }, isIntersecting && entryCount === 1 && __jsx(CountUp, {\n    start: 0,\n    formattingFn: function formattingFn(num) {\n      return num.toLocaleString();\n    },\n    duration: 3,\n    end: originalValue,\n    __self: _this2,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 18,\n      columnNumber: 9\n    }\n  }), isIntersecting && entryCount > 1 && __jsx(\"span\", {\n    __self: _this2,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 26,\n      columnNumber: 9\n    }\n  }, originalValue.toLocaleString(undefined, {\n    maximumFractionDigits: 0\n  })));\n};\n_s(AnimatedCounter, \"ZPfBkqw2tnT5zPJmmRXlKXZcRAY=\", false, function () {\n  return [useOnScreen];\n});\n_c2 = AnimatedCounter;\nvar FormattedValue = function FormattedValue(_ref2) {\n  var textTemplate = _ref2.textTemplate,\n    specifier = _ref2.specifier,\n    value = _ref2.value,\n    collapsed = _ref2.collapsed,\n    _ref2$wrapped = _ref2.wrapped,\n    wrapped = _ref2$wrapped === void 0 ? true : _ref2$wrapped,\n    animatedCounter = _ref2.animatedCounter;\n  var originalValue = value;\n  var animateValue = typeof value === 'number' && animatedCounter;\n  return __jsx(React.Fragment, {\n    __self: _this2,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 5\n    }\n  }, __jsx(D3, {\n    fallback: null,\n    __self: _this2,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 7\n    }\n  }, function (_ref3) {\n    var format = _ref3.format;\n    if (specifier) {\n      try {\n        var formatter = format ? format(specifier) : function (v) {\n          return v;\n        };\n        value = formatter(value);\n      } catch (_unused) {}\n    }\n    if (textTemplate && !animateValue) {\n      value = textTemplate.replace('{}', value);\n    }\n    return wrapped ? __jsx(React.Fragment, null, animateValue ? __jsx(\"span\", {\n      className: cx('formatted-value', collapsed ? 'collapsed' : null),\n      __self: _this2,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 17\n      }\n    }, textTemplate && textTemplate.split('{}').length > 0 ? textTemplate.split('{}')[0] : '', __jsx(AnimatedCounter, {\n      originalValue: originalValue,\n      __self: _this2,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 19\n      }\n    }), textTemplate && textTemplate.split('{}').length > 0 ? textTemplate.split('{}')[1] : '') : __jsx(\"span\", {\n      className: cx('formatted-value', collapsed ? 'collapsed' : null),\n      dangerouslySetInnerHTML: {\n        __html: sanitizeHtml(value, {\n          allowedAttributes: {\n            span: ['id']\n          }\n        }) || ''\n      },\n      __self: _this2,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 17\n      }\n    })) : sanitizeHtml(value, {\n      allowedAttributes: {\n        span: ['id']\n      }\n    }) || '';\n  }));\n};\n_c3 = FormattedValue;\nexport default FormattedValue;\nvar _c, _c2, _c3;\n$RefreshReg$(_c, \"D3\");\n$RefreshReg$(_c2, \"AnimatedCounter\");\n$RefreshReg$(_c3, \"FormattedValue\");","map":{"version":3,"names":["React","useRef","loadable","cx","sanitizeHtml","CountUp","useOnScreen","D3","lib","AnimatedCounter","originalValue","ref","entryCount","isIntersecting","num","toLocaleString","undefined","maximumFractionDigits","FormattedValue","textTemplate","specifier","value","collapsed","wrapped","animatedCounter","animateValue","format","formatter","v","replace","split","length","__html","allowedAttributes","span"],"sources":["/home/tooler/code/work/forests-frontend/src/develop/volto-datablocks/src/Utils/FormattedValue.jsx"],"sourcesContent":["import React, { useRef } from 'react';\nimport loadable from '@loadable/component';\nimport cx from 'classnames';\nimport sanitizeHtml from 'sanitize-html';\nimport CountUp from 'react-countup';\n\nimport { useOnScreen } from '../helpers';\n\nconst D3 = loadable.lib(() => import('d3'));\n\nconst AnimatedCounter = ({ originalValue }) => {\n  const ref = useRef();\n  const { entryCount, isIntersecting } = useOnScreen(ref);\n\n  return (\n    <span ref={ref}>\n      {isIntersecting && entryCount === 1 && (\n        <CountUp\n          start={0}\n          formattingFn={(num) => num.toLocaleString()}\n          duration={3}\n          end={originalValue}\n        />\n      )}\n      {isIntersecting && entryCount > 1 && (\n        <span>\n          {originalValue.toLocaleString(undefined, {\n            maximumFractionDigits: 0,\n          })}\n        </span>\n      )}\n    </span>\n  );\n};\n\nconst FormattedValue = ({\n  textTemplate,\n  specifier,\n  value,\n  collapsed,\n  wrapped = true,\n  animatedCounter,\n}) => {\n  const originalValue = value;\n  const animateValue = typeof value === 'number' && animatedCounter;\n  return (\n    <React.Fragment>\n      <D3 fallback={null}>\n        {({ format }) => {\n          if (specifier) {\n            try {\n              const formatter = format ? format(specifier) : (v) => v;\n              value = formatter(value);\n            } catch {}\n          }\n          if (textTemplate && !animateValue) {\n            value = textTemplate.replace('{}', value);\n          }\n\n          return wrapped ? (\n            <>\n              {animateValue ? (\n                <span\n                  className={cx(\n                    'formatted-value',\n                    collapsed ? 'collapsed' : null,\n                  )}\n                >\n                  {textTemplate && textTemplate.split('{}').length > 0\n                    ? textTemplate.split('{}')[0]\n                    : ''}\n                  <AnimatedCounter originalValue={originalValue} />\n                  {textTemplate && textTemplate.split('{}').length > 0\n                    ? textTemplate.split('{}')[1]\n                    : ''}\n                </span>\n              ) : (\n                <span\n                  className={cx(\n                    'formatted-value',\n                    collapsed ? 'collapsed' : null,\n                  )}\n                  dangerouslySetInnerHTML={{\n                    __html:\n                      sanitizeHtml(value, {\n                        allowedAttributes: {\n                          span: ['id'],\n                        },\n                      }) || '',\n                  }}\n                />\n              )}\n            </>\n          ) : (\n            sanitizeHtml(value, {\n              allowedAttributes: {\n                span: ['id'],\n              },\n            }) || ''\n          );\n        }}\n      </D3>\n    </React.Fragment>\n  );\n};\n\nexport default FormattedValue;\n"],"mappings":"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"},"metadata":{"react-intl":{"messages":[]}},"sourceType":"module","externalDependencies":[]}