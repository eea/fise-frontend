{"ast":null,"code":"import _isEmpty from \"lodash/isEmpty\";\nvar _jsxFileName = \"/home/tooler/code/work/forests-frontend/src/develop/volto-block-style/src/hocs/withCachedImages.jsx\";\nvar __jsx = React.createElement;\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nimport React from 'react';\nexport default function withCachedImages(WrappedComponent, config = {}) {\n  return props => {\n    var _config$getImage;\n    const mounted = React.useRef(false);\n    const [images, setImages] = React.useState({});\n    const image = _isEmpty((_config$getImage = config.getImage) === null || _config$getImage === void 0 ? void 0 : _config$getImage.call(config, props)) ? null : config.getImage(props);\n    React.useEffect(() => {\n      if (!mounted.current) mounted.current = true;\n      if (image && !images[image]) {\n        const newImage = new Image();\n        newImage.src = `${image}/@@images/image`;\n        setImages(_objectSpread(_objectSpread({}, images), {}, {\n          [image]: null\n        }));\n        newImage.onload = () => {\n          if (mounted.current) {\n            setImages(_objectSpread(_objectSpread({}, images), {}, {\n              [image]: newImage\n            }));\n          }\n        };\n      }\n      return () => {\n        mounted.current = false;\n      };\n      /* eslint-disable-next-line */\n    }, [image]);\n    return __jsx(WrappedComponent, _extends({}, props, {\n      images: images,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 30,\n        columnNumber: 12\n      }\n    }));\n  };\n}","map":{"version":3,"names":["React","withCachedImages","WrappedComponent","config","props","mounted","useRef","images","setImages","useState","image","getImage","useEffect","current","newImage","Image","src","onload"],"sources":["/home/tooler/code/work/forests-frontend/src/develop/volto-block-style/src/hocs/withCachedImages.jsx"],"sourcesContent":["import React from 'react';\nimport { isEmpty } from 'lodash';\n\nexport default function withCachedImages(WrappedComponent, config = {}) {\n  return (props) => {\n    const mounted = React.useRef(false);\n    const [images, setImages] = React.useState({});\n    const image = isEmpty(config.getImage?.(props))\n      ? null\n      : config.getImage(props);\n\n    React.useEffect(() => {\n      if (!mounted.current) mounted.current = true;\n      if (image && !images[image]) {\n        const newImage = new Image();\n        newImage.src = `${image}/@@images/image`;\n        setImages({ ...images, [image]: null });\n        newImage.onload = () => {\n          if (mounted.current) {\n            setImages({ ...images, [image]: newImage });\n          }\n        };\n      }\n      return () => {\n        mounted.current = false;\n      };\n      /* eslint-disable-next-line */\n    }, [image]);\n\n    return <WrappedComponent {...props} images={images} />;\n  };\n}\n"],"mappings":";;;;;;;AAAA,OAAOA,KAAK,MAAM,OAAO;AAGzB,eAAe,SAASC,gBAAgB,CAACC,gBAAgB,EAAEC,MAAM,GAAG,CAAC,CAAC,EAAE;EACtE,OAAQC,KAAK,IAAK;IAAA;IAChB,MAAMC,OAAO,GAAGL,KAAK,CAACM,MAAM,CAAC,KAAK,CAAC;IACnC,MAAM,CAACC,MAAM,EAAEC,SAAS,CAAC,GAAGR,KAAK,CAACS,QAAQ,CAAC,CAAC,CAAC,CAAC;IAC9C,MAAMC,KAAK,GAAG,6BAAQP,MAAM,CAACQ,QAAQ,qDAAf,sBAAAR,MAAM,EAAYC,KAAK,CAAC,CAAC,GAC3C,IAAI,GACJD,MAAM,CAACQ,QAAQ,CAACP,KAAK,CAAC;IAE1BJ,KAAK,CAACY,SAAS,CAAC,MAAM;MACpB,IAAI,CAACP,OAAO,CAACQ,OAAO,EAAER,OAAO,CAACQ,OAAO,GAAG,IAAI;MAC5C,IAAIH,KAAK,IAAI,CAACH,MAAM,CAACG,KAAK,CAAC,EAAE;QAC3B,MAAMI,QAAQ,GAAG,IAAIC,KAAK,EAAE;QAC5BD,QAAQ,CAACE,GAAG,GAAI,GAAEN,KAAM,iBAAgB;QACxCF,SAAS,iCAAMD,MAAM;UAAE,CAACG,KAAK,GAAG;QAAI,GAAG;QACvCI,QAAQ,CAACG,MAAM,GAAG,MAAM;UACtB,IAAIZ,OAAO,CAACQ,OAAO,EAAE;YACnBL,SAAS,iCAAMD,MAAM;cAAE,CAACG,KAAK,GAAGI;YAAQ,GAAG;UAC7C;QACF,CAAC;MACH;MACA,OAAO,MAAM;QACXT,OAAO,CAACQ,OAAO,GAAG,KAAK;MACzB,CAAC;MACD;IACF,CAAC,EAAE,CAACH,KAAK,CAAC,CAAC;IAEX,OAAO,MAAC,gBAAgB,eAAKN,KAAK;MAAE,MAAM,EAAEG,MAAO;MAAA;MAAA;QAAA;QAAA;QAAA;MAAA;IAAA,GAAG;EACxD,CAAC;AACH"},"metadata":{"react-intl":{"messages":[]}},"sourceType":"module","externalDependencies":[]}