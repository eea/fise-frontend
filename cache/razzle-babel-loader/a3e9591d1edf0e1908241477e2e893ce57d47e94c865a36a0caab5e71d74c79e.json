{"ast":null,"code":"var _jsxFileName = \"/home/tooler/code/work/forests-frontend/src/develop/volto-forests-theme/src/components/manage/Blocks/DiscodataConnectorBlock/v1/schema.js\";\nvar __jsx = React.createElement;\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nimport React from 'react';\nconst makeChoices = keys => keys && keys.map(k => [k, k]);\nconst getDataProvidersIds = (data_providers = [], child = {}) => {\n  const ids = data_providers.map(data_provider => data_provider.id).filter(id => id && id !== child.id);\n  return makeChoices(ids);\n};\nconst dataProviderSchemaExtender = (schema, child = {}, props) => {\n  var _props$providers_data;\n  const data_providers = props.data.data_providers || [];\n  return _objectSpread(_objectSpread({}, schema), {}, {\n    fieldsets: [_objectSpread({}, schema.fieldsets[0]), {\n      id: 'properties',\n      title: 'Properties',\n      fields: ['measurmentUnit', 'additionalText', 'className', 'animatedCounter']\n    }, ...(child.hasDiscodataConnector ? [{\n      id: 'Discodata connector',\n      title: 'Discodata connector',\n      fields: ['path', 'displayColumn', 'textTemplate', 'specifier', 'data_query']\n    }] : []), ...(child.hasParent ? [{\n      id: 'parent',\n      title: 'Parent',\n      fields: ['parent']\n    }] : [])],\n    properties: _objectSpread(_objectSpread({}, schema.properties), {}, {\n      displayColumn: _objectSpread(_objectSpread({}, schema.properties.displayColumn), {}, {\n        choices: makeChoices(Object.keys(((_props$providers_data = props.providers_data) === null || _props$providers_data === void 0 ? void 0 : _props$providers_data[child.title]) || {}))\n      }),\n      parent: _objectSpread(_objectSpread({}, schema.properties.parent), {}, {\n        choices: getDataProvidersIds(data_providers, child)\n      })\n    })\n  });\n};\nconst dataProviderSchema = {\n  title: 'Data provider',\n  fieldsets: [{\n    id: 'default',\n    title: 'Default',\n    fields: ['title', 'id', 'hasDiscodataConnector', 'hasParent', 'wrapperClassName']\n  }, {\n    id: 'advanced',\n    title: 'Advanced',\n    fields: ['path', 'displayColumn', 'textTemplate', 'specifier', 'measurmentUnit', 'additionalText', 'className', 'parent', 'wrapperClassName', 'animatedCounter']\n  }],\n  properties: {\n    title: {\n      type: 'text',\n      title: 'Title'\n    },\n    id: {\n      type: 'text',\n      title: 'Id'\n    },\n    hasDiscodataConnector: {\n      type: 'boolean',\n      title: 'Has discodata connector'\n    },\n    hasParent: {\n      type: 'boolean',\n      title: 'Has parent'\n    },\n    path: {\n      widget: 'object_by_path',\n      title: 'Discodata connector'\n    },\n    displayColumn: {\n      type: 'select',\n      title: 'Display column',\n      choices: []\n    },\n    textTemplate: {\n      title: 'Text template',\n      widget: 'textarea',\n      description: 'Add suffix/prefix to text. Use {} for value placeholder'\n    },\n    specifier: {\n      title: 'Format',\n      description: __jsx(React.Fragment, null, \"See\", ' ', __jsx(\"a\", {\n        target: \"_blank\",\n        rel: \"noopener noreferrer\",\n        href: \"https://github.com/d3/d3-format\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 11\n        }\n      }, \"D3 format documentation\"))\n    },\n    measurmentUnit: {\n      type: 'text',\n      title: 'Measurment unit'\n    },\n    additionalText: {\n      type: 'text',\n      title: 'Additional text'\n    },\n    animatedCounter: {\n      type: 'boolean',\n      title: 'Animated Counter',\n      description: 'Apply counter animation to a number'\n    },\n    className: {\n      type: 'select',\n      title: 'Class name',\n      choices: [['data', 'Data'], ['data-content', 'Data content']]\n    },\n    parent: {\n      type: 'select',\n      title: 'Parent',\n      choices: []\n    },\n    wrapperClassName: {\n      type: 'select',\n      title: 'Wrapper class name',\n      choices: [['data-wrapper brown', 'Brown wrapper'], ['data-wrapper green', 'Green wrapper'], ['data-wrapper blue', 'Blue wrapper'], ['data-wrapper purple', 'Purple wrapper']]\n    },\n    data_query: {\n      title: 'Data query',\n      widget: 'data_query'\n    }\n  },\n  required: ['title', 'id']\n};\nconst SourceSchema = {\n  title: 'Source',\n  fieldsets: [{\n    id: 'default',\n    title: 'Default',\n    fields: ['chart_source', 'chart_source_link']\n  }],\n  properties: {\n    chart_source: {\n      type: 'string',\n      title: 'Source'\n    },\n    chart_source_link: {\n      type: 'string',\n      title: 'Link'\n    }\n  },\n  required: ['source']\n};\nexport const getSchema = props => ({\n  title: 'Discodata connector block',\n  fieldsets: [{\n    id: 'default',\n    title: 'Default',\n    fields: ['block_title']\n  }, {\n    id: 'advanced',\n    title: 'Advanced',\n    fields: ['data_providers']\n  }, {\n    id: 'sources',\n    title: 'Sources',\n    fields: ['chartSources', 'download_button']\n  }],\n  properties: {\n    block_title: {\n      title: 'Title',\n      widget: 'textarea'\n    },\n    download_button: {\n      title: 'Download button',\n      type: 'boolean',\n      defaultValue: true\n    },\n    chartSources: {\n      widget: 'object_list',\n      title: 'Sources',\n      schema: SourceSchema\n    },\n    data_providers: {\n      title: 'Data providers',\n      widget: 'object_list',\n      schema: dataProviderSchema,\n      schemaExtender: (schema, child) => dataProviderSchemaExtender(schema, child, props),\n      defaultData: {\n        hasDiscodataConnector: true,\n        hasParent: false\n      }\n    }\n  },\n  required: []\n});","map":{"version":3,"names":["React","makeChoices","keys","map","k","getDataProvidersIds","data_providers","child","ids","data_provider","id","filter","dataProviderSchemaExtender","schema","props","data","fieldsets","title","fields","hasDiscodataConnector","hasParent","properties","displayColumn","choices","Object","providers_data","parent","dataProviderSchema","type","path","widget","textTemplate","description","specifier","measurmentUnit","additionalText","animatedCounter","className","wrapperClassName","data_query","required","SourceSchema","chart_source","chart_source_link","getSchema","block_title","download_button","defaultValue","chartSources","schemaExtender","defaultData"],"sources":["/home/tooler/code/work/forests-frontend/src/develop/volto-forests-theme/src/components/manage/Blocks/DiscodataConnectorBlock/v1/schema.js"],"sourcesContent":["import React from 'react';\n\nconst makeChoices = (keys) => keys && keys.map((k) => [k, k]);\n\nconst getDataProvidersIds = (data_providers = [], child = {}) => {\n  const ids = data_providers\n    .map((data_provider) => data_provider.id)\n    .filter((id) => id && id !== child.id);\n  return makeChoices(ids);\n};\n\nconst dataProviderSchemaExtender = (schema, child = {}, props) => {\n  const data_providers = props.data.data_providers || [];\n  return {\n    ...schema,\n    fieldsets: [\n      {\n        ...schema.fieldsets[0],\n      },\n      {\n        id: 'properties',\n        title: 'Properties',\n        fields: [\n          'measurmentUnit',\n          'additionalText',\n          'className',\n          'animatedCounter',\n        ],\n      },\n      ...(child.hasDiscodataConnector\n        ? [\n            {\n              id: 'Discodata connector',\n              title: 'Discodata connector',\n              fields: [\n                'path',\n                'displayColumn',\n                'textTemplate',\n                'specifier',\n                'data_query',\n              ],\n            },\n          ]\n        : []),\n      ...(child.hasParent\n        ? [\n            {\n              id: 'parent',\n              title: 'Parent',\n              fields: ['parent'],\n            },\n          ]\n        : []),\n    ],\n    properties: {\n      ...schema.properties,\n      displayColumn: {\n        ...schema.properties.displayColumn,\n        choices: makeChoices(\n          Object.keys(props.providers_data?.[child.title] || {}),\n        ),\n      },\n      parent: {\n        ...schema.properties.parent,\n        choices: getDataProvidersIds(data_providers, child),\n      },\n    },\n  };\n};\n\nconst dataProviderSchema = {\n  title: 'Data provider',\n  fieldsets: [\n    {\n      id: 'default',\n      title: 'Default',\n      fields: [\n        'title',\n        'id',\n        'hasDiscodataConnector',\n        'hasParent',\n        'wrapperClassName',\n      ],\n    },\n    {\n      id: 'advanced',\n      title: 'Advanced',\n      fields: [\n        'path',\n        'displayColumn',\n        'textTemplate',\n        'specifier',\n        'measurmentUnit',\n        'additionalText',\n        'className',\n        'parent',\n        'wrapperClassName',\n        'animatedCounter',\n      ],\n    },\n  ],\n  properties: {\n    title: {\n      type: 'text',\n      title: 'Title',\n    },\n    id: {\n      type: 'text',\n      title: 'Id',\n    },\n    hasDiscodataConnector: {\n      type: 'boolean',\n      title: 'Has discodata connector',\n    },\n    hasParent: {\n      type: 'boolean',\n      title: 'Has parent',\n    },\n    path: {\n      widget: 'object_by_path',\n      title: 'Discodata connector',\n    },\n    displayColumn: {\n      type: 'select',\n      title: 'Display column',\n      choices: [],\n    },\n    textTemplate: {\n      title: 'Text template',\n      widget: 'textarea',\n      description: 'Add suffix/prefix to text. Use {} for value placeholder',\n    },\n    specifier: {\n      title: 'Format',\n      description: (\n        <>\n          See{' '}\n          <a\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            href=\"https://github.com/d3/d3-format\"\n          >\n            D3 format documentation\n          </a>\n        </>\n      ),\n    },\n    measurmentUnit: {\n      type: 'text',\n      title: 'Measurment unit',\n    },\n    additionalText: {\n      type: 'text',\n      title: 'Additional text',\n    },\n    animatedCounter: {\n      type: 'boolean',\n      title: 'Animated Counter',\n      description: 'Apply counter animation to a number',\n    },\n\n    className: {\n      type: 'select',\n      title: 'Class name',\n      choices: [\n        ['data', 'Data'],\n        ['data-content', 'Data content'],\n      ],\n    },\n    parent: {\n      type: 'select',\n      title: 'Parent',\n      choices: [],\n    },\n    wrapperClassName: {\n      type: 'select',\n      title: 'Wrapper class name',\n      choices: [\n        ['data-wrapper brown', 'Brown wrapper'],\n        ['data-wrapper green', 'Green wrapper'],\n        ['data-wrapper blue', 'Blue wrapper'],\n        ['data-wrapper purple', 'Purple wrapper'],\n      ],\n    },\n    data_query: {\n      title: 'Data query',\n      widget: 'data_query',\n    },\n  },\n  required: ['title', 'id'],\n};\n\nconst SourceSchema = {\n  title: 'Source',\n\n  fieldsets: [\n    {\n      id: 'default',\n      title: 'Default',\n      fields: ['chart_source', 'chart_source_link'],\n    },\n  ],\n\n  properties: {\n    chart_source: {\n      type: 'string',\n      title: 'Source',\n    },\n    chart_source_link: {\n      type: 'string',\n      title: 'Link',\n    },\n  },\n\n  required: ['source'],\n};\n\nexport const getSchema = (props) => ({\n  title: 'Discodata connector block',\n  fieldsets: [\n    {\n      id: 'default',\n      title: 'Default',\n      fields: ['block_title'],\n    },\n    {\n      id: 'advanced',\n      title: 'Advanced',\n      fields: ['data_providers'],\n    },\n    {\n      id: 'sources',\n      title: 'Sources',\n      fields: ['chartSources', 'download_button'],\n    },\n  ],\n  properties: {\n    block_title: {\n      title: 'Title',\n      widget: 'textarea',\n    },\n    download_button: {\n      title: 'Download button',\n      type: 'boolean',\n      defaultValue: true,\n    },\n    chartSources: {\n      widget: 'object_list',\n      title: 'Sources',\n      schema: SourceSchema,\n    },\n    data_providers: {\n      title: 'Data providers',\n      widget: 'object_list',\n      schema: dataProviderSchema,\n      schemaExtender: (schema, child) =>\n        dataProviderSchemaExtender(schema, child, props),\n      defaultData: {\n        hasDiscodataConnector: true,\n        hasParent: false,\n      },\n    },\n  },\n  required: [],\n});\n"],"mappings":"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"},"metadata":{"react-intl":{"messages":[]}},"sourceType":"module","externalDependencies":[]}