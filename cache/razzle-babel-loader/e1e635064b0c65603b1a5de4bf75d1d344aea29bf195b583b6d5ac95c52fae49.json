{"ast":null,"code":"import _slicedToArray from \"/home/tooler/code/work/forests-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nvar _jsxFileName = \"/home/tooler/code/work/forests-frontend/src/develop/volto-slate/src/editor/ui/InlineToolbar.jsx\",\n  _this = this,\n  _s = $RefreshSig$();\nvar __jsx = React.createElement;\nimport React from 'react'; // , useState\nimport SlateToolbar from './SlateToolbar';\nimport SlateContextToolbar from './SlateContextToolbar';\nimport config from '@plone/volto/registry';\nimport { hasRangeSelection } from 'volto-slate/utils';\nimport { ReactEditor } from 'slate-react';\nimport cx from 'classnames';\n\n/**\n * The main Slate toolbar. All the others are just wrappers, UI or used here\n */\nvar InlineToolbar = function InlineToolbar(props) {\n  _s();\n  var editor = props.editor,\n    className = props.className,\n    showExpandedToolbar = props.showExpandedToolbar,\n    setShowExpandedToolbar = props.setShowExpandedToolbar;\n  var slate = config.settings.slate;\n  var _React$useState = React.useState(!!(editor.selection && hasRangeSelection(editor))),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    showMainToolbar = _React$useState2[0],\n    setShowMainToolbar = _React$useState2[1];\n  React.useEffect(function () {\n    var el;\n    try {\n      el = ReactEditor.toDOMNode(editor, editor);\n    } catch (_unused) {\n      return;\n    }\n    var toggleToolbar = function toggleToolbar() {\n      var selection = window.getSelection();\n      var activeElement = window.document.activeElement;\n      if (activeElement !== el) return;\n      if (!selection.isCollapsed && !showMainToolbar) {\n        setShowMainToolbar(true);\n      } else if (selection.isCollapsed && showMainToolbar) {\n        setShowMainToolbar(false);\n      }\n    };\n    window.document.addEventListener('selectionchange', toggleToolbar);\n    return function () {\n      return document.removeEventListener('selectionchange', toggleToolbar);\n    };\n  }, [editor, showMainToolbar]);\n  var showContextToolbar = slate.contextToolbarButtons.map(function (plug) {\n    return plug(editor);\n  }).filter(function (c) {\n    return !!c;\n  }).length > 0;\n  return __jsx(React.Fragment, null, __jsx(SlateToolbar, {\n    className: cx(className, {\n      upper: showContextToolbar\n    }),\n    selected: true,\n    enableExpando: slate.enableExpandedToolbar,\n    showExpandedToolbar: showExpandedToolbar,\n    setShowExpandedToolbar: setShowExpandedToolbar,\n    show: showMainToolbar,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 7\n    }\n  }), __jsx(SlateContextToolbar, {\n    editor: editor,\n    plugins: slate.contextToolbarButtons,\n    show: showContextToolbar,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 7\n    }\n  }));\n};\n_s(InlineToolbar, \"fHocp6RQevJwAAYtrZzbVuwZFVU=\");\n_c = InlineToolbar;\nexport default InlineToolbar;\nvar _c;\n$RefreshReg$(_c, \"InlineToolbar\");","map":{"version":3,"names":["React","SlateToolbar","SlateContextToolbar","config","hasRangeSelection","ReactEditor","cx","InlineToolbar","props","editor","className","showExpandedToolbar","setShowExpandedToolbar","slate","settings","useState","selection","showMainToolbar","setShowMainToolbar","useEffect","el","toDOMNode","toggleToolbar","window","getSelection","activeElement","document","isCollapsed","addEventListener","removeEventListener","showContextToolbar","contextToolbarButtons","map","plug","filter","c","length","upper","enableExpandedToolbar"],"sources":["/home/tooler/code/work/forests-frontend/src/develop/volto-slate/src/editor/ui/InlineToolbar.jsx"],"sourcesContent":["import React from 'react'; // , useState\nimport SlateToolbar from './SlateToolbar';\nimport SlateContextToolbar from './SlateContextToolbar';\nimport config from '@plone/volto/registry';\nimport { hasRangeSelection } from 'volto-slate/utils';\nimport { ReactEditor } from 'slate-react';\nimport cx from 'classnames';\n\n/**\n * The main Slate toolbar. All the others are just wrappers, UI or used here\n */\nconst InlineToolbar = (props) => {\n  const {\n    editor,\n    className,\n    showExpandedToolbar,\n    setShowExpandedToolbar,\n  } = props;\n\n  const { slate } = config.settings;\n  const [showMainToolbar, setShowMainToolbar] = React.useState(\n    !!(editor.selection && hasRangeSelection(editor)),\n  );\n\n  React.useEffect(() => {\n    let el;\n    try {\n      el = ReactEditor.toDOMNode(editor, editor);\n    } catch {\n      return;\n    }\n    const toggleToolbar = () => {\n      const selection = window.getSelection();\n      const { activeElement } = window.document;\n      if (activeElement !== el) return;\n      if (!selection.isCollapsed && !showMainToolbar) {\n        setShowMainToolbar(true);\n      } else if (selection.isCollapsed && showMainToolbar) {\n        setShowMainToolbar(false);\n      }\n    };\n    window.document.addEventListener('selectionchange', toggleToolbar);\n    return () => document.removeEventListener('selectionchange', toggleToolbar);\n  }, [editor, showMainToolbar]);\n\n  const showContextToolbar =\n    slate.contextToolbarButtons.map((plug) => plug(editor)).filter((c) => !!c)\n      .length > 0;\n\n  return (\n    <>\n      <SlateToolbar\n        className={cx(className, {\n          upper: showContextToolbar,\n        })}\n        selected={true}\n        enableExpando={slate.enableExpandedToolbar}\n        showExpandedToolbar={showExpandedToolbar}\n        setShowExpandedToolbar={setShowExpandedToolbar}\n        show={showMainToolbar}\n      />\n      <SlateContextToolbar\n        editor={editor}\n        plugins={slate.contextToolbarButtons}\n        show={showContextToolbar}\n      />\n    </>\n  );\n};\n\nexport default InlineToolbar;\n"],"mappings":";;;;;AAAA,OAAOA,KAAK,MAAM,OAAO,CAAC,CAAC;AAC3B,OAAOC,YAAY,MAAM,gBAAgB;AACzC,OAAOC,mBAAmB,MAAM,uBAAuB;AACvD,OAAOC,MAAM,MAAM,uBAAuB;AAC1C,SAASC,iBAAiB,QAAQ,mBAAmB;AACrD,SAASC,WAAW,QAAQ,aAAa;AACzC,OAAOC,EAAE,MAAM,YAAY;;AAE3B;AACA;AACA;AACA,IAAMC,aAAa,GAAG,SAAhBA,aAAa,CAAIC,KAAK,EAAK;EAAA;EAC/B,IACEC,MAAM,GAIJD,KAAK,CAJPC,MAAM;IACNC,SAAS,GAGPF,KAAK,CAHPE,SAAS;IACTC,mBAAmB,GAEjBH,KAAK,CAFPG,mBAAmB;IACnBC,sBAAsB,GACpBJ,KAAK,CADPI,sBAAsB;EAGxB,IAAQC,KAAK,GAAKV,MAAM,CAACW,QAAQ,CAAzBD,KAAK;EACb,sBAA8Cb,KAAK,CAACe,QAAQ,CAC1D,CAAC,EAAEN,MAAM,CAACO,SAAS,IAAIZ,iBAAiB,CAACK,MAAM,CAAC,CAAC,CAClD;IAAA;IAFMQ,eAAe;IAAEC,kBAAkB;EAI1ClB,KAAK,CAACmB,SAAS,CAAC,YAAM;IACpB,IAAIC,EAAE;IACN,IAAI;MACFA,EAAE,GAAGf,WAAW,CAACgB,SAAS,CAACZ,MAAM,EAAEA,MAAM,CAAC;IAC5C,CAAC,CAAC,gBAAM;MACN;IACF;IACA,IAAMa,aAAa,GAAG,SAAhBA,aAAa,GAAS;MAC1B,IAAMN,SAAS,GAAGO,MAAM,CAACC,YAAY,EAAE;MACvC,IAAQC,aAAa,GAAKF,MAAM,CAACG,QAAQ,CAAjCD,aAAa;MACrB,IAAIA,aAAa,KAAKL,EAAE,EAAE;MAC1B,IAAI,CAACJ,SAAS,CAACW,WAAW,IAAI,CAACV,eAAe,EAAE;QAC9CC,kBAAkB,CAAC,IAAI,CAAC;MAC1B,CAAC,MAAM,IAAIF,SAAS,CAACW,WAAW,IAAIV,eAAe,EAAE;QACnDC,kBAAkB,CAAC,KAAK,CAAC;MAC3B;IACF,CAAC;IACDK,MAAM,CAACG,QAAQ,CAACE,gBAAgB,CAAC,iBAAiB,EAAEN,aAAa,CAAC;IAClE,OAAO;MAAA,OAAMI,QAAQ,CAACG,mBAAmB,CAAC,iBAAiB,EAAEP,aAAa,CAAC;IAAA;EAC7E,CAAC,EAAE,CAACb,MAAM,EAAEQ,eAAe,CAAC,CAAC;EAE7B,IAAMa,kBAAkB,GACtBjB,KAAK,CAACkB,qBAAqB,CAACC,GAAG,CAAC,UAACC,IAAI;IAAA,OAAKA,IAAI,CAACxB,MAAM,CAAC;EAAA,EAAC,CAACyB,MAAM,CAAC,UAACC,CAAC;IAAA,OAAK,CAAC,CAACA,CAAC;EAAA,EAAC,CACvEC,MAAM,GAAG,CAAC;EAEf,OACE,4BACE,MAAC,YAAY;IACX,SAAS,EAAE9B,EAAE,CAACI,SAAS,EAAE;MACvB2B,KAAK,EAAEP;IACT,CAAC,CAAE;IACH,QAAQ,EAAE,IAAK;IACf,aAAa,EAAEjB,KAAK,CAACyB,qBAAsB;IAC3C,mBAAmB,EAAE3B,mBAAoB;IACzC,sBAAsB,EAAEC,sBAAuB;IAC/C,IAAI,EAAEK,eAAgB;IAAA;IAAA;MAAA;MAAA;MAAA;IAAA;EAAA,EACtB,EACF,MAAC,mBAAmB;IAClB,MAAM,EAAER,MAAO;IACf,OAAO,EAAEI,KAAK,CAACkB,qBAAsB;IACrC,IAAI,EAAED,kBAAmB;IAAA;IAAA;MAAA;MAAA;MAAA;IAAA;EAAA,EACzB,CACD;AAEP,CAAC;AAAC,GAzDIvB,aAAa;AAAA,KAAbA,aAAa;AA2DnB,eAAeA,aAAa;AAAC;AAAA"},"metadata":{"react-intl":{"messages":[]}},"sourceType":"module","externalDependencies":[]}