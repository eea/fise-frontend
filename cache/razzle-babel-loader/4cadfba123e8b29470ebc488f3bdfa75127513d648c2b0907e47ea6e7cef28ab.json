{"ast":null,"code":"var _jsxFileName = \"/home/tooler/code/work/forests-frontend/src/develop/volto-eea-map/src/components/visualization/VisualizationEditorWidget.jsx\";\nvar __jsx = React.createElement;\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nimport React from 'react';\nimport { Modal, Button, Grid } from 'semantic-ui-react';\nimport { FormFieldWrapper, InlineForm } from '@plone/volto/components';\nimport PanelsSchema from './panelsSchema';\nimport Webmap from '../Webmap';\nconst VisualizationEditorWidget = props => {\n  const [open, setOpen] = React.useState(false);\n  const {\n    onChange = {},\n    id\n  } = props;\n  const block = React.useMemo(() => props.block, [props.block]);\n  const value = React.useMemo(() => props.value, [props.value]);\n  const [intValue, setIntValue] = React.useState(value);\n  const dataForm = {\n    map_data: intValue\n  };\n  const handleApplyChanges = () => {\n    onChange(id, intValue);\n    setOpen(false);\n  };\n  const handleClose = () => {\n    setIntValue(value);\n    setOpen(false);\n  };\n  const handleChangeField = val => {\n    setIntValue(val);\n  };\n  let schema = PanelsSchema({\n    data: dataForm\n  });\n  React.useEffect(() => {\n    if (!(intValue !== null && intValue !== void 0 && intValue.general)) {\n      setIntValue(_objectSpread(_objectSpread({}, intValue), {}, {\n        general: {\n          print_position: 'top-right',\n          zoom_position: 'top-right',\n          centerOnExtent: true,\n          scalebar: 'metric'\n        }\n      }));\n    }\n    if (!(intValue !== null && intValue !== void 0 && intValue.base)) {\n      setIntValue(_objectSpread(_objectSpread({}, intValue), {}, {\n        base: {\n          base_layer: 'gray-vector'\n        }\n      }));\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [intValue]);\n  return __jsx(FormFieldWrapper, _extends({}, props, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 5\n    }\n  }), __jsx(\"div\", {\n    className: \"wrapper\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 7\n    }\n  }, __jsx(Button, {\n    floated: \"right\",\n    size: \"tiny\",\n    onClick: e => {\n      e.preventDefault();\n      e.stopPropagation();\n      setOpen(true);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 9\n    }\n  }, \"Open Map Editor\")), open && __jsx(Modal, {\n    id: \"map-editor-modal\",\n    style: {\n      width: '95% !important'\n    },\n    open: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 9\n    }\n  }, __jsx(Modal.Content, {\n    scrolling: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 11\n    }\n  }, __jsx(Grid, {\n    stackable: true,\n    reversed: \"mobile vertically tablet vertically\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 13\n    }\n  }, __jsx(Grid.Column, {\n    mobile: 12,\n    tablet: 12,\n    computer: 5,\n    className: \"map-editor-column\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 15\n    }\n  }, __jsx(InlineForm, {\n    block: block,\n    schema: schema,\n    onChangeField: (id, value) => {\n      handleChangeField(value);\n    },\n    formData: dataForm,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 17\n    }\n  })), __jsx(Grid.Column, {\n    mobile: 12,\n    tablet: 12,\n    computer: 7,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 15\n    }\n  }, __jsx(\"div\", {\n    className: \"webmap-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 17\n    }\n  }, __jsx(Webmap, {\n    data: intValue,\n    editMode: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 19\n    }\n  }))))), __jsx(Modal.Actions, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 11\n    }\n  }, __jsx(Grid, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 13\n    }\n  }, __jsx(Grid.Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 15\n    }\n  }, __jsx(\"div\", {\n    className: \"map-edit-actions-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 17\n    }\n  }, __jsx(Button, {\n    onClick: handleClose,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 19\n    }\n  }, \"Close\"), __jsx(Button, {\n    color: \"green\",\n    onClick: handleApplyChanges,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 19\n    }\n  }, \"Apply changes\")))))), __jsx(Webmap, {\n    data: value,\n    editMode: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 7\n    }\n  }));\n};\nexport default VisualizationEditorWidget;","map":{"version":3,"names":["React","Modal","Button","Grid","FormFieldWrapper","InlineForm","PanelsSchema","Webmap","VisualizationEditorWidget","props","open","setOpen","useState","onChange","id","block","useMemo","value","intValue","setIntValue","dataForm","map_data","handleApplyChanges","handleClose","handleChangeField","val","schema","data","useEffect","general","print_position","zoom_position","centerOnExtent","scalebar","base","base_layer","e","preventDefault","stopPropagation","width"],"sources":["/home/tooler/code/work/forests-frontend/src/develop/volto-eea-map/src/components/visualization/VisualizationEditorWidget.jsx"],"sourcesContent":["import React from 'react';\nimport { Modal, Button, Grid } from 'semantic-ui-react';\n\nimport { FormFieldWrapper, InlineForm } from '@plone/volto/components';\n\nimport PanelsSchema from './panelsSchema';\nimport Webmap from '../Webmap';\n\nconst VisualizationEditorWidget = (props) => {\n  const [open, setOpen] = React.useState(false);\n  const { onChange = {}, id } = props;\n  const block = React.useMemo(() => props.block, [props.block]);\n  const value = React.useMemo(() => props.value, [props.value]);\n\n  const [intValue, setIntValue] = React.useState(value);\n\n  const dataForm = { map_data: intValue };\n  const handleApplyChanges = () => {\n    onChange(id, intValue);\n    setOpen(false);\n  };\n\n  const handleClose = () => {\n    setIntValue(value);\n    setOpen(false);\n  };\n\n  const handleChangeField = (val) => {\n    setIntValue(val);\n  };\n\n  let schema = PanelsSchema({ data: dataForm });\n\n  React.useEffect(() => {\n    if (!intValue?.general) {\n      setIntValue({\n        ...intValue,\n        general: {\n          print_position: 'top-right',\n          zoom_position: 'top-right',\n          centerOnExtent: true,\n          scalebar: 'metric',\n        },\n      });\n    }\n    if (!intValue?.base) {\n      setIntValue({\n        ...intValue,\n        base: {\n          base_layer: 'gray-vector',\n        },\n      });\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [intValue]);\n\n  return (\n    <FormFieldWrapper {...props}>\n      <div className=\"wrapper\">\n        <Button\n          floated=\"right\"\n          size=\"tiny\"\n          onClick={(e) => {\n            e.preventDefault();\n            e.stopPropagation();\n            setOpen(true);\n          }}\n        >\n          Open Map Editor\n        </Button>\n      </div>\n\n      {open && (\n        <Modal\n          id=\"map-editor-modal\"\n          style={{ width: '95% !important' }}\n          open={true}\n        >\n          <Modal.Content scrolling>\n            <Grid stackable reversed=\"mobile vertically tablet vertically\">\n              <Grid.Column\n                mobile={12}\n                tablet={12}\n                computer={5}\n                className=\"map-editor-column\"\n              >\n                <InlineForm\n                  block={block}\n                  schema={schema}\n                  onChangeField={(id, value) => {\n                    handleChangeField(value);\n                  }}\n                  formData={dataForm}\n                />\n              </Grid.Column>\n              <Grid.Column mobile={12} tablet={12} computer={7}>\n                <div className=\"webmap-container\">\n                  <Webmap data={intValue} editMode={true} />\n                </div>\n              </Grid.Column>\n            </Grid>\n          </Modal.Content>\n          <Modal.Actions>\n            <Grid>\n              <Grid.Row>\n                <div className=\"map-edit-actions-container\">\n                  <Button onClick={handleClose}>Close</Button>\n                  <Button color=\"green\" onClick={handleApplyChanges}>\n                    Apply changes\n                  </Button>\n                </div>\n              </Grid.Row>\n            </Grid>\n          </Modal.Actions>\n        </Modal>\n      )}\n      <Webmap data={value} editMode={true} />\n    </FormFieldWrapper>\n  );\n};\n\nexport default VisualizationEditorWidget;\n"],"mappings":"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"},"metadata":{"react-intl":{"messages":[]}},"sourceType":"module","externalDependencies":[]}