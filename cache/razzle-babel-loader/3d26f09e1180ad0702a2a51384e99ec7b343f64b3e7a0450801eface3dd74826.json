{"ast":null,"code":"var _jsxFileName = \"/home/tooler/code/work/forests-frontend/src/develop/volto-slate-zotero/src/plugins/zotero/editor/ZoteroDataWrapper.jsx\";\nvar __jsx = React.createElement;\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nimport { Icon as VoltoIcon } from '@plone/volto/components';\nimport briefcaseSVG from '@plone/volto/icons/briefcase.svg';\nimport checkSVG from '@plone/volto/icons/check.svg';\nimport clearSVG from '@plone/volto/icons/clear.svg';\nimport React, { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { toast } from 'react-toastify';\nimport { Button, Loader } from 'semantic-ui-react';\nimport { fetchOpenairePubSearchItems, fetchOpenaireRsdSearchItems, fetchZoteroCollections, fetchZoteroItemCitation, fetchZoteroItems, fetchZoteroSearchItems, fetchZoteroSubCollections, getZoteroSettings, saveItemToZotero } from './actions';\nimport InlineForm from './InlineForm';\nimport MasterDetailWidget from './MasterDetailWidget';\nimport { findDOI, formatCitation, formatOpenAire, makeOpenAireUrlObj } from './utils';\nconst ZoteroDataWrapper = props => {\n  var _props$formData, _props$formData2, _props$formData3;\n  const {\n    0: selectedCollection,\n    1: setSelectedCollection\n  } = useState(null);\n  const {\n    0: selectedItem,\n    1: setSelectedItem\n  } = useState(null);\n  const {\n    0: showSearchResults,\n    1: setShowSearchResults\n  } = useState(false);\n  const {\n    0: hasMultipleDOIs,\n    1: setHasMultipleDOIs\n  } = useState(false);\n  const {\n    0: collections,\n    1: setCollections\n  } = useState([]);\n  const {\n    0: topCollections,\n    1: setTopCollections\n  } = useState([]);\n  const {\n    0: items,\n    1: setItems\n  } = useState([]);\n  const {\n    0: composedItems,\n    1: setComposedItems\n  } = useState([]);\n  const {\n    0: allSearchResults,\n    1: setAllSearchResults\n  } = useState([]);\n  const {\n    0: zoteroSearchResults,\n    1: setZoteroSearchResults\n  } = useState([]);\n  const {\n    0: openAireSearchResults,\n    1: setOpenAireSearchResults\n  } = useState([]);\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(false);\n  const {\n    0: citationLoading,\n    1: setCitationLoading\n  } = useState(false);\n  const {\n    0: loadingMore,\n    1: setLoadingMore\n  } = useState(false);\n  const {\n    0: topCollectionFlag,\n    1: setTopCollectionFlag\n  } = useState(false);\n  const {\n    0: searchTerm,\n    1: setSearchTerm\n  } = useState(null);\n  const {\n    0: updatedFormData,\n    1: setUpdatedFormData\n  } = useState(props.formData); // eslint-disable-line\n  const {\n    0: zoteroSearchItemsTotalResultsNumber,\n    1: setZoteroSearchItemsTotalResultsNumber\n  } = useState(0);\n  const {\n    0: openAireTotalResultsNumber,\n    1: setOpenAireTotalResultsNumber\n  } = useState(0);\n  const {\n    0: openAirePubTotalResultsNumber,\n    1: setOpenAirePubTotalResultsNumber\n  } = useState(0);\n  const {\n    0: openAireRsdTotalResultsNumber,\n    1: setOpenAireRsdTotalResultsNumber\n  } = useState(0);\n  const {\n    0: zoteroItemsTotalResultsNumber,\n    1: setZoteroItemsTotalResultsNumber\n  } = useState(0);\n  const {\n    0: zoteroCollectionsTotalResultsNumber,\n    1: setZoteroCollectionsTotalResultsNumber\n  } = useState(0);\n  const {\n    0: zoteroTopCollectionsTotalResultsNumber,\n    1: setZoteroTopCollectionsTotalResultsNumber\n  } = useState(0);\n  const {\n    0: zoteroItemsOffset,\n    1: setZoteroItemsOffset\n  } = useState(0);\n  const {\n    0: zoteroSearchItemsOffset,\n    1: setZoteroSearchItemsOffset\n  } = useState(0);\n  const {\n    0: zoteroCollectionsOffset,\n    1: setZoteroCollectionsOffset\n  } = useState(0);\n  const {\n    0: openAirePublicationResults,\n    1: setOpenAirePublicationResults\n  } = useState([]);\n  const {\n    0: openAireDataResults,\n    1: setOpenAireDataResults\n  } = useState([]);\n  const zotero_settings = useSelector(state => {\n    var _state$zotero_setting;\n    return state === null || state === void 0 ? void 0 : (_state$zotero_setting = state.zotero_settings) === null || _state$zotero_setting === void 0 ? void 0 : _state$zotero_setting.api;\n  });\n  const zotero_search_items = useSelector(state => {\n    var _state$zotero_search_;\n    return state === null || state === void 0 ? void 0 : (_state$zotero_search_ = state.zotero_search_items) === null || _state$zotero_search_ === void 0 ? void 0 : _state$zotero_search_.api;\n  });\n  const zotero_collections = useSelector(state => {\n    var _state$zotero_collect;\n    return state === null || state === void 0 ? void 0 : (_state$zotero_collect = state.zotero_collections) === null || _state$zotero_collect === void 0 ? void 0 : _state$zotero_collect.api;\n  });\n  const zotero_sub_collections = useSelector(state => {\n    var _state$zotero_sub_col;\n    return state === null || state === void 0 ? void 0 : (_state$zotero_sub_col = state.zotero_sub_collections) === null || _state$zotero_sub_col === void 0 ? void 0 : _state$zotero_sub_col.api;\n  });\n  const zotero_items = useSelector(state => {\n    var _state$zotero_items;\n    return state === null || state === void 0 ? void 0 : (_state$zotero_items = state.zotero_items) === null || _state$zotero_items === void 0 ? void 0 : _state$zotero_items.api;\n  });\n  const zotero_item_citation = useSelector(state => {\n    var _state$zotero_item_ci;\n    return state === null || state === void 0 ? void 0 : (_state$zotero_item_ci = state.zotero_item_citation) === null || _state$zotero_item_ci === void 0 ? void 0 : _state$zotero_item_ci.api;\n  });\n  const zotero_item_saved = useSelector(state => state === null || state === void 0 ? void 0 : state.zotero_item_saved);\n  const openaire_items_pub = useSelector(state => state === null || state === void 0 ? void 0 : state.openaire_items_pub);\n  const openaire_items_rsd = useSelector(state => state === null || state === void 0 ? void 0 : state.openaire_items_rsd);\n  const {\n    0: activeTabIndexS,\n    1: setActiveTabIndexS\n  } = useState(0);\n  const {\n    0: openAirePage,\n    1: setOpenAirePage\n  } = useState(1);\n  const dispatch = useDispatch();\n  const setActiveTabIndex = index => {\n    setActiveTabIndexS(index);\n  };\n  const headers = {\n    Authorization: 'Bearer ' + (zotero_settings === null || zotero_settings === void 0 ? void 0 : zotero_settings.password),\n    'Content-Type': 'application/json'\n  };\n  const zoteroBaseUrl = zotero_settings === null || zotero_settings === void 0 ? void 0 : zotero_settings.server;\n  const zoteroCollectionsTopUrl = `${zoteroBaseUrl}/collections/top/`;\n  const zoteroCollectionsUrl = `${zoteroBaseUrl}/collections/`;\n  const zoteroSearchUrl = `${zoteroBaseUrl}/items?q=`;\n  const fetchCollections = (offset = 0) => {\n    const finalUrl = `${zoteroCollectionsTopUrl}?start=${offset}&limit=10&sort=title`;\n    setTopCollectionFlag(true);\n    dispatch(fetchZoteroCollections(finalUrl, headers));\n  };\n  const fetchItems = (collectionId, offset = 0) => {\n    const finalUrl = `${zoteroCollectionsUrl}${collectionId}/items/?start=${offset}&limit=10&sort=title`;\n    dispatch(fetchZoteroItems(finalUrl, headers));\n  };\n  const fetchSubCollections = (collectionId, offset = 0) => {\n    const finalUrl = `${zoteroCollectionsUrl}${collectionId}/collections/?start=${offset}&limit=10&sort=title`;\n    dispatch(fetchZoteroSubCollections(finalUrl, headers));\n  };\n  const fetchZoteroSearch = (term, offset = 0) => {\n    const finalUrl = `${zoteroSearchUrl}${term}&limit=10&start=${offset}&sort=title`;\n    setShowSearchResults(true);\n    setZoteroSearchItemsOffset(offset);\n    dispatch(fetchZoteroSearchItems(finalUrl, headers));\n  };\n  const fetchAireSearch = (term = searchTerm) => {\n    setShowSearchResults(true);\n    const filters = ['publications', 'rsd'];\n    const objectTypeUrl = makeOpenAireUrlObj(filters);\n    const searchForDoi = findDOI(term);\n    if (searchForDoi.length > 0) {\n      searchForDoi.forEach(doi => {\n        setHasMultipleDOIs(true);\n        const finalPubUrl = `${objectTypeUrl[0]}/?doi=${doi}&format=json`;\n        const finalRsdUrl = `${objectTypeUrl[1]}/?doi=${doi}&format=json`;\n        dispatch(fetchOpenairePubSearchItems([finalPubUrl]));\n        dispatch(fetchOpenaireRsdSearchItems([finalRsdUrl]));\n      });\n    } else {\n      const finalTitlePubUrl = `${objectTypeUrl[0]}/?title=${term}&format=json&size=20&page=${openAirePage}`;\n      const finalAuthorPubUrl = `${objectTypeUrl[0]}/?author=${term}&format=json&size=20&page=${openAirePage}`;\n      const finalTitleRsdUrl = `${objectTypeUrl[1]}/?title=${term}&format=json&size=20&page=${openAirePage}`;\n      const finalAuthorRsdUrl = `${objectTypeUrl[1]}/?author=${term}&format=json&size=20&page=${openAirePage}`;\n      dispatch(fetchOpenairePubSearchItems([finalTitlePubUrl, finalAuthorPubUrl]));\n      dispatch(fetchOpenaireRsdSearchItems([finalTitleRsdUrl, finalAuthorRsdUrl]));\n    }\n  };\n  const fetchItemCitation = zoteroId => {\n    const finalUrl = `${zoteroBaseUrl}/items/${zoteroId}?format=bib&style=${zotero_settings === null || zotero_settings === void 0 ? void 0 : zotero_settings.style}`;\n    dispatch(fetchZoteroItemCitation(finalUrl, headers));\n  };\n  const handleSaveItemToZotero = itemToSave => {\n    const finalUrl = `${zoteroBaseUrl}/items/`;\n    const body = JSON.stringify([itemToSave.data]);\n    dispatch(saveItemToZotero(finalUrl, headers, body));\n  };\n  const handleLoadMore = () => {\n    // load search rezults\n    setLoadingMore(true);\n    setHasMultipleDOIs(false);\n    if (showSearchResults) {\n      switch (activeTabIndexS) {\n        case 0:\n          setOpenAirePage(openAirePage + 1);\n          fetchZoteroSearch(searchTerm, zoteroSearchResults.length);\n          fetchAireSearch(searchTerm);\n          break;\n        case 1:\n          fetchZoteroSearch(searchTerm, zoteroSearchResults.length);\n          break;\n        case 2:\n          setOpenAirePage(openAirePage + 1);\n          fetchAireSearch(searchTerm);\n          break;\n        default:\n          break;\n      }\n    }\n    // load more collections and items\n    else {\n      setZoteroCollectionsOffset(collections.length);\n      setZoteroItemsOffset(items.length);\n      if (topCollectionFlag) {\n        // load more top collections\n        fetchCollections(collections.length);\n      } else {\n        // load more sub-collections and items\n        fetchSubCollections(selectedCollection, collections.length);\n        fetchItems(selectedCollection, items.length);\n      }\n    }\n  };\n  const onChangeSearchTerm = searchTerm => {\n    setLoading(true);\n    setSearchTerm(searchTerm);\n    setZoteroSearchItemsOffset(0);\n    setOpenAirePage(1);\n    setHasMultipleDOIs(false);\n    fetchZoteroSearch(searchTerm);\n    fetchAireSearch(searchTerm);\n  };\n  const pull = () => {\n    setSelectedCollection(null);\n    setTopCollectionFlag(true);\n    setCollections(topCollections);\n    setZoteroCollectionsTotalResultsNumber(zoteroTopCollectionsTotalResultsNumber);\n  };\n  const pushCollection = selectedCollectionIndex => {\n    const selectedCol = collections[selectedCollectionIndex];\n    setLoading(true);\n    setZoteroSearchItemsOffset(0);\n    setZoteroItemsOffset(0);\n    setCollections([]);\n    setZoteroCollectionsTotalResultsNumber(0);\n    setTopCollectionFlag(false);\n    if (selectedCol.meta.numCollections > 0) {\n      fetchSubCollections(selectedCol.key);\n    }\n    fetchItems(selectedCol.key);\n    setSelectedCollection(selectedCol.key);\n  };\n  const showCollections = () => {\n    setActiveTabIndexS(-1);\n    setShowSearchResults(false);\n    pull();\n  };\n  const pushItem = receivedItem => {\n    setCitationLoading(true);\n    fetchItemCitation(receivedItem.key);\n    setSelectedItem(receivedItem);\n  };\n  const pushSearchItem = receivedItem => {\n    setCitationLoading(true);\n    setSelectedItem(receivedItem);\n    if (!receivedItem.isOpenAire) {\n      fetchItemCitation(receivedItem.key);\n    } else {\n      handleSaveItemToZotero(receivedItem);\n    }\n  };\n\n  /**\n   * Will search for openAire based on received filters\n   * @param {string[]} item\n   */\n  const openAireCallback = filterList => {\n    const aireLiteral = {\n      publications: openAirePublicationResults,\n      rsd: openAireDataResults\n    };\n    const aireResults = filterList.reduce((accumulator, currentValue) => {\n      return [...accumulator, ...aireLiteral[currentValue]];\n    }, []);\n    setAllSearchResults([...zoteroSearchResults, ...aireResults]);\n    setOpenAireSearchResults(aireResults);\n  };\n\n  // Similar to componentDidMount and componentDidUpdate:\n  // used only once at mount\n  useEffect(() => {\n    dispatch(getZoteroSettings());\n    // to be used only once at mount\n  }, []); // eslint-disable-line\n\n  useEffect(() => {\n    if (zotero_settings) {\n      setLoading(true);\n      fetchCollections();\n    }\n  }, [zotero_settings]); // eslint-disable-line\n\n  useEffect(() => {\n    if (zotero_collections) {\n      let mergedResult = zoteroCollectionsOffset > 0 ? [...collections, ...zotero_collections.results] : zotero_collections.results;\n      setCollections(mergedResult);\n      if (topCollectionFlag) setTopCollections(mergedResult);\n      setZoteroCollectionsTotalResultsNumber(zotero_collections.totalResults);\n      setZoteroTopCollectionsTotalResultsNumber(zotero_collections.totalResults);\n      setLoading(false);\n      setLoadingMore(false);\n    }\n  }, [zotero_collections]); // eslint-disable-line\n\n  useEffect(() => {\n    if (zotero_sub_collections) {\n      let mergedResult = zoteroCollectionsOffset > 0 ? [...collections, ...zotero_sub_collections.results] : zotero_sub_collections.results;\n      const formattedResults = mergedResult.map(item => {\n        const formattedItem = _objectSpread({}, item);\n        formattedItem.citationTitle = formatCitation(item);\n        return formattedItem;\n      });\n      setCollections(formattedResults);\n      setZoteroCollectionsTotalResultsNumber(zotero_sub_collections.totalResults);\n      setComposedItems([...formattedResults, ...items]);\n      setLoading(false);\n      setLoadingMore(false);\n    }\n  }, [zotero_sub_collections]); // eslint-disable-line\n\n  useEffect(() => {\n    if (zotero_items) {\n      let mergedResult = zoteroItemsOffset > 0 ? [...items, ...zotero_items.results] : zotero_items.results;\n      const formattedResults = mergedResult.map(item => {\n        const formattedItem = _objectSpread({}, item);\n        formattedItem.citationTitle = formatCitation(item);\n        return formattedItem;\n      });\n      setItems(formattedResults);\n      setZoteroItemsTotalResultsNumber(zotero_items.totalResults);\n      setComposedItems([...collections, ...formattedResults]);\n      setLoading(false);\n      setLoadingMore(false);\n    }\n  }, [zotero_items]); // eslint-disable-line\n\n  useEffect(() => {\n    if (zotero_item_citation && selectedItem) {\n      setLoading(false);\n      setLoadingMore(false);\n      setCitationLoading(false);\n      const footnote = zotero_item_citation.result;\n      setUpdatedFormData(updatedFormData.footnote ? _objectSpread(_objectSpread({}, updatedFormData), {}, {\n        extra: [...(updatedFormData.extra || []), {\n          footnote,\n          zoteroId: selectedItem.key,\n          footnoteTitle: formatCitation(selectedItem)\n        }]\n      }) : _objectSpread(_objectSpread({}, updatedFormData), {\n        footnote,\n        zoteroId: selectedItem.key,\n        footnoteTitle: formatCitation(selectedItem)\n      }));\n    }\n  }, [zotero_item_citation]); // eslint-disable-line\n\n  useEffect(() => {\n    var _zotero_item_saved$zo;\n    if (zotero_item_saved.api) {\n      const itemId = zotero_item_saved.api.success[0];\n      toast.success('Successfully added to Zotero Library');\n      setLoading(false);\n      fetchItemCitation(itemId);\n    }\n    if (zotero_item_saved !== null && zotero_item_saved !== void 0 && (_zotero_item_saved$zo = zotero_item_saved.zotero) !== null && _zotero_item_saved$zo !== void 0 && _zotero_item_saved$zo.error) {\n      setLoading(false);\n      setLoadingMore(false);\n    }\n  }, [zotero_item_saved]); // eslint-disable-line\n\n  useEffect(() => {\n    if (zotero_search_items) {\n      const finalResult = zoteroSearchItemsOffset > 0 ? [...zoteroSearchResults, ...zotero_search_items.results] : zotero_search_items.results;\n      const zoteroResults = finalResult.map(item => {\n        const formattedItem = _objectSpread({}, item);\n        formattedItem.citationTitle = formatCitation(item);\n        return formattedItem;\n      });\n      setZoteroSearchItemsTotalResultsNumber(zotero_search_items.totalResults);\n      setZoteroSearchResults(zoteroResults);\n      setAllSearchResults([...zoteroResults, ...openAirePublicationResults, ...openAireDataResults]);\n      setLoading(false);\n      setLoadingMore(false);\n    }\n  }, [zotero_search_items]); // eslint-disable-line\n\n  useEffect(() => {\n    if (openaire_items_pub.api) {\n      const formattedResults = openaire_items_pub.api.map(item => formatOpenAire(item, 'publications', zotero_settings === null || zotero_settings === void 0 ? void 0 : zotero_settings.default));\n      const publicationRestuls = openAirePage > 1 ? [...openAirePublicationResults, ...formattedResults] : hasMultipleDOIs ? [...openAirePublicationResults, ...formattedResults] : formattedResults;\n      const uniquePublicationRestuls = publicationRestuls.filter(result => {\n        return !zoteroSearchResults.find(zoteroResult => zoteroResult.data.DOI === result.data.DOI);\n      });\n      setOpenAirePubTotalResultsNumber(openaire_items_pub.totalResults);\n      setOpenAireTotalResultsNumber(openaire_items_pub.totalResults + openAireRsdTotalResultsNumber);\n      setOpenAirePublicationResults(uniquePublicationRestuls);\n      setOpenAireSearchResults([...uniquePublicationRestuls, ...openAireDataResults]);\n      setAllSearchResults([...zoteroSearchResults, ...uniquePublicationRestuls, ...openAireDataResults]);\n      setLoading(false);\n      setLoadingMore(false);\n    }\n  }, [openaire_items_pub]); // eslint-disable-line\n\n  useEffect(() => {\n    if (openaire_items_rsd.api) {\n      const formattedResults = openaire_items_rsd.api.map(item => formatOpenAire(item, 'rsd', zotero_settings === null || zotero_settings === void 0 ? void 0 : zotero_settings.default));\n      const rsdRestuls = openAirePage > 1 ? [...openAireDataResults, ...formattedResults] : hasMultipleDOIs ? [...openAireDataResults, ...formattedResults] : formattedResults;\n      const uniqueRsdRestuls = rsdRestuls.filter(result => {\n        return !zoteroSearchResults.find(zoteroResult => zoteroResult.data.DOI === result.data.DOI);\n      });\n      setOpenAireRsdTotalResultsNumber(openaire_items_rsd.totalResults);\n      setOpenAireTotalResultsNumber(openaire_items_rsd.totalResults + openAirePubTotalResultsNumber);\n      setOpenAireDataResults(uniqueRsdRestuls);\n      setOpenAireSearchResults([...openAirePublicationResults, ...uniqueRsdRestuls]);\n      setAllSearchResults([...zoteroSearchResults, ...openAirePublicationResults, ...uniqueRsdRestuls]);\n      setLoading(false);\n      setLoadingMore(false);\n    }\n  }, [openaire_items_rsd]); // eslint-disable-line\n\n  useEffect(() => {\n    setUpdatedFormData(_objectSpread({}, props.formData));\n    /* eslint-disable */\n  }, [props.formData, (_props$formData = props.formData) === null || _props$formData === void 0 ? void 0 : _props$formData.footnote, (_props$formData2 = props.formData) === null || _props$formData2 === void 0 ? void 0 : _props$formData2.footnoteTitle, (_props$formData3 = props.formData) === null || _props$formData3 === void 0 ? void 0 : _props$formData3.zoteroId]);\n  const deleteItem = index => {\n    let formDataAfterDelete = null;\n    if (index > -1 && updatedFormData.extra) {\n      formDataAfterDelete = _objectSpread(_objectSpread({}, updatedFormData), {}, {\n        extra: [...updatedFormData.extra.slice(0, index), ...updatedFormData.extra.slice(index + 1)]\n      });\n    } else if (index === -1 && (!updatedFormData.extra || updatedFormData.extra.length === 0)) {\n      formDataAfterDelete = {\n        uid: updatedFormData.uid\n      };\n    } else if (index === -1 && updatedFormData.extra && updatedFormData.extra.length > 0) {\n      const firstExtraCitation = updatedFormData.extra.slice(0, 1)[0];\n      const {\n        footnote,\n        footnoteTitle,\n        zoteroId\n      } = firstExtraCitation;\n      formDataAfterDelete = _objectSpread(_objectSpread(_objectSpread({}, updatedFormData), {\n        footnote,\n        footnoteTitle,\n        zoteroId\n      }), {}, {\n        extra: [...updatedFormData.extra.slice(1)]\n      });\n    }\n    setUpdatedFormData(formDataAfterDelete);\n  };\n  const loadMoreButton = __jsx(Button, {\n    primary: true,\n    loading: loadingMore,\n    onClick: handleLoadMore,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 569,\n      columnNumber: 5\n    }\n  }, \"Load more\");\n  return __jsx(\"div\", {\n    id: \"zotero-comp\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 575,\n      columnNumber: 5\n    }\n  }, __jsx(InlineForm, {\n    schema: props.schema,\n    title: props.title,\n    icon: __jsx(VoltoIcon, {\n      size: \"24px\",\n      name: briefcaseSVG,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 579,\n        columnNumber: 15\n      }\n    }),\n    updatedFormData: updatedFormData,\n    deleteItem: deleteItem,\n    headerActions: __jsx(React.Fragment, null, __jsx(\"button\", {\n      onClick: (id, value) => {\n        props.submitHandler(updatedFormData);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 584,\n        columnNumber: 13\n      }\n    }, !citationLoading ? __jsx(VoltoIcon, {\n      size: \"24px\",\n      name: checkSVG,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 590,\n        columnNumber: 17\n      }\n    }) : __jsx(Loader, {\n      active: true,\n      inline: true,\n      size: \"small\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 592,\n        columnNumber: 17\n      }\n    })), __jsx(\"button\", {\n      onClick: props.clearHandler,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 595,\n        columnNumber: 13\n      }\n    }, __jsx(VoltoIcon, {\n      size: \"24px\",\n      name: clearSVG,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 596,\n        columnNumber: 15\n      }\n    }))),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 576,\n      columnNumber: 7\n    }\n  }), __jsx(MasterDetailWidget, {\n    pull: pull,\n    pushCollection: pushCollection,\n    pushItem: pushItem,\n    items: composedItems,\n    collections: collections,\n    loading: loading,\n    selectedCollection: selectedCollection,\n    onChangeSearchTerm: onChangeSearchTerm,\n    showSearchResults: showSearchResults,\n    allSearchResults: allSearchResults,\n    zoteroSearchResults: zoteroSearchResults,\n    openAireSearchResults: openAireSearchResults,\n    pushSearchItem: pushSearchItem,\n    showCollections: showCollections,\n    setActiveTabIndex: setActiveTabIndex,\n    openAireCallback: openAireCallback,\n    zoteroSearchItemsTotalResultsNumber: zoteroSearchItemsTotalResultsNumber,\n    openAireTotalResultsNumber: openAireTotalResultsNumber,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 601,\n      columnNumber: 7\n    }\n  }), showSearchResults ? allSearchResults.length < openAireTotalResultsNumber ? loadMoreButton : null : topCollectionFlag ? zoteroCollectionsTotalResultsNumber > collections.length ? loadMoreButton : null : zoteroCollectionsTotalResultsNumber + zoteroItemsTotalResultsNumber > composedItems.length ? loadMoreButton : null);\n};\nexport default ZoteroDataWrapper;","map":{"version":3,"names":["Icon","VoltoIcon","briefcaseSVG","checkSVG","clearSVG","React","useEffect","useState","useDispatch","useSelector","toast","Button","Loader","fetchOpenairePubSearchItems","fetchOpenaireRsdSearchItems","fetchZoteroCollections","fetchZoteroItemCitation","fetchZoteroItems","fetchZoteroSearchItems","fetchZoteroSubCollections","getZoteroSettings","saveItemToZotero","InlineForm","MasterDetailWidget","findDOI","formatCitation","formatOpenAire","makeOpenAireUrlObj","ZoteroDataWrapper","props","selectedCollection","setSelectedCollection","selectedItem","setSelectedItem","showSearchResults","setShowSearchResults","hasMultipleDOIs","setHasMultipleDOIs","collections","setCollections","topCollections","setTopCollections","items","setItems","composedItems","setComposedItems","allSearchResults","setAllSearchResults","zoteroSearchResults","setZoteroSearchResults","openAireSearchResults","setOpenAireSearchResults","loading","setLoading","citationLoading","setCitationLoading","loadingMore","setLoadingMore","topCollectionFlag","setTopCollectionFlag","searchTerm","setSearchTerm","updatedFormData","setUpdatedFormData","formData","zoteroSearchItemsTotalResultsNumber","setZoteroSearchItemsTotalResultsNumber","openAireTotalResultsNumber","setOpenAireTotalResultsNumber","openAirePubTotalResultsNumber","setOpenAirePubTotalResultsNumber","openAireRsdTotalResultsNumber","setOpenAireRsdTotalResultsNumber","zoteroItemsTotalResultsNumber","setZoteroItemsTotalResultsNumber","zoteroCollectionsTotalResultsNumber","setZoteroCollectionsTotalResultsNumber","zoteroTopCollectionsTotalResultsNumber","setZoteroTopCollectionsTotalResultsNumber","zoteroItemsOffset","setZoteroItemsOffset","zoteroSearchItemsOffset","setZoteroSearchItemsOffset","zoteroCollectionsOffset","setZoteroCollectionsOffset","openAirePublicationResults","setOpenAirePublicationResults","openAireDataResults","setOpenAireDataResults","zotero_settings","state","api","zotero_search_items","zotero_collections","zotero_sub_collections","zotero_items","zotero_item_citation","zotero_item_saved","openaire_items_pub","openaire_items_rsd","activeTabIndexS","setActiveTabIndexS","openAirePage","setOpenAirePage","dispatch","setActiveTabIndex","index","headers","Authorization","password","zoteroBaseUrl","server","zoteroCollectionsTopUrl","zoteroCollectionsUrl","zoteroSearchUrl","fetchCollections","offset","finalUrl","fetchItems","collectionId","fetchSubCollections","fetchZoteroSearch","term","fetchAireSearch","filters","objectTypeUrl","searchForDoi","length","forEach","doi","finalPubUrl","finalRsdUrl","finalTitlePubUrl","finalAuthorPubUrl","finalTitleRsdUrl","finalAuthorRsdUrl","fetchItemCitation","zoteroId","style","handleSaveItemToZotero","itemToSave","body","JSON","stringify","data","handleLoadMore","onChangeSearchTerm","pull","pushCollection","selectedCollectionIndex","selectedCol","meta","numCollections","key","showCollections","pushItem","receivedItem","pushSearchItem","isOpenAire","openAireCallback","filterList","aireLiteral","publications","rsd","aireResults","reduce","accumulator","currentValue","mergedResult","results","totalResults","formattedResults","map","item","formattedItem","citationTitle","footnote","result","extra","footnoteTitle","itemId","success","zotero","error","finalResult","zoteroResults","default","publicationRestuls","uniquePublicationRestuls","filter","find","zoteroResult","DOI","rsdRestuls","uniqueRsdRestuls","deleteItem","formDataAfterDelete","slice","uid","firstExtraCitation","loadMoreButton","schema","title","id","value","submitHandler","clearHandler"],"sources":["/home/tooler/code/work/forests-frontend/src/develop/volto-slate-zotero/src/plugins/zotero/editor/ZoteroDataWrapper.jsx"],"sourcesContent":["import { Icon as VoltoIcon } from '@plone/volto/components';\nimport briefcaseSVG from '@plone/volto/icons/briefcase.svg';\nimport checkSVG from '@plone/volto/icons/check.svg';\nimport clearSVG from '@plone/volto/icons/clear.svg';\nimport React, { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { toast } from 'react-toastify';\nimport { Button, Loader } from 'semantic-ui-react';\nimport {\n  fetchOpenairePubSearchItems,\n  fetchOpenaireRsdSearchItems,\n  fetchZoteroCollections,\n  fetchZoteroItemCitation,\n  fetchZoteroItems,\n  fetchZoteroSearchItems,\n  fetchZoteroSubCollections,\n  getZoteroSettings,\n  saveItemToZotero,\n} from './actions';\nimport InlineForm from './InlineForm';\nimport MasterDetailWidget from './MasterDetailWidget';\nimport {\n  findDOI,\n  formatCitation,\n  formatOpenAire,\n  makeOpenAireUrlObj,\n} from './utils';\n\nconst ZoteroDataWrapper = (props) => {\n  const [selectedCollection, setSelectedCollection] = useState(null);\n  const [selectedItem, setSelectedItem] = useState(null);\n  const [showSearchResults, setShowSearchResults] = useState(false);\n  const [hasMultipleDOIs, setHasMultipleDOIs] = useState(false);\n  const [collections, setCollections] = useState([]);\n  const [topCollections, setTopCollections] = useState([]);\n  const [items, setItems] = useState([]);\n  const [composedItems, setComposedItems] = useState([]);\n  const [allSearchResults, setAllSearchResults] = useState([]);\n  const [zoteroSearchResults, setZoteroSearchResults] = useState([]);\n  const [openAireSearchResults, setOpenAireSearchResults] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [citationLoading, setCitationLoading] = useState(false);\n  const [loadingMore, setLoadingMore] = useState(false);\n  const [topCollectionFlag, setTopCollectionFlag] = useState(false);\n  const [searchTerm, setSearchTerm] = useState(null);\n  const [updatedFormData, setUpdatedFormData] = useState(props.formData); // eslint-disable-line\n  const [\n    zoteroSearchItemsTotalResultsNumber,\n    setZoteroSearchItemsTotalResultsNumber,\n  ] = useState(0);\n  const [openAireTotalResultsNumber, setOpenAireTotalResultsNumber] = useState(\n    0,\n  );\n  const [\n    openAirePubTotalResultsNumber,\n    setOpenAirePubTotalResultsNumber,\n  ] = useState(0);\n  const [\n    openAireRsdTotalResultsNumber,\n    setOpenAireRsdTotalResultsNumber,\n  ] = useState(0);\n  const [\n    zoteroItemsTotalResultsNumber,\n    setZoteroItemsTotalResultsNumber,\n  ] = useState(0);\n  const [\n    zoteroCollectionsTotalResultsNumber,\n    setZoteroCollectionsTotalResultsNumber,\n  ] = useState(0);\n  const [\n    zoteroTopCollectionsTotalResultsNumber,\n    setZoteroTopCollectionsTotalResultsNumber,\n  ] = useState(0);\n  const [zoteroItemsOffset, setZoteroItemsOffset] = useState(0);\n  const [zoteroSearchItemsOffset, setZoteroSearchItemsOffset] = useState(0);\n  const [zoteroCollectionsOffset, setZoteroCollectionsOffset] = useState(0);\n  const [openAirePublicationResults, setOpenAirePublicationResults] = useState(\n    [],\n  );\n  const [openAireDataResults, setOpenAireDataResults] = useState([]);\n  const zotero_settings = useSelector((state) => state?.zotero_settings?.api);\n  const zotero_search_items = useSelector(\n    (state) => state?.zotero_search_items?.api,\n  );\n  const zotero_collections = useSelector(\n    (state) => state?.zotero_collections?.api,\n  );\n  const zotero_sub_collections = useSelector(\n    (state) => state?.zotero_sub_collections?.api,\n  );\n  const zotero_items = useSelector((state) => state?.zotero_items?.api);\n  const zotero_item_citation = useSelector(\n    (state) => state?.zotero_item_citation?.api,\n  );\n  const zotero_item_saved = useSelector((state) => state?.zotero_item_saved);\n  const openaire_items_pub = useSelector((state) => state?.openaire_items_pub);\n  const openaire_items_rsd = useSelector((state) => state?.openaire_items_rsd);\n  const [activeTabIndexS, setActiveTabIndexS] = useState(0);\n  const [openAirePage, setOpenAirePage] = useState(1);\n  const dispatch = useDispatch();\n  const setActiveTabIndex = (index) => {\n    setActiveTabIndexS(index);\n  };\n\n  const headers = {\n    Authorization: 'Bearer ' + zotero_settings?.password,\n    'Content-Type': 'application/json',\n  };\n  const zoteroBaseUrl = zotero_settings?.server;\n  const zoteroCollectionsTopUrl = `${zoteroBaseUrl}/collections/top/`;\n  const zoteroCollectionsUrl = `${zoteroBaseUrl}/collections/`;\n  const zoteroSearchUrl = `${zoteroBaseUrl}/items?q=`;\n\n  const fetchCollections = (offset = 0) => {\n    const finalUrl = `${zoteroCollectionsTopUrl}?start=${offset}&limit=10&sort=title`;\n\n    setTopCollectionFlag(true);\n    dispatch(fetchZoteroCollections(finalUrl, headers));\n  };\n\n  const fetchItems = (collectionId, offset = 0) => {\n    const finalUrl = `${zoteroCollectionsUrl}${collectionId}/items/?start=${offset}&limit=10&sort=title`;\n\n    dispatch(fetchZoteroItems(finalUrl, headers));\n  };\n\n  const fetchSubCollections = (collectionId, offset = 0) => {\n    const finalUrl = `${zoteroCollectionsUrl}${collectionId}/collections/?start=${offset}&limit=10&sort=title`;\n\n    dispatch(fetchZoteroSubCollections(finalUrl, headers));\n  };\n\n  const fetchZoteroSearch = (term, offset = 0) => {\n    const finalUrl = `${zoteroSearchUrl}${term}&limit=10&start=${offset}&sort=title`;\n\n    setShowSearchResults(true);\n    setZoteroSearchItemsOffset(offset);\n    dispatch(fetchZoteroSearchItems(finalUrl, headers));\n  };\n\n  const fetchAireSearch = (term = searchTerm) => {\n    setShowSearchResults(true);\n\n    const filters = ['publications', 'rsd'];\n    const objectTypeUrl = makeOpenAireUrlObj(filters);\n    const searchForDoi = findDOI(term);\n\n    if (searchForDoi.length > 0) {\n      searchForDoi.forEach((doi) => {\n        setHasMultipleDOIs(true);\n        const finalPubUrl = `${objectTypeUrl[0]}/?doi=${doi}&format=json`;\n        const finalRsdUrl = `${objectTypeUrl[1]}/?doi=${doi}&format=json`;\n\n        dispatch(fetchOpenairePubSearchItems([finalPubUrl]));\n        dispatch(fetchOpenaireRsdSearchItems([finalRsdUrl]));\n      });\n    } else {\n      const finalTitlePubUrl = `${objectTypeUrl[0]}/?title=${term}&format=json&size=20&page=${openAirePage}`;\n      const finalAuthorPubUrl = `${objectTypeUrl[0]}/?author=${term}&format=json&size=20&page=${openAirePage}`;\n      const finalTitleRsdUrl = `${objectTypeUrl[1]}/?title=${term}&format=json&size=20&page=${openAirePage}`;\n      const finalAuthorRsdUrl = `${objectTypeUrl[1]}/?author=${term}&format=json&size=20&page=${openAirePage}`;\n\n      dispatch(\n        fetchOpenairePubSearchItems([finalTitlePubUrl, finalAuthorPubUrl]),\n      );\n      dispatch(\n        fetchOpenaireRsdSearchItems([finalTitleRsdUrl, finalAuthorRsdUrl]),\n      );\n    }\n  };\n\n  const fetchItemCitation = (zoteroId) => {\n    const finalUrl = `${zoteroBaseUrl}/items/${zoteroId}?format=bib&style=${zotero_settings?.style}`;\n\n    dispatch(fetchZoteroItemCitation(finalUrl, headers));\n  };\n\n  const handleSaveItemToZotero = (itemToSave) => {\n    const finalUrl = `${zoteroBaseUrl}/items/`;\n    const body = JSON.stringify([itemToSave.data]);\n\n    dispatch(saveItemToZotero(finalUrl, headers, body));\n  };\n\n  const handleLoadMore = () => {\n    // load search rezults\n    setLoadingMore(true);\n    setHasMultipleDOIs(false);\n    if (showSearchResults) {\n      switch (activeTabIndexS) {\n        case 0:\n          setOpenAirePage(openAirePage + 1);\n          fetchZoteroSearch(searchTerm, zoteroSearchResults.length);\n          fetchAireSearch(searchTerm);\n          break;\n        case 1:\n          fetchZoteroSearch(searchTerm, zoteroSearchResults.length);\n          break;\n        case 2:\n          setOpenAirePage(openAirePage + 1);\n          fetchAireSearch(searchTerm);\n          break;\n        default:\n          break;\n      }\n    }\n    // load more collections and items\n    else {\n      setZoteroCollectionsOffset(collections.length);\n      setZoteroItemsOffset(items.length);\n\n      if (topCollectionFlag) {\n        // load more top collections\n        fetchCollections(collections.length);\n      } else {\n        // load more sub-collections and items\n        fetchSubCollections(selectedCollection, collections.length);\n        fetchItems(selectedCollection, items.length);\n      }\n    }\n  };\n\n  const onChangeSearchTerm = (searchTerm) => {\n    setLoading(true);\n    setSearchTerm(searchTerm);\n    setZoteroSearchItemsOffset(0);\n    setOpenAirePage(1);\n    setHasMultipleDOIs(false);\n\n    fetchZoteroSearch(searchTerm);\n    fetchAireSearch(searchTerm);\n  };\n\n  const pull = () => {\n    setSelectedCollection(null);\n    setTopCollectionFlag(true);\n    setCollections(topCollections);\n    setZoteroCollectionsTotalResultsNumber(\n      zoteroTopCollectionsTotalResultsNumber,\n    );\n  };\n\n  const pushCollection = (selectedCollectionIndex) => {\n    const selectedCol = collections[selectedCollectionIndex];\n\n    setLoading(true);\n    setZoteroSearchItemsOffset(0);\n    setZoteroItemsOffset(0);\n    setCollections([]);\n    setZoteroCollectionsTotalResultsNumber(0);\n    setTopCollectionFlag(false);\n\n    if (selectedCol.meta.numCollections > 0) {\n      fetchSubCollections(selectedCol.key);\n    }\n\n    fetchItems(selectedCol.key);\n    setSelectedCollection(selectedCol.key);\n  };\n\n  const showCollections = () => {\n    setActiveTabIndexS(-1);\n    setShowSearchResults(false);\n    pull();\n  };\n\n  const pushItem = (receivedItem) => {\n    setCitationLoading(true);\n    fetchItemCitation(receivedItem.key);\n    setSelectedItem(receivedItem);\n  };\n\n  const pushSearchItem = (receivedItem) => {\n    setCitationLoading(true);\n    setSelectedItem(receivedItem);\n    if (!receivedItem.isOpenAire) {\n      fetchItemCitation(receivedItem.key);\n    } else {\n      handleSaveItemToZotero(receivedItem);\n    }\n  };\n\n  /**\n   * Will search for openAire based on received filters\n   * @param {string[]} item\n   */\n  const openAireCallback = (filterList) => {\n    const aireLiteral = {\n      publications: openAirePublicationResults,\n      rsd: openAireDataResults,\n    };\n    const aireResults = filterList.reduce((accumulator, currentValue) => {\n      return [...accumulator, ...aireLiteral[currentValue]];\n    }, []);\n\n    setAllSearchResults([...zoteroSearchResults, ...aireResults]);\n    setOpenAireSearchResults(aireResults);\n  };\n\n  // Similar to componentDidMount and componentDidUpdate:\n  // used only once at mount\n  useEffect(() => {\n    dispatch(getZoteroSettings());\n    // to be used only once at mount\n  }, []); // eslint-disable-line\n\n  useEffect(() => {\n    if (zotero_settings) {\n      setLoading(true);\n      fetchCollections();\n    }\n  }, [zotero_settings]); // eslint-disable-line\n\n  useEffect(() => {\n    if (zotero_collections) {\n      let mergedResult =\n        zoteroCollectionsOffset > 0\n          ? [...collections, ...zotero_collections.results]\n          : zotero_collections.results;\n\n      setCollections(mergedResult);\n\n      if (topCollectionFlag) setTopCollections(mergedResult);\n\n      setZoteroCollectionsTotalResultsNumber(zotero_collections.totalResults);\n      setZoteroTopCollectionsTotalResultsNumber(\n        zotero_collections.totalResults,\n      );\n      setLoading(false);\n      setLoadingMore(false);\n    }\n  }, [zotero_collections]); // eslint-disable-line\n\n  useEffect(() => {\n    if (zotero_sub_collections) {\n      let mergedResult =\n        zoteroCollectionsOffset > 0\n          ? [...collections, ...zotero_sub_collections.results]\n          : zotero_sub_collections.results;\n      const formattedResults = mergedResult.map((item) => {\n        const formattedItem = { ...item };\n        formattedItem.citationTitle = formatCitation(item);\n\n        return formattedItem;\n      });\n\n      setCollections(formattedResults);\n      setZoteroCollectionsTotalResultsNumber(\n        zotero_sub_collections.totalResults,\n      );\n      setComposedItems([...formattedResults, ...items]);\n      setLoading(false);\n      setLoadingMore(false);\n    }\n  }, [zotero_sub_collections]); // eslint-disable-line\n\n  useEffect(() => {\n    if (zotero_items) {\n      let mergedResult =\n        zoteroItemsOffset > 0\n          ? [...items, ...zotero_items.results]\n          : zotero_items.results;\n      const formattedResults = mergedResult.map((item) => {\n        const formattedItem = { ...item };\n        formattedItem.citationTitle = formatCitation(item);\n\n        return formattedItem;\n      });\n\n      setItems(formattedResults);\n      setZoteroItemsTotalResultsNumber(zotero_items.totalResults);\n      setComposedItems([...collections, ...formattedResults]);\n      setLoading(false);\n      setLoadingMore(false);\n    }\n  }, [zotero_items]); // eslint-disable-line\n\n  useEffect(() => {\n    if (zotero_item_citation && selectedItem) {\n      setLoading(false);\n      setLoadingMore(false);\n      setCitationLoading(false);\n      const footnote = zotero_item_citation.result;\n\n      setUpdatedFormData(\n        updatedFormData.footnote\n          ? {\n              ...updatedFormData,\n              extra: [\n                ...(updatedFormData.extra || []),\n                {\n                  footnote,\n                  zoteroId: selectedItem.key,\n                  footnoteTitle: formatCitation(selectedItem),\n                },\n              ],\n            }\n          : {\n              ...updatedFormData,\n              ...{\n                footnote,\n                zoteroId: selectedItem.key,\n                footnoteTitle: formatCitation(selectedItem),\n              },\n            },\n      );\n    }\n  }, [zotero_item_citation]); // eslint-disable-line\n\n  useEffect(() => {\n    if (zotero_item_saved.api) {\n      const itemId = zotero_item_saved.api.success[0];\n      toast.success('Successfully added to Zotero Library');\n\n      setLoading(false);\n      fetchItemCitation(itemId);\n    }\n    if (zotero_item_saved?.zotero?.error) {\n      setLoading(false);\n      setLoadingMore(false);\n    }\n  }, [zotero_item_saved]); // eslint-disable-line\n\n  useEffect(() => {\n    if (zotero_search_items) {\n      const finalResult =\n        zoteroSearchItemsOffset > 0\n          ? [...zoteroSearchResults, ...zotero_search_items.results]\n          : zotero_search_items.results;\n\n      const zoteroResults = finalResult.map((item) => {\n        const formattedItem = { ...item };\n        formattedItem.citationTitle = formatCitation(item);\n\n        return formattedItem;\n      });\n\n      setZoteroSearchItemsTotalResultsNumber(zotero_search_items.totalResults);\n      setZoteroSearchResults(zoteroResults);\n      setAllSearchResults([\n        ...zoteroResults,\n        ...openAirePublicationResults,\n        ...openAireDataResults,\n      ]);\n      setLoading(false);\n      setLoadingMore(false);\n    }\n  }, [zotero_search_items]); // eslint-disable-line\n\n  useEffect(() => {\n    if (openaire_items_pub.api) {\n      const formattedResults = openaire_items_pub.api.map((item) =>\n        formatOpenAire(item, 'publications', zotero_settings?.default),\n      );\n      const publicationRestuls =\n        openAirePage > 1\n          ? [...openAirePublicationResults, ...formattedResults]\n          : hasMultipleDOIs\n          ? [...openAirePublicationResults, ...formattedResults]\n          : formattedResults;\n\n      const uniquePublicationRestuls = publicationRestuls.filter((result) => {\n        return !zoteroSearchResults.find(\n          (zoteroResult) => zoteroResult.data.DOI === result.data.DOI,\n        );\n      });\n\n      setOpenAirePubTotalResultsNumber(openaire_items_pub.totalResults);\n      setOpenAireTotalResultsNumber(\n        openaire_items_pub.totalResults + openAireRsdTotalResultsNumber,\n      );\n      setOpenAirePublicationResults(uniquePublicationRestuls);\n      setOpenAireSearchResults([\n        ...uniquePublicationRestuls,\n        ...openAireDataResults,\n      ]);\n      setAllSearchResults([\n        ...zoteroSearchResults,\n        ...uniquePublicationRestuls,\n        ...openAireDataResults,\n      ]);\n      setLoading(false);\n      setLoadingMore(false);\n    }\n  }, [openaire_items_pub]); // eslint-disable-line\n\n  useEffect(() => {\n    if (openaire_items_rsd.api) {\n      const formattedResults = openaire_items_rsd.api.map((item) =>\n        formatOpenAire(item, 'rsd', zotero_settings?.default),\n      );\n      const rsdRestuls =\n        openAirePage > 1\n          ? [...openAireDataResults, ...formattedResults]\n          : hasMultipleDOIs\n          ? [...openAireDataResults, ...formattedResults]\n          : formattedResults;\n      const uniqueRsdRestuls = rsdRestuls.filter((result) => {\n        return !zoteroSearchResults.find(\n          (zoteroResult) => zoteroResult.data.DOI === result.data.DOI,\n        );\n      });\n\n      setOpenAireRsdTotalResultsNumber(openaire_items_rsd.totalResults);\n      setOpenAireTotalResultsNumber(\n        openaire_items_rsd.totalResults + openAirePubTotalResultsNumber,\n      );\n      setOpenAireDataResults(uniqueRsdRestuls);\n      setOpenAireSearchResults([\n        ...openAirePublicationResults,\n        ...uniqueRsdRestuls,\n      ]);\n      setAllSearchResults([\n        ...zoteroSearchResults,\n        ...openAirePublicationResults,\n        ...uniqueRsdRestuls,\n      ]);\n      setLoading(false);\n      setLoadingMore(false);\n    }\n  }, [openaire_items_rsd]); // eslint-disable-line\n\n  useEffect(() => {\n    setUpdatedFormData({\n      ...props.formData,\n    });\n    /* eslint-disable */\n  }, [\n    props.formData,\n    props.formData?.footnote,\n    props.formData?.footnoteTitle,\n    props.formData?.zoteroId,\n  ]);\n\n  const deleteItem = (index) => {\n    let formDataAfterDelete = null;\n\n    if (index > -1 && updatedFormData.extra) {\n      formDataAfterDelete = {\n        ...updatedFormData,\n        extra: [\n          ...updatedFormData.extra.slice(0, index),\n          ...updatedFormData.extra.slice(index + 1),\n        ],\n      };\n    } else if (\n      index === -1 &&\n      (!updatedFormData.extra || updatedFormData.extra.length === 0)\n    ) {\n      formDataAfterDelete = { uid: updatedFormData.uid };\n    } else if (\n      index === -1 &&\n      updatedFormData.extra &&\n      updatedFormData.extra.length > 0\n    ) {\n      const firstExtraCitation = updatedFormData.extra.slice(0, 1)[0];\n      const { footnote, footnoteTitle, zoteroId } = firstExtraCitation;\n\n      formDataAfterDelete = {\n        ...updatedFormData,\n        ...{ footnote, footnoteTitle, zoteroId },\n        extra: [...updatedFormData.extra.slice(1)],\n      };\n    }\n    setUpdatedFormData(formDataAfterDelete);\n  };\n\n  const loadMoreButton = (\n    <Button primary loading={loadingMore} onClick={handleLoadMore}>\n      Load more\n    </Button>\n  );\n\n  return (\n    <div id=\"zotero-comp\">\n      <InlineForm\n        schema={props.schema}\n        title={props.title}\n        icon={<VoltoIcon size=\"24px\" name={briefcaseSVG} />}\n        updatedFormData={updatedFormData}\n        deleteItem={deleteItem}\n        headerActions={\n          <>\n            <button\n              onClick={(id, value) => {\n                props.submitHandler(updatedFormData);\n              }}\n            >\n              {!citationLoading ? (\n                <VoltoIcon size=\"24px\" name={checkSVG} />\n              ) : (\n                <Loader active inline size=\"small\" />\n              )}\n            </button>\n            <button onClick={props.clearHandler}>\n              <VoltoIcon size=\"24px\" name={clearSVG} />\n            </button>\n          </>\n        }\n      />\n      <MasterDetailWidget\n        pull={pull}\n        pushCollection={pushCollection}\n        pushItem={pushItem}\n        items={composedItems}\n        collections={collections}\n        loading={loading}\n        selectedCollection={selectedCollection}\n        onChangeSearchTerm={onChangeSearchTerm}\n        showSearchResults={showSearchResults}\n        allSearchResults={allSearchResults}\n        zoteroSearchResults={zoteroSearchResults}\n        openAireSearchResults={openAireSearchResults}\n        pushSearchItem={pushSearchItem}\n        showCollections={showCollections}\n        setActiveTabIndex={setActiveTabIndex}\n        openAireCallback={openAireCallback}\n        zoteroSearchItemsTotalResultsNumber={\n          zoteroSearchItemsTotalResultsNumber\n        }\n        openAireTotalResultsNumber={openAireTotalResultsNumber}\n      ></MasterDetailWidget>\n      {showSearchResults\n        ? allSearchResults.length < openAireTotalResultsNumber\n          ? loadMoreButton\n          : null\n        : topCollectionFlag\n        ? zoteroCollectionsTotalResultsNumber > collections.length\n          ? loadMoreButton\n          : null\n        : zoteroCollectionsTotalResultsNumber + zoteroItemsTotalResultsNumber >\n          composedItems.length\n        ? loadMoreButton\n        : null}\n    </div>\n  );\n};\n\nexport default ZoteroDataWrapper;\n"],"mappings":"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"},"metadata":{"react-intl":{"messages":[]}},"sourceType":"module","externalDependencies":[]}