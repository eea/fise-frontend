{"ast":null,"code":"import { getAPIResourceWithAuth } from '@plone/volto/helpers';\nconst HEADERS = ['content-type', 'content-disposition', 'cache-control'];\nfunction imageMiddleware(req, res, next) {\n  const {\n    errorHandler\n  } = req.app.locals;\n  getAPIResourceWithAuth(req).then(resource => {\n    // Just forward the headers that we need\n    HEADERS.forEach(header => {\n      if (resource.headers[header]) {\n        res.set(header, resource.headers[header]);\n      }\n    });\n    res.send(resource.body);\n  }, errorHandler).catch(errorHandler);\n}\nexport default function (express) {\n  const middleware = express.Router();\n  middleware.all(['**/image_[a-z]+$'], imageMiddleware);\n  middleware.id = 'depictionResourcesProcessor';\n  return middleware;\n}","map":{"version":3,"names":["getAPIResourceWithAuth","HEADERS","imageMiddleware","req","res","next","errorHandler","app","locals","then","resource","forEach","header","headers","set","send","body","catch","express","middleware","Router","all","id"],"sources":["/home/tooler/code/work/forests-frontend/node_modules/@eeacms/volto-depiction/src/middleware/images.js"],"sourcesContent":["import { getAPIResourceWithAuth } from '@plone/volto/helpers';\n\nconst HEADERS = ['content-type', 'content-disposition', 'cache-control'];\n\nfunction imageMiddleware(req, res, next) {\n  const { errorHandler } = req.app.locals;\n  getAPIResourceWithAuth(req)\n    .then((resource) => {\n      // Just forward the headers that we need\n      HEADERS.forEach((header) => {\n        if (resource.headers[header]) {\n          res.set(header, resource.headers[header]);\n        }\n      });\n\n      res.send(resource.body);\n    }, errorHandler)\n    .catch(errorHandler);\n}\n\nexport default function (express) {\n  const middleware = express.Router();\n\n  middleware.all(['**/image_[a-z]+$'], imageMiddleware);\n  middleware.id = 'depictionResourcesProcessor';\n  return middleware;\n}\n"],"mappings":"AAAA,SAASA,sBAAsB,QAAQ,sBAAsB;AAE7D,MAAMC,OAAO,GAAG,CAAC,cAAc,EAAE,qBAAqB,EAAE,eAAe,CAAC;AAExE,SAASC,eAAe,CAACC,GAAG,EAAEC,GAAG,EAAEC,IAAI,EAAE;EACvC,MAAM;IAAEC;EAAa,CAAC,GAAGH,GAAG,CAACI,GAAG,CAACC,MAAM;EACvCR,sBAAsB,CAACG,GAAG,CAAC,CACxBM,IAAI,CAAEC,QAAQ,IAAK;IAClB;IACAT,OAAO,CAACU,OAAO,CAAEC,MAAM,IAAK;MAC1B,IAAIF,QAAQ,CAACG,OAAO,CAACD,MAAM,CAAC,EAAE;QAC5BR,GAAG,CAACU,GAAG,CAACF,MAAM,EAAEF,QAAQ,CAACG,OAAO,CAACD,MAAM,CAAC,CAAC;MAC3C;IACF,CAAC,CAAC;IAEFR,GAAG,CAACW,IAAI,CAACL,QAAQ,CAACM,IAAI,CAAC;EACzB,CAAC,EAAEV,YAAY,CAAC,CACfW,KAAK,CAACX,YAAY,CAAC;AACxB;AAEA,eAAe,UAAUY,OAAO,EAAE;EAChC,MAAMC,UAAU,GAAGD,OAAO,CAACE,MAAM,EAAE;EAEnCD,UAAU,CAACE,GAAG,CAAC,CAAC,kBAAkB,CAAC,EAAEnB,eAAe,CAAC;EACrDiB,UAAU,CAACG,EAAE,GAAG,6BAA6B;EAC7C,OAAOH,UAAU;AACnB"},"metadata":{"react-intl":{"messages":[]}},"sourceType":"module","externalDependencies":[]}