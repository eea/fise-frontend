{"ast":null,"code":"import _isNil from \"lodash/isNil\";\nvar _jsxFileName = \"/home/tooler/code/work/forests-frontend/src/develop/volto-datablocks/src/Utils/DataConnectedValue/DataConnectedValue.jsx\";\nvar __jsx = React.createElement;\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nimport React from 'react';\nimport { compose } from 'redux';\nimport { connectToProviderData } from '@eeacms/volto-datablocks/hocs';\nimport { FormattedValue } from '../';\nimport './styles.css';\nconst EMPTY = '-';\nconst Placeholder = props => {\n  const placeholder = props.placeholder.trim();\n  const isComponent = React.useMemo(() => typeof props.placeholder === 'function', [props.placeholder]);\n  const PlaceholderElement = placeholder || EMPTY;\n  return isComponent ? __jsx(PlaceholderElement, _extends({}, props, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 24\n    }\n  })) : PlaceholderElement;\n};\nconst getRow = (row = 0) => {\n  if (typeof row === 'string' && row.includes('row-')) {\n    return (row.split('row-')[1] || 1) - 1;\n  }\n  return row;\n};\nconst getValue = (provider_data, column, row) => {\n  var _provider_data$column;\n  if (!column) return 'Select a column';\n  return provider_data === null || provider_data === void 0 ? void 0 : (_provider_data$column = provider_data[column]) === null || _provider_data$column === void 0 ? void 0 : _provider_data$column[getRow(row)];\n};\nconst DataConnectedValue = props => {\n  const [collapsed, setCollapsed] = React.useState(true);\n  const {\n    collapseLimit = null,\n    column,\n    provider_data = {},\n    row = 0,\n    specifier,\n    textTemplate,\n    animatedCounter\n  } = props;\n  const value = React.useMemo(() => getValue(provider_data, column, row), [provider_data, column, row]);\n  const collapsable = props.collapsable && (value === null || value === void 0 ? void 0 : value.length) > collapseLimit;\n  return !_isNil(value) ? __jsx(React.Fragment, null, __jsx(FormattedValue, {\n    textTemplate: textTemplate,\n    value: value,\n    animatedCounter: animatedCounter,\n    specifier: specifier,\n    collapsed: collapsable && collapsed,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }\n  }), collapsable && __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 9\n    }\n  }, __jsx(\"button\", {\n    className: \"readmore-button\",\n    onClick: () => {\n      setCollapsed(!collapsed);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 11\n    }\n  }, collapsed ? 'READ MORE' : 'COLLAPSE'))) : __jsx(Placeholder, _extends({}, props, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 5\n    }\n  }));\n};\nexport default compose(connectToProviderData(props => ({\n  provider_url: props.url\n})))(DataConnectedValue);","map":{"version":3,"names":["React","compose","connectToProviderData","FormattedValue","EMPTY","Placeholder","props","placeholder","trim","isComponent","useMemo","PlaceholderElement","getRow","row","includes","split","getValue","provider_data","column","DataConnectedValue","collapsed","setCollapsed","useState","collapseLimit","specifier","textTemplate","animatedCounter","value","collapsable","length","provider_url","url"],"sources":["/home/tooler/code/work/forests-frontend/src/develop/volto-datablocks/src/Utils/DataConnectedValue/DataConnectedValue.jsx"],"sourcesContent":["import React from 'react';\nimport { compose } from 'redux';\nimport { isNil } from 'lodash';\nimport { connectToProviderData } from '@eeacms/volto-datablocks/hocs';\n\nimport { FormattedValue } from '../';\nimport './styles.css';\n\nconst EMPTY = '-';\n\nconst Placeholder = (props) => {\n  const placeholder = props.placeholder.trim();\n  const isComponent = React.useMemo(\n    () => typeof props.placeholder === 'function',\n    [props.placeholder],\n  );\n\n  const PlaceholderElement = placeholder || EMPTY;\n\n  return isComponent ? <PlaceholderElement {...props} /> : PlaceholderElement;\n};\n\nconst getRow = (row = 0) => {\n  if (typeof row === 'string' && row.includes('row-')) {\n    return (row.split('row-')[1] || 1) - 1;\n  }\n  return row;\n};\n\nconst getValue = (provider_data, column, row) => {\n  if (!column) return 'Select a column';\n  return provider_data?.[column]?.[getRow(row)];\n};\n\nconst DataConnectedValue = (props) => {\n  const [collapsed, setCollapsed] = React.useState(true);\n  const {\n    collapseLimit = null,\n    column,\n    provider_data = {},\n    row = 0,\n    specifier,\n    textTemplate,\n    animatedCounter,\n  } = props;\n\n  const value = React.useMemo(() => getValue(provider_data, column, row), [\n    provider_data,\n    column,\n    row,\n  ]);\n\n  const collapsable = props.collapsable && value?.length > collapseLimit;\n\n  return !isNil(value) ? (\n    <>\n      <FormattedValue\n        textTemplate={textTemplate}\n        value={value}\n        animatedCounter={animatedCounter}\n        specifier={specifier}\n        collapsed={collapsable && collapsed}\n      />\n      {collapsable && (\n        <div>\n          <button\n            className=\"readmore-button\"\n            onClick={() => {\n              setCollapsed(!collapsed);\n            }}\n          >\n            {collapsed ? 'READ MORE' : 'COLLAPSE'}\n          </button>\n        </div>\n      )}\n    </>\n  ) : (\n    <Placeholder {...props} />\n  );\n};\n\nexport default compose(\n  connectToProviderData((props) => ({\n    provider_url: props.url,\n  })),\n)(DataConnectedValue);\n"],"mappings":"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"},"metadata":{"react-intl":{"messages":[]}},"sourceType":"module","externalDependencies":[]}