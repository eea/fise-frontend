{"ast":null,"code":"var _jsxFileName = \"/home/tooler/code/work/forests-frontend/src/develop/volto-datablocks/src/components/manage/Blocks/DataQueryFilter/View.jsx\";\nvar __jsx = React.createElement;\nimport React, { useEffect } from 'react';\nimport { connect } from 'react-redux';\nimport loadable from '@loadable/component';\nimport { Option, DropdownIndicator, selectTheme, customSelectStyles } from '@plone/volto/components/manage/Widgets/SelectStyling';\nimport { setConnectedDataParameters, deleteConnectedDataParameters } from '@eeacms/volto-datablocks/actions';\nconst Select = loadable({\n  resolved: {},\n  chunkName() {\n    return \"react-select\";\n  },\n  isReady(props) {\n    var key = this.resolve(props);\n    if (this.resolved[key] !== true) {\n      return false;\n    }\n    if (typeof __webpack_modules__ !== 'undefined') {\n      return !!__webpack_modules__[key];\n    }\n    return false;\n  },\n  importAsync: () => import( /* webpackChunkName: \"react-select\" */'react-select'),\n  requireAsync(props) {\n    var _this = this;\n    var key = this.resolve(props);\n    this.resolved[key] = false;\n    return this.importAsync(props).then(function (resolved) {\n      _this.resolved[key] = true;\n      return resolved;\n    });\n  },\n  requireSync(props) {\n    var id = this.resolve(props);\n    if (typeof __webpack_require__ !== 'undefined') {\n      return __webpack_require__(id);\n    }\n    return eval('module.require')(id);\n  },\n  resolve() {\n    if (require.resolveWeak) {\n      return require.resolveWeak(\"react-select\");\n    }\n    return eval('require.resolve')(\"react-select\");\n  }\n});\nconst View = props => {\n  var _props$data, _props$connected_data, _props$connected_data2, _props$connected_data3;\n  const {\n    data = {},\n    id\n  } = props;\n  const {\n    select_field,\n    options,\n    placeholder\n  } = data;\n  const provider_url = ((_props$data = props.data) === null || _props$data === void 0 ? void 0 : _props$data.provider_url) || '';\n  useEffect(() => {\n    return () => {\n      props.deleteConnectedDataParameters(provider_url, `${data['@type']}_${select_field}`);\n    };\n    /* eslint-disable-next-line */\n  }, []);\n  if (!provider_url && props.mode === 'edit') return __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 33,\n      columnNumber: 12\n    }\n  }, \"Select a provider from the sidebar\");\n  const value = ((_props$connected_data = props.connected_data_parameters.byProviderPath[provider_url]) === null || _props$connected_data === void 0 ? void 0 : (_props$connected_data2 = _props$connected_data[`${data['@type']}_${select_field}`]) === null || _props$connected_data2 === void 0 ? void 0 : (_props$connected_data3 = _props$connected_data2.v) === null || _props$connected_data3 === void 0 ? void 0 : _props$connected_data3[0]) || null;\n  return select_field ? __jsx(Select, {\n    id: `field-${id}`,\n    key: `select-i`,\n    name: id,\n    disabled: false,\n    className: \"react-select-container\",\n    classNamePrefix: \"react-select\",\n    options: [...(options || []), {\n      label: 'No value',\n      value: null\n    }],\n    styles: customSelectStyles,\n    theme: selectTheme,\n    components: {\n      DropdownIndicator,\n      Option\n    },\n    defaultValue: value,\n    onChange: ({\n      value\n    }) => {\n      if (value) {\n        props.setConnectedDataParameters(provider_url, {\n          i: select_field,\n          o: 'plone.app.querystring.operation.selection.any',\n          v: [value]\n        }, `${data['@type']}_${select_field}`);\n      } else {\n        props.deleteConnectedDataParameters(provider_url, `${data['@type']}_${select_field}`);\n      }\n    },\n    placeholder: placeholder,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 41,\n      columnNumber: 5\n    }\n  }) : 'Not configured yet';\n};\nexport default connect(state => {\n  return {\n    connected_data_parameters: state.connected_data_parameters\n  };\n}, {\n  setConnectedDataParameters,\n  deleteConnectedDataParameters\n})(View);","map":{"version":3,"names":["React","useEffect","connect","loadable","Option","DropdownIndicator","selectTheme","customSelectStyles","setConnectedDataParameters","deleteConnectedDataParameters","Select","View","props","data","id","select_field","options","placeholder","provider_url","mode","value","connected_data_parameters","byProviderPath","v","label","i","o","state"],"sources":["/home/tooler/code/work/forests-frontend/src/develop/volto-datablocks/src/components/manage/Blocks/DataQueryFilter/View.jsx"],"sourcesContent":["import React, { useEffect } from 'react';\nimport { connect } from 'react-redux';\nimport loadable from '@loadable/component';\nimport {\n  Option,\n  DropdownIndicator,\n  selectTheme,\n  customSelectStyles,\n} from '@plone/volto/components/manage/Widgets/SelectStyling';\nimport {\n  setConnectedDataParameters,\n  deleteConnectedDataParameters,\n} from '@eeacms/volto-datablocks/actions';\n\nconst Select = loadable(() => import('react-select'));\n\nconst View = (props) => {\n  const { data = {}, id } = props;\n  const { select_field, options, placeholder } = data;\n  const provider_url = props.data?.provider_url || '';\n\n  useEffect(() => {\n    return () => {\n      props.deleteConnectedDataParameters(\n        provider_url,\n        `${data['@type']}_${select_field}`,\n      );\n    };\n    /* eslint-disable-next-line */\n  }, []);\n\n  if (!provider_url && props.mode === 'edit')\n    return <div>Select a provider from the sidebar</div>;\n\n  const value =\n    props.connected_data_parameters.byProviderPath[provider_url]?.[\n      `${data['@type']}_${select_field}`\n    ]?.v?.[0] || null;\n\n  return select_field ? (\n    <Select\n      id={`field-${id}`}\n      key={`select-i`}\n      name={id}\n      disabled={false}\n      className=\"react-select-container\"\n      classNamePrefix=\"react-select\"\n      options={[\n        ...(options || []),\n        {\n          label: 'No value',\n          value: null,\n        },\n      ]}\n      styles={customSelectStyles}\n      theme={selectTheme}\n      components={{ DropdownIndicator, Option }}\n      defaultValue={value}\n      onChange={({ value }) => {\n        if (value) {\n          props.setConnectedDataParameters(\n            provider_url,\n            {\n              i: select_field,\n              o: 'plone.app.querystring.operation.selection.any',\n              v: [value],\n            },\n            `${data['@type']}_${select_field}`,\n          );\n        } else {\n          props.deleteConnectedDataParameters(\n            provider_url,\n            `${data['@type']}_${select_field}`,\n          );\n        }\n      }}\n      placeholder={placeholder}\n    />\n  ) : (\n    'Not configured yet'\n  );\n};\n\nexport default connect(\n  (state) => {\n    return {\n      connected_data_parameters: state.connected_data_parameters,\n    };\n  },\n  { setConnectedDataParameters, deleteConnectedDataParameters },\n)(View);\n"],"mappings":"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"},"metadata":{"react-intl":{"messages":[]}},"sourceType":"module","externalDependencies":[]}