{"ast":null,"code":"var _jsxFileName = \"/home/tooler/code/work/forests-frontend/node_modules/@plone/volto/src/components/manage/BlockChooser/BlockChooserButton.jsx\";\nvar __jsx = React.createElement;\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nimport React from 'react';\nimport { doesNodeContainClick } from 'semantic-ui-react/dist/commonjs/lib';\nimport addSVG from '@plone/volto/icons/circle-plus.svg';\nimport { blockHasValue } from '@plone/volto/helpers';\nimport { Icon, BlockChooser } from '@plone/volto/components';\nimport { Button } from 'semantic-ui-react';\nimport { defineMessages, useIntl } from 'react-intl';\nconst messages = defineMessages({\n  addBlock: {\n    \"id\": \"Add block\",\n    \"defaultMessage\": \"Add block\"\n  }\n});\nexport const ButtonComponent = props => {\n  const intl = useIntl();\n  const {\n    className = 'block-add-button',\n    size = '19px',\n    onShowBlockChooser\n  } = props;\n  return __jsx(Button, {\n    icon: true,\n    basic: true,\n    title: intl.formatMessage(messages.addBlock),\n    onClick: e => {\n      e.preventDefault();\n      e.stopPropagation();\n      onShowBlockChooser();\n    },\n    className: className,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 25,\n      columnNumber: 5\n    }\n  }, __jsx(Icon, {\n    name: addSVG,\n    className: className,\n    size: size,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 36,\n      columnNumber: 7\n    }\n  }));\n};\nconst BlockChooserButton = props => {\n  const {\n    block,\n    allowedBlocks,\n    showRestricted,\n    data,\n    onMutateBlock,\n    onInsertBlock,\n    blocksConfig,\n    buttonComponent,\n    properties\n  } = props;\n  const {\n    disableNewBlocks\n  } = data;\n  const [addNewBlockOpened, setAddNewBlockOpened] = React.useState(false);\n  const blockChooserRef = React.useRef();\n  const handleClickOutside = React.useCallback(e => {\n    if (blockChooserRef.current && doesNodeContainClick(blockChooserRef.current, e)) return;\n    setAddNewBlockOpened(false);\n  }, []);\n  const Component = buttonComponent || ButtonComponent;\n  React.useEffect(() => {\n    document.addEventListener('mousedown', handleClickOutside, false);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside, false);\n    };\n  }, [handleClickOutside]);\n  return __jsx(React.Fragment, null, !disableNewBlocks && !blockHasValue(data) && __jsx(Component, _extends({}, props, {\n    onShowBlockChooser: () => setAddNewBlockOpened(true),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 9\n    }\n  })), addNewBlockOpened && __jsx(BlockChooser, {\n    onMutateBlock: onMutateBlock ? (id, value) => {\n      setAddNewBlockOpened(false);\n      onMutateBlock(id, value);\n    } : null,\n    onInsertBlock: onInsertBlock ? (id, value) => {\n      setAddNewBlockOpened(false);\n      onInsertBlock(id, value);\n    } : null,\n    currentBlock: block,\n    allowedBlocks: allowedBlocks,\n    blocksConfig: blocksConfig,\n    properties: properties,\n    showRestricted: showRestricted,\n    ref: blockChooserRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 9\n    }\n  }));\n};\nexport default BlockChooserButton;","map":{"version":3,"names":["React","doesNodeContainClick","addSVG","blockHasValue","Icon","BlockChooser","Button","defineMessages","useIntl","messages","addBlock","ButtonComponent","props","intl","className","size","onShowBlockChooser","formatMessage","e","preventDefault","stopPropagation","BlockChooserButton","block","allowedBlocks","showRestricted","data","onMutateBlock","onInsertBlock","blocksConfig","buttonComponent","properties","disableNewBlocks","addNewBlockOpened","setAddNewBlockOpened","useState","blockChooserRef","useRef","handleClickOutside","useCallback","current","Component","useEffect","document","addEventListener","removeEventListener","id","value"],"sources":["/home/tooler/code/work/forests-frontend/node_modules/@plone/volto/src/components/manage/BlockChooser/BlockChooserButton.jsx"],"sourcesContent":["import React from 'react';\nimport { doesNodeContainClick } from 'semantic-ui-react/dist/commonjs/lib';\nimport addSVG from '@plone/volto/icons/circle-plus.svg';\nimport { blockHasValue } from '@plone/volto/helpers';\nimport { Icon, BlockChooser } from '@plone/volto/components';\nimport { Button } from 'semantic-ui-react';\nimport { defineMessages, useIntl } from 'react-intl';\n\nconst messages = defineMessages({\n  addBlock: {\n    id: 'Add block',\n    defaultMessage: 'Add block',\n  },\n});\n\nexport const ButtonComponent = (props) => {\n  const intl = useIntl();\n  const {\n    className = 'block-add-button',\n    size = '19px',\n    onShowBlockChooser,\n  } = props;\n\n  return (\n    <Button\n      icon\n      basic\n      title={intl.formatMessage(messages.addBlock)}\n      onClick={(e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        onShowBlockChooser();\n      }}\n      className={className}\n    >\n      <Icon name={addSVG} className={className} size={size} />\n    </Button>\n  );\n};\n\nconst BlockChooserButton = (props) => {\n  const {\n    block,\n    allowedBlocks,\n    showRestricted,\n    data,\n    onMutateBlock,\n    onInsertBlock,\n    blocksConfig,\n    buttonComponent,\n    properties,\n  } = props;\n  const { disableNewBlocks } = data;\n  const [addNewBlockOpened, setAddNewBlockOpened] = React.useState(false);\n\n  const blockChooserRef = React.useRef();\n\n  const handleClickOutside = React.useCallback((e) => {\n    if (\n      blockChooserRef.current &&\n      doesNodeContainClick(blockChooserRef.current, e)\n    )\n      return;\n    setAddNewBlockOpened(false);\n  }, []);\n\n  const Component = buttonComponent || ButtonComponent;\n\n  React.useEffect(() => {\n    document.addEventListener('mousedown', handleClickOutside, false);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside, false);\n    };\n  }, [handleClickOutside]);\n\n  return (\n    <>\n      {!disableNewBlocks && !blockHasValue(data) && (\n        <Component\n          {...props}\n          onShowBlockChooser={() => setAddNewBlockOpened(true)}\n        />\n      )}\n      {addNewBlockOpened && (\n        <BlockChooser\n          onMutateBlock={\n            onMutateBlock\n              ? (id, value) => {\n                  setAddNewBlockOpened(false);\n                  onMutateBlock(id, value);\n                }\n              : null\n          }\n          onInsertBlock={\n            onInsertBlock\n              ? (id, value) => {\n                  setAddNewBlockOpened(false);\n                  onInsertBlock(id, value);\n                }\n              : null\n          }\n          currentBlock={block}\n          allowedBlocks={allowedBlocks}\n          blocksConfig={blocksConfig}\n          properties={properties}\n          showRestricted={showRestricted}\n          ref={blockChooserRef}\n        />\n      )}\n    </>\n  );\n};\n\nexport default BlockChooserButton;\n"],"mappings":"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"},"metadata":{"react-intl":{"messages":[{"id":"Add block","defaultMessage":"Add block"}]}},"sourceType":"module","externalDependencies":[]}