{"ast":null,"code":"import _extends from \"/home/tooler/code/work/forests-frontend/node_modules/@babel/runtime/helpers/esm/extends.js\";\nimport _toConsumableArray from \"/home/tooler/code/work/forests-frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _defineProperty from \"/home/tooler/code/work/forests-frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport _slicedToArray from \"/home/tooler/code/work/forests-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _objectSpread from \"/home/tooler/code/work/forests-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _without from \"lodash/without\";\nimport _omit from \"lodash/omit\";\nvar _jsxFileName = \"/home/tooler/code/work/forests-frontend/src/develop/volto-accordion-block/src/components/manage/Widgets/PanelsWidget.jsx\",\n  _this = this,\n  _s = $RefreshSig$();\nvar __jsx = React.createElement;\nimport React from 'react';\nimport { v4 as uuid } from 'uuid';\nimport move from 'lodash-move';\nimport { useIntl, defineMessages } from 'react-intl';\nimport { Button } from 'semantic-ui-react';\nimport { Icon, FormFieldWrapper } from '@plone/volto/components';\nimport { DragDropList } from '@plone/volto/components';\nimport { emptyBlocksForm } from '@plone/volto/helpers';\nimport addSVG from '@plone/volto/icons/add.svg';\nimport dragSVG from '@plone/volto/icons/drag.svg';\nimport trashSVG from '@plone/volto/icons/delete.svg';\nimport './editor.less';\nvar messages = defineMessages({\n  add: {\n    \"id\": \"Add\",\n    \"defaultMessage\": \"Add\"\n  }\n});\nexport function moveItem(formData, source, destination) {\n  var _formData$blocks_layo;\n  return _objectSpread(_objectSpread({}, formData), {}, {\n    blocks_layout: {\n      items: move((_formData$blocks_layo = formData.blocks_layout) === null || _formData$blocks_layo === void 0 ? void 0 : _formData$blocks_layo.items, source, destination)\n    }\n  });\n}\nvar empty = function empty() {\n  return [uuid(), emptyBlocksForm()];\n};\nvar PanelsWidget = function PanelsWidget(props) {\n  _s();\n  var _value$blocks_layout;\n  var intl = useIntl();\n  var fieldSet = props.fieldSet,\n    _props$value = props.value,\n    value = _props$value === void 0 ? {} : _props$value,\n    id = props.id,\n    onChange = props.onChange,\n    schema = props.schema;\n  var _value$blocks = value.blocks,\n    blocks = _value$blocks === void 0 ? {} : _value$blocks;\n  var itemsList = (((_value$blocks_layout = value.blocks_layout) === null || _value$blocks_layout === void 0 ? void 0 : _value$blocks_layout.items) || []).map(function (id) {\n    return [id, blocks[id]];\n  });\n  var objectSchema = typeof schema === 'function' ? schema(props) : schema;\n  return __jsx(\"div\", {\n    className: \"panels-widget\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 5\n    }\n  }, __jsx(FormFieldWrapper, _extends({}, props, {\n    noForInFieldLabel: true,\n    draggable: false,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 7\n    }\n  }), __jsx(\"div\", {\n    className: \"add-item-button-wrapper\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 9\n    }\n  }, __jsx(Button, {\n    compact: true,\n    icon: true,\n    \"aria-label\": objectSchema.addMessage || \"\".concat(intl.formatMessage(messages.add), \" \").concat(objectSchema.title),\n    onClick: function onClick() {\n      var _value$blocks_layout2;\n      var _empty = empty(),\n        _empty2 = _slicedToArray(_empty, 2),\n        newId = _empty2[0],\n        newData = _empty2[1];\n      onChange(id, _objectSpread(_objectSpread({}, value), {}, {\n        blocks: _objectSpread(_objectSpread({}, value.blocks), {}, _defineProperty({}, newId, newData)),\n        blocks_layout: _objectSpread(_objectSpread({}, value.blocks_layout), {}, {\n          items: [].concat(_toConsumableArray((_value$blocks_layout2 = value.blocks_layout) === null || _value$blocks_layout2 === void 0 ? void 0 : _value$blocks_layout2.items), [newId])\n        })\n      }));\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 11\n    }\n  }, __jsx(Icon, {\n    name: addSVG,\n    size: \"18px\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 13\n    }\n  }), \"\\xA0\", objectSchema.addMessage || \"Add \".concat(objectSchema.title)))), __jsx(\"div\", {\n    className: \"items-area\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 7\n    }\n  }, __jsx(DragDropList, {\n    forwardedAriaLabelledBy: \"fieldset-\".concat(fieldSet || 'default', \"-field-label-\").concat(id),\n    childList: itemsList,\n    onMoveItem: function onMoveItem(result) {\n      var source = result.source,\n        destination = result.destination;\n      if (!destination) {\n        return;\n      }\n      var newFormData = moveItem(value, source.index, destination.index);\n      onChange(id, newFormData);\n      return true;\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 9\n    }\n  }, function (dragProps) {\n    var _value$blocks_layout3, _value$blocks_layout4;\n    var child = dragProps.child,\n      childId = dragProps.childId,\n      index = dragProps.index,\n      draginfo = dragProps.draginfo;\n    return __jsx(\"div\", _extends({\n      ref: draginfo.innerRef\n    }, draginfo.draggableProps, {\n      key: childId,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 15\n      }\n    }), __jsx(\"div\", {\n      className: \"panel-item\",\n      style: {\n        position: 'relative'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 17\n      }\n    }, __jsx(\"button\", _extends({\n      style: {\n        visibility: 'visible',\n        display: 'inline-block'\n      }\n    }, draginfo.dragHandleProps, {\n      className: \"drag handle\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 19\n      }\n    }), __jsx(Icon, {\n      name: dragSVG,\n      size: \"18px\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 21\n      }\n    })), __jsx(\"div\", {\n      className: \"label\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 19\n      }\n    }, child.title || \"Panel \".concat(index + 1)), ((_value$blocks_layout3 = value.blocks_layout) === null || _value$blocks_layout3 === void 0 ? void 0 : (_value$blocks_layout4 = _value$blocks_layout3.items) === null || _value$blocks_layout4 === void 0 ? void 0 : _value$blocks_layout4.length) > 1 ? __jsx(\"button\", {\n      onClick: function onClick() {\n        var _value$blocks_layout5;\n        var newFormData = _objectSpread(_objectSpread({}, value), {}, {\n          blocks: _omit(_objectSpread({}, value.blocks), [childId]),\n          blocks_layout: _objectSpread(_objectSpread({}, value.blocks_layout), {}, {\n            items: _without(_toConsumableArray((_value$blocks_layout5 = value.blocks_layout) === null || _value$blocks_layout5 === void 0 ? void 0 : _value$blocks_layout5.items), childId)\n          })\n        });\n        onChange(id, newFormData);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 21\n      }\n    }, __jsx(Icon, {\n      name: trashSVG,\n      size: \"18px\",\n      color: \"#e40166\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 23\n      }\n    })) : ''));\n  })));\n};\n_s(PanelsWidget, \"rlSgSjbewJ1PrR/Ile8g/kr050o=\", false, function () {\n  return [useIntl];\n});\n_c = PanelsWidget;\nexport default PanelsWidget;\nvar _c;\n$RefreshReg$(_c, \"PanelsWidget\");","map":{"version":3,"names":["React","v4","uuid","move","useIntl","defineMessages","Button","Icon","FormFieldWrapper","DragDropList","emptyBlocksForm","addSVG","dragSVG","trashSVG","messages","add","moveItem","formData","source","destination","blocks_layout","items","empty","PanelsWidget","props","intl","fieldSet","value","id","onChange","schema","blocks","itemsList","map","objectSchema","addMessage","formatMessage","title","newId","newData","result","newFormData","index","dragProps","child","childId","draginfo","innerRef","draggableProps","position","visibility","display","dragHandleProps","length"],"sources":["/home/tooler/code/work/forests-frontend/src/develop/volto-accordion-block/src/components/manage/Widgets/PanelsWidget.jsx"],"sourcesContent":["import React from 'react';\nimport { v4 as uuid } from 'uuid';\nimport { omit, without } from 'lodash';\nimport move from 'lodash-move';\nimport { useIntl, defineMessages } from 'react-intl';\nimport { Button } from 'semantic-ui-react';\nimport { Icon, FormFieldWrapper } from '@plone/volto/components';\nimport { DragDropList } from '@plone/volto/components';\nimport { emptyBlocksForm } from '@plone/volto/helpers';\n\nimport addSVG from '@plone/volto/icons/add.svg';\nimport dragSVG from '@plone/volto/icons/drag.svg';\nimport trashSVG from '@plone/volto/icons/delete.svg';\n\nimport './editor.less';\n\nconst messages = defineMessages({\n  add: { id: 'Add', defaultMessage: 'Add' },\n});\n\nexport function moveItem(formData, source, destination) {\n  return {\n    ...formData,\n    blocks_layout: {\n      items: move(formData.blocks_layout?.items, source, destination),\n    },\n  };\n}\n\nconst empty = () => {\n  return [uuid(), emptyBlocksForm()];\n};\n\nconst PanelsWidget = (props) => {\n  const intl = useIntl();\n  const { fieldSet, value = {}, id, onChange, schema } = props;\n  const { blocks = {} } = value;\n  const itemsList = (value.blocks_layout?.items || []).map((id) => [\n    id,\n    blocks[id],\n  ]);\n\n  const objectSchema = typeof schema === 'function' ? schema(props) : schema;\n\n  return (\n    <div className=\"panels-widget\">\n      <FormFieldWrapper {...props} noForInFieldLabel draggable={false}>\n        <div className=\"add-item-button-wrapper\">\n          <Button\n            compact\n            icon\n            aria-label={\n              objectSchema.addMessage ||\n              `${intl.formatMessage(messages.add)} ${objectSchema.title}`\n            }\n            onClick={() => {\n              const [newId, newData] = empty();\n              onChange(id, {\n                ...value,\n                blocks: {\n                  ...value.blocks,\n                  [newId]: newData,\n                },\n                blocks_layout: {\n                  ...value.blocks_layout,\n                  items: [...value.blocks_layout?.items, newId],\n                },\n              });\n            }}\n          >\n            <Icon name={addSVG} size=\"18px\" />\n            &nbsp;\n            {/* Custom addMessage in schema, else default to english */}\n            {objectSchema.addMessage || `Add ${objectSchema.title}`}\n          </Button>\n        </div>\n      </FormFieldWrapper>\n      <div className=\"items-area\">\n        <DragDropList\n          forwardedAriaLabelledBy={`fieldset-${\n            fieldSet || 'default'\n          }-field-label-${id}`}\n          childList={itemsList}\n          onMoveItem={(result) => {\n            const { source, destination } = result;\n            if (!destination) {\n              return;\n            }\n            const newFormData = moveItem(\n              value,\n              source.index,\n              destination.index,\n            );\n            onChange(id, newFormData);\n            return true;\n          }}\n        >\n          {(dragProps) => {\n            const { child, childId, index, draginfo } = dragProps;\n            return (\n              <div\n                ref={draginfo.innerRef}\n                {...draginfo.draggableProps}\n                key={childId}\n              >\n                <div className=\"panel-item\" style={{ position: 'relative' }}>\n                  <button\n                    style={{\n                      visibility: 'visible',\n                      display: 'inline-block',\n                    }}\n                    {...draginfo.dragHandleProps}\n                    className=\"drag handle\"\n                  >\n                    <Icon name={dragSVG} size=\"18px\" />\n                  </button>\n                  <div className=\"label\">\n                    {child.title || `Panel ${index + 1}`}\n                  </div>\n                  {value.blocks_layout?.items?.length > 1 ? (\n                    <button\n                      onClick={() => {\n                        const newFormData = {\n                          ...value,\n                          blocks: omit({ ...value.blocks }, [childId]),\n                          blocks_layout: {\n                            ...value.blocks_layout,\n                            items: without(\n                              [...value.blocks_layout?.items],\n                              childId,\n                            ),\n                          },\n                        };\n                        onChange(id, newFormData);\n                      }}\n                    >\n                      <Icon name={trashSVG} size=\"18px\" color=\"#e40166\" />\n                    </button>\n                  ) : (\n                    ''\n                  )}\n                </div>\n              </div>\n            );\n          }}\n        </DragDropList>\n      </div>\n    </div>\n  );\n};\n\nexport default PanelsWidget;\n"],"mappings":"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"},"metadata":{"react-intl":{"messages":[{"id":"Add","defaultMessage":"Add"}]}},"sourceType":"module","externalDependencies":[]}