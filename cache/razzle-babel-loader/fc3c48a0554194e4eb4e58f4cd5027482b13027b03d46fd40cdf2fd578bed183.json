{"ast":null,"code":"import _objectSpread from \"/home/tooler/code/work/forests-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport { GET_QUERYSTRING_RESULTS } from '@plone/volto/constants/ActionTypes';\nimport config from '@plone/volto/registry';\n\n/**\n * Get querystring results.\n * @function getQueryStringResults\n * @param {Object} data Data.\n * @returns {Object} Get querystringsearch results action.\n */\nexport function getQueryStringResults(path, data, subrequest, page) {\n  var settings = config.settings;\n\n  // fixes https://github.com/plone/volto/issues/1059\n  var requestData = JSON.parse(JSON.stringify(data));\n  if ((data === null || data === void 0 ? void 0 : data.depth) != null) {\n    delete requestData.depth;\n    requestData.query.forEach(function (q) {\n      if (q.i === 'path') {\n        q.v += '::' + data.depth;\n      }\n    });\n  }\n\n  // fixes https://github.com/plone/volto/issues/2397\n  if ((requestData === null || requestData === void 0 ? void 0 : requestData.sort_order) !== null) {\n    if (typeof requestData.sort_order === 'boolean') {\n      requestData.sort_order = requestData.sort_order ? 'descending' : 'ascending';\n    }\n  }\n  return {\n    type: GET_QUERYSTRING_RESULTS,\n    subrequest: subrequest,\n    request: {\n      op: 'post',\n      path: \"\".concat(path, \"/@querystring-search\"),\n      data: _objectSpread(_objectSpread(_objectSpread(_objectSpread({}, requestData), !requestData.b_size && {\n        b_size: settings.defaultPageSize\n      }), page && {\n        b_start: requestData.b_size ? data.b_size * (page - 1) : settings.defaultPageSize * (page - 1)\n      }), {}, {\n        query: requestData === null || requestData === void 0 ? void 0 : requestData.query\n      })\n    }\n  };\n}","map":{"version":3,"names":["GET_QUERYSTRING_RESULTS","config","getQueryStringResults","path","data","subrequest","page","settings","requestData","JSON","parse","stringify","depth","query","forEach","q","i","v","sort_order","type","request","op","b_size","defaultPageSize","b_start"],"sources":["/home/tooler/code/work/forests-frontend/node_modules/@plone/volto/src/actions/querystringsearch/querystringsearch.js"],"sourcesContent":["import { GET_QUERYSTRING_RESULTS } from '@plone/volto/constants/ActionTypes';\nimport config from '@plone/volto/registry';\n\n/**\n * Get querystring results.\n * @function getQueryStringResults\n * @param {Object} data Data.\n * @returns {Object} Get querystringsearch results action.\n */\nexport function getQueryStringResults(path, data, subrequest, page) {\n  const { settings } = config;\n\n  // fixes https://github.com/plone/volto/issues/1059\n  let requestData = JSON.parse(JSON.stringify(data));\n\n  if (data?.depth != null) {\n    delete requestData.depth;\n    requestData.query.forEach((q) => {\n      if (q.i === 'path') {\n        q.v += '::' + data.depth;\n      }\n    });\n  }\n\n  // fixes https://github.com/plone/volto/issues/2397\n  if (requestData?.sort_order !== null) {\n    if (typeof requestData.sort_order === 'boolean') {\n      requestData.sort_order = requestData.sort_order\n        ? 'descending'\n        : 'ascending';\n    }\n  }\n\n  return {\n    type: GET_QUERYSTRING_RESULTS,\n    subrequest,\n    request: {\n      op: 'post',\n      path: `${path}/@querystring-search`,\n      data: {\n        ...requestData,\n        ...(!requestData.b_size && {\n          b_size: settings.defaultPageSize,\n        }),\n        ...(page && {\n          b_start: requestData.b_size\n            ? data.b_size * (page - 1)\n            : settings.defaultPageSize * (page - 1),\n        }),\n        query: requestData?.query,\n      },\n    },\n  };\n}\n"],"mappings":";AAAA,SAASA,uBAAuB,QAAQ,oCAAoC;AAC5E,OAAOC,MAAM,MAAM,uBAAuB;;AAE1C;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,qBAAqB,CAACC,IAAI,EAAEC,IAAI,EAAEC,UAAU,EAAEC,IAAI,EAAE;EAClE,IAAQC,QAAQ,GAAKN,MAAM,CAAnBM,QAAQ;;EAEhB;EACA,IAAIC,WAAW,GAAGC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,SAAS,CAACP,IAAI,CAAC,CAAC;EAElD,IAAI,CAAAA,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEQ,KAAK,KAAI,IAAI,EAAE;IACvB,OAAOJ,WAAW,CAACI,KAAK;IACxBJ,WAAW,CAACK,KAAK,CAACC,OAAO,CAAC,UAACC,CAAC,EAAK;MAC/B,IAAIA,CAAC,CAACC,CAAC,KAAK,MAAM,EAAE;QAClBD,CAAC,CAACE,CAAC,IAAI,IAAI,GAAGb,IAAI,CAACQ,KAAK;MAC1B;IACF,CAAC,CAAC;EACJ;;EAEA;EACA,IAAI,CAAAJ,WAAW,aAAXA,WAAW,uBAAXA,WAAW,CAAEU,UAAU,MAAK,IAAI,EAAE;IACpC,IAAI,OAAOV,WAAW,CAACU,UAAU,KAAK,SAAS,EAAE;MAC/CV,WAAW,CAACU,UAAU,GAAGV,WAAW,CAACU,UAAU,GAC3C,YAAY,GACZ,WAAW;IACjB;EACF;EAEA,OAAO;IACLC,IAAI,EAAEnB,uBAAuB;IAC7BK,UAAU,EAAVA,UAAU;IACVe,OAAO,EAAE;MACPC,EAAE,EAAE,MAAM;MACVlB,IAAI,YAAKA,IAAI,yBAAsB;MACnCC,IAAI,8DACCI,WAAW,GACV,CAACA,WAAW,CAACc,MAAM,IAAI;QACzBA,MAAM,EAAEf,QAAQ,CAACgB;MACnB,CAAC,GACGjB,IAAI,IAAI;QACVkB,OAAO,EAAEhB,WAAW,CAACc,MAAM,GACvBlB,IAAI,CAACkB,MAAM,IAAIhB,IAAI,GAAG,CAAC,CAAC,GACxBC,QAAQ,CAACgB,eAAe,IAAIjB,IAAI,GAAG,CAAC;MAC1C,CAAC;QACDO,KAAK,EAAEL,WAAW,aAAXA,WAAW,uBAAXA,WAAW,CAAEK;MAAK;IAE7B;EACF,CAAC;AACH"},"metadata":{"react-intl":{"messages":[]}},"sourceType":"module","externalDependencies":[]}