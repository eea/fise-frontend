{"ast":null,"code":"import _extends from \"/home/tooler/code/work/forests-frontend/node_modules/@babel/runtime/helpers/esm/extends.js\";\nimport _toConsumableArray from \"/home/tooler/code/work/forests-frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _objectSpread from \"/home/tooler/code/work/forests-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nvar _jsxFileName = \"/home/tooler/code/work/forests-frontend/node_modules/@plone/volto/packages/volto-slate/src/blocks/Text/index.js\",\n  _this = this;\nvar __jsx = React.createElement;\nimport React from 'react';\nimport redraft from 'redraft';\nimport TextBlockView from './TextBlockView';\nimport TextBlockEdit from './TextBlockEdit';\nimport TextBlockSchema from './TextBlockSchema';\nimport { goDown, goUp, backspaceInList, indentListItems, joinWithNextBlock, joinWithPreviousBlock, softBreak, moveListItemDown, moveListItemUp, traverseBlocks, unwrapEmptyString, slashMenu, cancelEsc } from './keyboard';\nimport { withDeleteSelectionOnEnter } from '@plone/volto-slate/editor/extensions';\nimport { breakList, withDeserializers, withLists, withSplitBlocksOnBreak, withIsSelected } from './extensions';\nimport { extractImages } from '@plone/volto-slate/editor/plugins/Image/deconstruct';\nimport { extractTables } from '@plone/volto-slate/blocks/Table/deconstruct';\nimport textSVG from '@plone/volto/icons/subtext.svg';\nexport { TextBlockView, TextBlockEdit, TextBlockSchema };\nexport default (function (config) {\n  config.settings.slate = _objectSpread({\n    // TODO: should we inverse order? First here gets executed last\n    textblockExtensions: [withLists, withSplitBlocksOnBreak,\n    // TODO: do we still need this one?\n    withDeleteSelectionOnEnter, withDeserializers, withIsSelected, breakList],\n    // Pluggable handlers for the onKeyDown event of <Editable />\n    // Order matters here. A handler can return `true` to stop executing any\n    // following handler\n    textblockKeyboardHandlers: {\n      Backspace: [unwrapEmptyString, backspaceInList,\n      // Backspace in list item lifts node and breaks Volto blocks\n      joinWithPreviousBlock // Backspace at beginning of block joins with previous block\n      ],\n\n      Delete: [unwrapEmptyString, joinWithNextBlock // Delete at end of block joins with next block\n      ],\n\n      Enter: [slashMenu, unwrapEmptyString, softBreak // Handles shift+Enter as a newline (<br/>)\n      ],\n\n      ArrowUp: [slashMenu, moveListItemUp,\n      // Move up a list with with Ctrl+up\n      goUp // Select previous block\n      ],\n\n      ArrowDown: [slashMenu, moveListItemDown,\n      // Move down a list item with Ctrl+down\n      goDown // Select next block\n      ],\n\n      Tab: [indentListItems,\n      // <tab> and <c-tab> behaviour for list items\n      traverseBlocks],\n      Escape: [cancelEsc]\n    },\n    textblockDetachedKeyboardHandlers: {\n      Enter: [softBreak // Handles shift+Enter as a newline (<br/>)\n      ]\n    },\n\n    // Used by deconstructToVoltoBlocks to transform tags such as <img> to a Volto image block\n    // These emiters receive (editor, pathRef), emit [blockid, blockoptions] and\n    // are allowed to change the editor contents (for the given path)\n    voltoBlockEmiters: [].concat(_toConsumableArray(config.settings.slate.voltoBlockEmiters || []), [extractImages, extractTables]),\n    // These elements will get an id, to make them targets in TOC\n    topLevelTargetElements: ['h1', 'h2', 'h3', 'h4', 'h5', 'h6']\n  }, config.settings.slate);\n  config.settings.integratesBlockStyles = [].concat(_toConsumableArray(config.settings.integratesBlockStyles || []), ['slate']);\n  var slateBlockConfig = {\n    id: 'slate',\n    title: 'Text',\n    icon: textSVG,\n    group: 'text',\n    view: TextBlockView,\n    edit: TextBlockEdit,\n    schema: TextBlockSchema,\n    restricted: false,\n    mostUsed: false,\n    blockHasOwnFocusManagement: true,\n    sidebarTab: 0,\n    security: {\n      addPermission: [],\n      view: []\n    },\n    blockHasValue: function blockHasValue(data) {\n      var _data$plaintext;\n      // TODO: this should be handled better\n      return data && !!((_data$plaintext = data.plaintext) !== null && _data$plaintext !== void 0 && _data$plaintext.trim());\n    },\n    tocEntry: function tocEntry() {\n      var _value$;\n      var block = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var value = block.value,\n        override_toc = block.override_toc,\n        entry_text = block.entry_text,\n        level = block.level,\n        plaintext = block.plaintext;\n      var type = value === null || value === void 0 ? void 0 : (_value$ = value[0]) === null || _value$ === void 0 ? void 0 : _value$.type;\n      return override_toc && level ? [parseInt(level.slice(1)), entry_text] : config.settings.slate.topLevelTargetElements.includes(type) ? [parseInt(type.slice(1)), plaintext] : null;\n    }\n  };\n\n  // Make draft js compatible with ToC\n  config.blocks.blocksConfig.text = _objectSpread(_objectSpread({}, config.blocks.blocksConfig.text), {}, {\n    restricted: true,\n    tocEntry: function tocEntry() {\n      var _draft$, _draft$$;\n      var block = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var draft = redraft(block.text, config.settings.richtextViewSettings.ToHTMLRenderers, config.settings.richtextViewSettings.ToHTMLOptions);\n      var type = draft === null || draft === void 0 ? void 0 : (_draft$ = draft[0]) === null || _draft$ === void 0 ? void 0 : (_draft$$ = _draft$[0]) === null || _draft$$ === void 0 ? void 0 : _draft$$.type;\n      return config.settings.slate.topLevelTargetElements.includes(type) ? [parseInt(type.slice(1)), block.text.blocks[0].text] : null;\n    }\n  });\n  config.blocks.blocksConfig.slate = slateBlockConfig;\n  config.blocks.blocksConfig.detachedSlate = _objectSpread(_objectSpread({}, config.blocks.blocksConfig.slate), {}, {\n    id: 'detachedSlate',\n    title: 'Detached Slate',\n    edit: function edit(props) {\n      return __jsx(TextBlockEdit, _extends({}, props, {\n        detached: true,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 22\n        }\n      }));\n    },\n    restricted: true\n  });\n  return config;\n});","map":{"version":3,"names":["React","redraft","TextBlockView","TextBlockEdit","TextBlockSchema","goDown","goUp","backspaceInList","indentListItems","joinWithNextBlock","joinWithPreviousBlock","softBreak","moveListItemDown","moveListItemUp","traverseBlocks","unwrapEmptyString","slashMenu","cancelEsc","withDeleteSelectionOnEnter","breakList","withDeserializers","withLists","withSplitBlocksOnBreak","withIsSelected","extractImages","extractTables","textSVG","config","settings","slate","textblockExtensions","textblockKeyboardHandlers","Backspace","Delete","Enter","ArrowUp","ArrowDown","Tab","Escape","textblockDetachedKeyboardHandlers","voltoBlockEmiters","topLevelTargetElements","integratesBlockStyles","slateBlockConfig","id","title","icon","group","view","edit","schema","restricted","mostUsed","blockHasOwnFocusManagement","sidebarTab","security","addPermission","blockHasValue","data","plaintext","trim","tocEntry","block","value","override_toc","entry_text","level","type","parseInt","slice","includes","blocks","blocksConfig","text","draft","richtextViewSettings","ToHTMLRenderers","ToHTMLOptions","detachedSlate","props"],"sources":["/home/tooler/code/work/forests-frontend/node_modules/@plone/volto/packages/volto-slate/src/blocks/Text/index.js"],"sourcesContent":["import React from 'react';\nimport redraft from 'redraft';\nimport TextBlockView from './TextBlockView';\nimport TextBlockEdit from './TextBlockEdit';\nimport TextBlockSchema from './TextBlockSchema';\n\nimport {\n  goDown,\n  goUp,\n  backspaceInList,\n  indentListItems,\n  joinWithNextBlock,\n  joinWithPreviousBlock,\n  softBreak,\n  moveListItemDown,\n  moveListItemUp,\n  traverseBlocks,\n  unwrapEmptyString,\n  slashMenu,\n  cancelEsc,\n} from './keyboard';\nimport { withDeleteSelectionOnEnter } from '@plone/volto-slate/editor/extensions';\nimport {\n  breakList,\n  withDeserializers,\n  withLists,\n  withSplitBlocksOnBreak,\n  withIsSelected,\n} from './extensions';\nimport { extractImages } from '@plone/volto-slate/editor/plugins/Image/deconstruct';\nimport { extractTables } from '@plone/volto-slate/blocks/Table/deconstruct';\n\nimport textSVG from '@plone/volto/icons/subtext.svg';\n\nexport { TextBlockView, TextBlockEdit, TextBlockSchema };\n\nexport default (config) => {\n  config.settings.slate = {\n    // TODO: should we inverse order? First here gets executed last\n    textblockExtensions: [\n      withLists,\n      withSplitBlocksOnBreak, // TODO: do we still need this one?\n      withDeleteSelectionOnEnter,\n      withDeserializers,\n      withIsSelected,\n      breakList,\n    ],\n\n    // Pluggable handlers for the onKeyDown event of <Editable />\n    // Order matters here. A handler can return `true` to stop executing any\n    // following handler\n    textblockKeyboardHandlers: {\n      Backspace: [\n        unwrapEmptyString,\n        backspaceInList, // Backspace in list item lifts node and breaks Volto blocks\n        joinWithPreviousBlock, // Backspace at beginning of block joins with previous block\n      ],\n      Delete: [\n        unwrapEmptyString,\n        joinWithNextBlock, // Delete at end of block joins with next block\n      ],\n      Enter: [\n        slashMenu,\n        unwrapEmptyString,\n        softBreak, // Handles shift+Enter as a newline (<br/>)\n      ],\n      ArrowUp: [\n        slashMenu,\n        moveListItemUp, // Move up a list with with Ctrl+up\n        goUp, // Select previous block\n      ],\n      ArrowDown: [\n        slashMenu,\n        moveListItemDown, // Move down a list item with Ctrl+down\n        goDown, // Select next block\n      ],\n      Tab: [\n        indentListItems, // <tab> and <c-tab> behaviour for list items\n        traverseBlocks,\n      ],\n      Escape: [cancelEsc],\n    },\n    textblockDetachedKeyboardHandlers: {\n      Enter: [\n        softBreak, // Handles shift+Enter as a newline (<br/>)\n      ],\n    },\n    // Used by deconstructToVoltoBlocks to transform tags such as <img> to a Volto image block\n    // These emiters receive (editor, pathRef), emit [blockid, blockoptions] and\n    // are allowed to change the editor contents (for the given path)\n    voltoBlockEmiters: [\n      ...(config.settings.slate.voltoBlockEmiters || []),\n      extractImages,\n      extractTables,\n    ],\n\n    // These elements will get an id, to make them targets in TOC\n    topLevelTargetElements: ['h1', 'h2', 'h3', 'h4', 'h5', 'h6'],\n\n    ...config.settings.slate, // TODO: is this correct for volto-slate addons?\n  };\n\n  config.settings.integratesBlockStyles = [\n    ...(config.settings.integratesBlockStyles || []),\n    'slate',\n  ];\n\n  const slateBlockConfig = {\n    id: 'slate',\n    title: 'Text',\n    icon: textSVG,\n    group: 'text',\n    view: TextBlockView,\n    edit: TextBlockEdit,\n    schema: TextBlockSchema,\n    restricted: false,\n    mostUsed: false,\n    blockHasOwnFocusManagement: true,\n    sidebarTab: 0,\n    security: {\n      addPermission: [],\n      view: [],\n    },\n    blockHasValue: (data) => {\n      // TODO: this should be handled better\n      return data && !!data.plaintext?.trim();\n    },\n    tocEntry: (block = {}) => {\n      const { value, override_toc, entry_text, level, plaintext } = block;\n      const type = value?.[0]?.type;\n      return override_toc && level\n        ? [parseInt(level.slice(1)), entry_text]\n        : config.settings.slate.topLevelTargetElements.includes(type)\n        ? [parseInt(type.slice(1)), plaintext]\n        : null;\n    },\n  };\n\n  // Make draft js compatible with ToC\n  config.blocks.blocksConfig.text = {\n    ...config.blocks.blocksConfig.text,\n    restricted: true,\n    tocEntry: (block = {}) => {\n      const draft = redraft(\n        block.text,\n        config.settings.richtextViewSettings.ToHTMLRenderers,\n        config.settings.richtextViewSettings.ToHTMLOptions,\n      );\n      const type = draft?.[0]?.[0]?.type;\n\n      return config.settings.slate.topLevelTargetElements.includes(type)\n        ? [parseInt(type.slice(1)), block.text.blocks[0].text]\n        : null;\n    },\n  };\n\n  config.blocks.blocksConfig.slate = slateBlockConfig;\n  config.blocks.blocksConfig.detachedSlate = {\n    ...config.blocks.blocksConfig.slate,\n    id: 'detachedSlate',\n    title: 'Detached Slate',\n    edit: (props) => <TextBlockEdit {...props} detached />,\n    restricted: true,\n  };\n  return config;\n};\n"],"mappings":"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"},"metadata":{"react-intl":{"messages":[]}},"sourceType":"module","externalDependencies":[]}